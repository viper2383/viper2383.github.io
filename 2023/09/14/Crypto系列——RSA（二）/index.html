

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/1.jpg">
  <link rel="icon" href="/img/1.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="wiper3">
  <meta name="keywords" content="">
  
    <meta name="description" content="ã€Šä»0å¼€å§‹çš„å¯†ç å­¦ä¸–ç•Œç”Ÿæ´»2ã€‹ğŸ˜‹(å­¦ç€æ€ä¹ˆè¿™ä¹ˆéš¾æ„Ÿè§‰">
<meta property="og:type" content="article">
<meta property="og:title" content="Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰">
<meta property="og:url" content="http://viper2383.github.io/2023/09/14/Crypto%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94RSA%EF%BC%88%E4%BA%8C%EF%BC%89/index.html">
<meta property="og:site_name" content="Wiper3">
<meta property="og:description" content="ã€Šä»0å¼€å§‹çš„å¯†ç å­¦ä¸–ç•Œç”Ÿæ´»2ã€‹ğŸ˜‹(å­¦ç€æ€ä¹ˆè¿™ä¹ˆéš¾æ„Ÿè§‰">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-14T13:57:30.000Z">
<meta property="article:modified_time" content="2023-11-28T08:20:49.000Z">
<meta property="article:author" content="wiper3">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰ - Wiper3</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"viper2383.github.io","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"Ck2kyOHOxuuBAfQUohEOKi96-gzGzoHsz","app_key":"wdfGUQEKR40axI1tqBj4ZMs6","server_url":"https://ck2kyoho.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>w1per3</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>å‹é“¾</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-09-14 21:57" pubdate>
          2023å¹´9æœˆ14æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          41k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          271 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰</h1>
            
              <p class="note note-info">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äºï¼š2023å¹´11æœˆ28æ—¥ ä¸‹åˆ
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>ã€Šä»0å¼€å§‹çš„å¯†ç å­¦ä¸–ç•Œç”Ÿæ´»ã€‹ğŸ˜‹æ…¢æ…¢å­¦å¯†ç æ–¹å‘</p>
<p>2023.09.14-</p>
<p>2023.10.27,é‡æ‹¾,æ„Ÿè§‰è¿˜æ˜¯è¦è·Ÿç€å…´è¶£èµ°å§ğŸ˜¥ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­</p>
<p>2023.11.14 ğŸ˜¢</p>
<h2 id="rsa21å°æ˜æ–‡æ”»å‡»">[RSA2]1(å°æ˜æ–‡æ”»å‡»)</h2>
<h3 id="main">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">5120</span>)<br>q = getPrime(<span class="hljs-number">5120</span>)<br><br>n = p*q<br>e = <span class="hljs-number">97</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 1392208858696945158251408085300402884210409327605255122395601049457847957306648819174395014931778575812308192875319127224095733396726388842605854427013313599830150182564652493067830031524869535522568868597852507293377043240832819715539722122306829543983051745406887140154364256267942350230636870212935356815475345989038318923389132101208917912083817520799490534351545373438629367819085151041702754019127891155542476560972125790519584018715794669416759039955180436830478697704458250990786586357019211642837879273967620287257818400267757312623543898635740200839249361087580046496969637043238450499583879116276661827372750638403042213043389905183760455450595752578482968202040860053524276678108325784161897719093223308370971388068813420487879756084379519128232693549989942550047529174783976176943482484756074638704076740157397067892580297182979526978967352014250386678155843772313996171396582929433057131989693861316408604436872931427368192437680361830753162284661119995125858203931094922686321756465463988790748131178263745308042820480140189644732824717255521633534750635979508673908361269979175726073254050574688259969290376926807033728165164896588540691889207252105903436659968119091774687841336252628343233161941187968365128093917171537997137001140227677728923114895809278926486615010954871408034272872411042537353956193868948909981683850857262457369506288525323882308421700421661036191853577105238753230479541719001794464585534292774768292358961920606891227776349593589481547577148801600196035588544512224775960892265021565124673788852875005526313525709353599584812394138968970647681759439523307392275602626903789154682706839530654070108096741181206975334567778238856983205004289416400671597321919876279909765650782227834097342294844294386380646928266942749144240020420237153276705785759403019072953506982997681174635673907151856644499332322321579088035719680421458310273802481031746012298208449699089203065699598926690947025679591160106357130634946357609420125223580319677387654711233585375013067828291928349946599077331636017784447090096340360087970540477975170379810969501197027775838769222713506443846417124839450184827707739588007707714623211453528342755023849716924694572679150284882978804641986457119009272574734697043321033091757474387114449914271460113979531460465175717705674905568446670579332667139075523255580471183372714211547822093365025438653384719374474230360983878837077517864405475258349436531094649276628214288499716485354283135575921258757214288792410583835467572916298688718758374714560819702413058421373661892101033513816116981698045524150518509405086125781764762145577981637953775680403132163846782252745029783387112660812179706752454175492501665442704630131729362621965258498471247871904163412798544329515689112368523703890083138721480476796720323855371775568097188216621368341228806795058046403892301673157631331636430392885315997250027372621883549649614866115616619234953579196607399899485002042456482969222428121605212017146571466818179341621066715472184636758016242256725063854155219754299817717414423725704356940589670902509021070871847017199593680033</span><br><span class="hljs-string">e = 97</span><br><span class="hljs-string">c = 79418540691422578656139651796213224829563266521211325595707569487401417030874358531413674275017334363641194166574500833916574827523075402219754470871728896772312056257743844227927800121160288525434484105786180547178403828613331285574461293211150728313415280329153597549251599876668080073528625299164784405291297754331374420687599875173508778209038236713812747215157059659564867241144529476211694011692007565732793105429228730285249025627762831080251661835294067942958070742202862164086250986988784472568266652325462247009294865764533077164470382743735937483173523682749295196383707694876943634298051820105410771024861599560176707940488888601355473498847493259474613261665538825299531665650233837474894442826242097663456648233384047622152817959729025415665280499618951478005159820575701483220155180955748454167435711033379910310483689839303198822665341421591234243891877857520663120183063591818656508336831518527692847950877186870610083654117153248336928856886934232488927132245720058243202637258025864487122393335118118013444397135476780564523166548571927547341556616683070253790368891423731046742936358877118104790084195711730135202600692806999992373490439385845158780392894927697171401722699273071306493916233696254958735540772870249139252741670476667099529502282392011715616110876451102234600267482991583515122052976378641894214562203326290939184469206074418127906704847146567350085797480500249400491003993809769407575997740985283755035509654310797061339563655229926356893455738361409861102662109994984398860070584568014471082484198504331014073023689622378943694856212172718725529473812336321642429261822836311084518735006587545920946664595488768239633950124822001162595168106106356115962424210028401369438479550293237915944302351566624339603616714683958384871326105542659559877758488581425288668613061792514360263277530824203967659102107889148367539858141289229124274098921748855341045565232484417195620758495861456624842263649414501657786484816662971421962216348340311859717286253287173293151613310383128702607971580042308515018120559903265609733911340589091613087560931098833849573462572181625894166772788435459280323623477689159384354671220634694792005231505741029567734616435905915192606539962414882105254409847885996949466940350184140166614950171110955365828033747003120697209120916652982201967537088553504504252785632280900095976870510754563400828951684036526240669112248351928072177486091157562600003336544767896806392523395037345770580482363058065676920013089896399387769312374871419827762872050800055872960573607645266626972865053489632548224840580503746879607167797904430560935476705014800973841917939689270919224595772574781478285359220463175042728750523639669204218676238297875644055563803457896409252533724486937378974745777400567080239687055154021761534918106133195512030935957251049812753269173090858930245212145938555697547499155977225759702066548720079477737104010668116693232798415289735481194922014811945312893853446826780868861295203942063380964100360870361328125</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp">exp</h3>
<ul class="task-list">
<li><label><input type="checkbox"
checked="" /><strong>å°æ˜æ–‡æ”»å‡»</strong></label></li>
</ul>
<p><strong>åŠ å¯†æŒ‡æ•°æŒ‡çš„æ˜¯eï¼Œeä¸€èˆ¬å–65535ï¼Œä½†å½“eå¾ˆå°æ—¶ï¼Œå¯ç›´æ¥è§£å¯†</strong></p>
<p>è¿™é‡Œ<strong>$ m^{e} &lt; c$</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">1392208858696945158251408085300402884210409327605255122395601049457847957306648819174395014931778575812308192875319127224095733396726388842605854427013313599830150182564652493067830031524869535522568868597852507293377043240832819715539722122306829543983051745406887140154364256267942350230636870212935356815475345989038318923389132101208917912083817520799490534351545373438629367819085151041702754019127891155542476560972125790519584018715794669416759039955180436830478697704458250990786586357019211642837879273967620287257818400267757312623543898635740200839249361087580046496969637043238450499583879116276661827372750638403042213043389905183760455450595752578482968202040860053524276678108325784161897719093223308370971388068813420487879756084379519128232693549989942550047529174783976176943482484756074638704076740157397067892580297182979526978967352014250386678155843772313996171396582929433057131989693861316408604436872931427368192437680361830753162284661119995125858203931094922686321756465463988790748131178263745308042820480140189644732824717255521633534750635979508673908361269979175726073254050574688259969290376926807033728165164896588540691889207252105903436659968119091774687841336252628343233161941187968365128093917171537997137001140227677728923114895809278926486615010954871408034272872411042537353956193868948909981683850857262457369506288525323882308421700421661036191853577105238753230479541719001794464585534292774768292358961920606891227776349593589481547577148801600196035588544512224775960892265021565124673788852875005526313525709353599584812394138968970647681759439523307392275602626903789154682706839530654070108096741181206975334567778238856983205004289416400671597321919876279909765650782227834097342294844294386380646928266942749144240020420237153276705785759403019072953506982997681174635673907151856644499332322321579088035719680421458310273802481031746012298208449699089203065699598926690947025679591160106357130634946357609420125223580319677387654711233585375013067828291928349946599077331636017784447090096340360087970540477975170379810969501197027775838769222713506443846417124839450184827707739588007707714623211453528342755023849716924694572679150284882978804641986457119009272574734697043321033091757474387114449914271460113979531460465175717705674905568446670579332667139075523255580471183372714211547822093365025438653384719374474230360983878837077517864405475258349436531094649276628214288499716485354283135575921258757214288792410583835467572916298688718758374714560819702413058421373661892101033513816116981698045524150518509405086125781764762145577981637953775680403132163846782252745029783387112660812179706752454175492501665442704630131729362621965258498471247871904163412798544329515689112368523703890083138721480476796720323855371775568097188216621368341228806795058046403892301673157631331636430392885315997250027372621883549649614866115616619234953579196607399899485002042456482969222428121605212017146571466818179341621066715472184636758016242256725063854155219754299817717414423725704356940589670902509021070871847017199593680033</span><br>e = <span class="hljs-number">97</span><br>c = <span class="hljs-number">79418540691422578656139651796213224829563266521211325595707569487401417030874358531413674275017334363641194166574500833916574827523075402219754470871728896772312056257743844227927800121160288525434484105786180547178403828613331285574461293211150728313415280329153597549251599876668080073528625299164784405291297754331374420687599875173508778209038236713812747215157059659564867241144529476211694011692007565732793105429228730285249025627762831080251661835294067942958070742202862164086250986988784472568266652325462247009294865764533077164470382743735937483173523682749295196383707694876943634298051820105410771024861599560176707940488888601355473498847493259474613261665538825299531665650233837474894442826242097663456648233384047622152817959729025415665280499618951478005159820575701483220155180955748454167435711033379910310483689839303198822665341421591234243891877857520663120183063591818656508336831518527692847950877186870610083654117153248336928856886934232488927132245720058243202637258025864487122393335118118013444397135476780564523166548571927547341556616683070253790368891423731046742936358877118104790084195711730135202600692806999992373490439385845158780392894927697171401722699273071306493916233696254958735540772870249139252741670476667099529502282392011715616110876451102234600267482991583515122052976378641894214562203326290939184469206074418127906704847146567350085797480500249400491003993809769407575997740985283755035509654310797061339563655229926356893455738361409861102662109994984398860070584568014471082484198504331014073023689622378943694856212172718725529473812336321642429261822836311084518735006587545920946664595488768239633950124822001162595168106106356115962424210028401369438479550293237915944302351566624339603616714683958384871326105542659559877758488581425288668613061792514360263277530824203967659102107889148367539858141289229124274098921748855341045565232484417195620758495861456624842263649414501657786484816662971421962216348340311859717286253287173293151613310383128702607971580042308515018120559903265609733911340589091613087560931098833849573462572181625894166772788435459280323623477689159384354671220634694792005231505741029567734616435905915192606539962414882105254409847885996949466940350184140166614950171110955365828033747003120697209120916652982201967537088553504504252785632280900095976870510754563400828951684036526240669112248351928072177486091157562600003336544767896806392523395037345770580482363058065676920013089896399387769312374871419827762872050800055872960573607645266626972865053489632548224840580503746879607167797904430560935476705014800973841917939689270919224595772574781478285359220463175042728750523639669204218676238297875644055563803457896409252533724486937378974745777400567080239687055154021761534918106133195512030935957251049812753269173090858930245212145938555697547499155977225759702066548720079477737104010668116693232798415289735481194922014811945312893853446826780868861295203942063380964100360870361328125</span><br><br><br>a, b = gmpy2.iroot(c, <span class="hljs-number">97</span>)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(a))<br><br></code></pre></td></tr></table></figure>
<p>ä¹Ÿèƒ½ç”¨ <strong>[RSA2]P2</strong>
çš„æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°kæ˜¯ç­‰äº0çš„ï¼Œä¹ŸéªŒè¯äº†$ m^{e}= c$
,ä¹Ÿå°±æ˜¯åœ¨å–æ¨¡çš„è¿‡ç¨‹ä¸­æ²¡æœ‰ä¸¢å¤±ä»»ä½•ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼€æ–¹ä»è€Œè·å¾—m</p>
<h2 id="rsa22ä½åŠ å¯†æŒ‡æ•°æ”»å‡»">[RSA2]2(ä½åŠ å¯†æŒ‡æ•°æ”»å‡»)</h2>
<h3 id="main-1">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q<br>e = <span class="hljs-number">3</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>m = bytes_to_long(flag)<br><br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 111573371787314339229652810703380127177507745009618224416171957526984270337589283887959174610818933914845556276472159360153787395638087723501889651641965684241070152541291185349571453536221312112508437223801640552330390095266644485311958102687735113533739324296417077804219395793942670324182191309872918900717</span><br><span class="hljs-string">e = 3</span><br><span class="hljs-string">c = 90782646242308381145716338972639920044710403094882163620436540965475107006005657722222634294458956650085252212452241377251397323707019480880284004845674260662647720809672266571040936376737882878688872281858048646517100139303896804340224961592424635124272549514473232731744884837572128596217771005209683966262</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-1">exp</h3>
<ul class="task-list">
<li><label><input type="checkbox"
checked="" /><strong>ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</strong></label></li>
</ul>
<p>yafuå’Œ<a
target="_blank" rel="noopener" href="http://factordb.com/">factordb.com</a>éƒ½æ²¡åˆ†è§£æˆåŠŸï¼Œ<strong>è¿™é‡Œçš„nä¹Ÿä¸å¤§ï¼Œæ€ä¹ˆå°±æ²¡æˆåŠŸå‘¢ğŸ™„</strong></p>
<p>é‚£åªèƒ½çœ‹çœ‹åŸç†äº†</p>
<p>ç›´æ¥ä½¿ç”¨ä¸Šé¢˜çš„æ–¹å¼å¼€æ–¹å¹¶ä¸è¡Œï¼Œåˆ™è¯´æ˜$ m^{e}&gt; c$
ï¼Œä¸èƒ½ç›´æ¥å¼€æ–¹ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘åŸç†ï¼š <span class="math display">\[
c \equiv m^{e} (mod\quad n)
\]</span> æ¶ˆå»å–æ¨¡ï¼Œæœ‰ï¼š <span class="math display">\[
m^{e} = c + k\cdot n
\]</span> å› ä¸ºæœ¬é¢˜ä¸­åŠ å¯†æŒ‡æ•°eå¾ˆå°ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘<span
class="math inline">\(m^{e}\)</span>çš„å€¼å¹¶ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡éå†<code>k</code>çš„æ–¹å¼å°†å–æ¨¡åä¸¢å¤±çš„ä¿¡æ¯æ‰¾å›æ¥ï¼Œ</p>
<p>éå†åˆ°ä½•æ—¶åœæ­¢å‘¢ï¼Ÿå½“<span class="math inline">\(c + k\cdot
n\)</span>æ˜¯ä¸€ä¸ªå®Œå…¨eæ¬¡æ–¹æ•°æ—¶ï¼Œåˆ™è¯´æ˜æˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„ç­”æ¡ˆï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">111573371787314339229652810703380127177507745009618224416171957526984270337589283887959174610818933914845556276472159360153787395638087723501889651641965684241070152541291185349571453536221312112508437223801640552330390095266644485311958102687735113533739324296417077804219395793942670324182191309872918900717</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">90782646242308381145716338972639920044710403094882163620436540965475107006005657722222634294458956650085252212452241377251397323707019480880284004845674260662647720809672266571040936376737882878688872281858048646517100139303896804340224961592424635124272549514473232731744884837572128596217771005209683966262</span><br><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000</span>):<br>    cc = c + k*n<br>    res = iroot(cc, e)<br>    <span class="hljs-keyword">if</span> res[<span class="hljs-number">1</span>]:             <span class="hljs-comment">#å¦‚æœç¬¬äºŒä¸ªå‚æ•°è¿”å›çš„æ˜¯trueï¼Œåˆ™mç­‰äºç¬¬ä¸€ä¸ªå‚æ•°</span><br>        m = res[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;k:&#x27;</span>,k)                <span class="hljs-comment"># k=11</span><br></code></pre></td></tr></table></figure>
<h2 id="rsa23rabin">[RSA2]3(Rabin)</h2>
<h3 id="main-2">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">256</span>)<br>q = getPrime(<span class="hljs-number">256</span>)<br><br><span class="hljs-keyword">assert</span> p%<span class="hljs-number">4</span> == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> q%<span class="hljs-number">4</span> == <span class="hljs-number">3</span><br><br>n = p*q<br>e = <span class="hljs-number">2</span><br>m = bytes_to_long(flag)<br><br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 67711062621608175960173275013534737889372437946924512522469843485353704013203</span><br><span class="hljs-string">q = 91200252033239924238625443698357031288749612243099728355449192607988117291739</span><br><span class="hljs-string">e = 2</span><br><span class="hljs-string">c = 5251890478898826530186837207902117236305266861227697352434308106457554098811792713226801824100629792962861125855696719512180887415808454466978721678349614</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-2">exp</h3>
<ul class="task-list">
<li><label><input type="checkbox" checked="" /><strong>RSA
è¡ç”Ÿç®—æ³•â€”â€”Rabinç®—æ³•</strong></label></li>
</ul>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_e_attack/#rsa-rabin">å…¬é’¥æŒ‡æ•°ç›¸å…³æ”»å‡»
- CTF Wiki (ctf-wiki.org)</a></p>
<p>Rabin ç®—æ³•çš„ç‰¹å¾åœ¨äº <span class="math inline">\(e=2\)</span>ã€‚</p>
</blockquote>
<p>å’Œä¸Šé¢˜ä¸€æ ·ï¼Œæœ¬é¢˜eéå¸¸å°ï¼Œæœ‰<span
class="math inline">\(e=2\)</span>ï¼Œä½†æˆ‘ä»¬ä¼šå‘ç°cä¸æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™è¯´æ˜ä¸èƒ½ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»çš„æ–¹æ³•è§£å†³ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå‘ç°æœ¬é¢˜eå’Œphiä¸äº’ç´ ï¼Œä»–ä»¬éƒ½æ˜¯å¶æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¾—ä¸åˆ°RSAçš„ç§é’¥ã€‚å®é™…ä¸Šï¼Œé™¤äº†RSAç®—æ³•å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šçš„éå¯¹ç§°åŠ å¯†æ–¹æ¡ˆï¼Œä¾‹å¦‚åœ¨æœ¬é¢˜ä¸­å®é™…ä¸Šä½¿ç”¨äº†Rabinç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œåªæ˜¯å®ƒç±»ä¼¼äºRSAï¼Œæ•…åœ¨CTFä¸­æˆ‘ä»¬å°†å…¶åˆ’åˆ†åˆ°RSAæ”»å‡»èŒƒç•´ä¸­ï¼Œåœ¨åç»­å­¦ä¹ ä¸­æˆ‘ä»¬è¿˜ä¼šé‡åˆ°å¾ˆå¯¹å®é™…å¹¶ä¸æ˜¯RSAä½†ç±»ä¼¼RSAçš„åŠ å¯†ç®—æ³•ã€‚</p>
<p><strong>1.åŠ å¯†</strong></p>
<ol type="1">
<li>å–ä¸¤ä¸ªå¤§ç´ æ•°pï¼Œqï¼Œæ»¡è¶³<span class="math inline">\(pâ‰¡qâ‰¡3\ mod\
4\)</span>ï¼Œå³è¿™ä¸¤ä¸ªç´ æ•°å½¢å¼ä¸º4k+3ï¼Œè®¡ç®—<span
class="math inline">\(n=pq\)</span></li>
<li><span class="math inline">\(C=m^2\ mod\ n\)</span></li>
<li>nä½œå…¬é’¥ï¼Œpï¼Œqä½œç§é’¥</li>
</ol>
<p><strong>2.è§£å¯†</strong></p>
<p>æ±‚mï¼Œ<span class="math inline">\(m^2â‰¡c(mod\ n)\)</span></p>
<p><a target="_blank" rel="noopener" href="https://www.ruanx.net/rsa-solutions/">CTF RSAé¢˜è§£é›†
(ruanx.net)</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Xennyçš„è½®å­</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">67711062621608175960173275013534737889372437946924512522469843485353704013203</span><br>q = <span class="hljs-number">91200252033239924238625443698357031288749612243099728355449192607988117291739</span><br>e = <span class="hljs-number">2</span><br>c = <span class="hljs-number">5251890478898826530186837207902117236305266861227697352434308106457554098811792713226801824100629792962861125855696719512180887415808454466978721678349614</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rabin_attack</span>(<span class="hljs-params">c, n, p, q</span>):<br>    c1 = powmod(c, (p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, p)<br>    c2 = powmod(c, (q+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, q)<br>    cp1 = p - c1<br>    cp2 = q - c2<br><br>    t1 = invert(p, q)<br>    t2 = invert(q, p)<br><br>    m1 = (q*c1*t2 + p*c2*t1) % n<br>    m2 = (q*c1*t2 + p*cp2*t1) % n<br>    m3 = (q*cp1*t2 + p*c2*t1) % n<br>    m4 = (q*cp1*t2 + p*cp2*t1) % n<br><br>    <span class="hljs-keyword">return</span> m1, m2, m3, m4<br><br>ms = rabin_attack(c, p*q, p, q)<br><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> ms:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))    <span class="hljs-comment"># å››ä¸ªåªæœ‰ä¸€ä¸ªæ˜¯</span><br></code></pre></td></tr></table></figure>
<h2 id="rsa24wiener">[RSA2]4(Wiener)</h2>
<h3 id="main-3">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">256</span>)<br>q = getPrime(<span class="hljs-number">256</span>)<br><br>n = p*q<br>d = getPrime(<span class="hljs-number">128</span>)<br>e = inverse(d, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = bytes_to_long(flag)<br><br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 6969872410035233098344189258766624225446081814953480897731644163180991292913719910322241873463164232700368119465476508174863062276659958418657253738005689</span><br><span class="hljs-string">e = 3331016607237504021038095412236348385663413736904453330557803644384818257225138777641344877202234881627514102078530507171735156112302207979925588113589669</span><br><span class="hljs-string">c = 1754994938947260364311041300467524420957926989584983693004487724099773647229373820465164193428679197813476633649362998772470084452129370353136199193923837</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp1">exp1</h3>
<ul class="task-list">
<li><label><input
type="checkbox" /><strong>Wieneræ”»å‡»</strong></label></li>
</ul>
<p><strong>å·²çŸ¥ï¼ˆeï¼Œnï¼Œcï¼‰ï¼Œæ±‚mã€‚då¾ˆå°ä¸”eå¾ˆå¤§ï¼Œå¯çŸ¥æ˜¯ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼ˆWieneræ”»å‡»ï¼‰ã€‚</strong></p>
<p><strong>è¿™é‡Œç›¸å½“äºæ˜¯åè¿‡æ¥äº†ï¼Œå…ˆç”Ÿæˆäº†dï¼Œå†ç”±då»æ±‚e</strong>ï¼Œå½“æˆ‘ä»¬å‘ç°<strong>e
å¾ˆå¤§æˆ–è€…è¯´å¾ˆæ¥è¿‘
n</strong>æ—¶ï¼Œä¾¿å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿åˆ†æ•°å±•å¼€çš„æ–¹å¼ï¼Œéå†æ¯ä¸€ä¸ªç³»æ•°ï¼Œæµ‹è¯•æ˜¯å¦æ˜¯è§£é¢˜ä¸­éœ€è¦ç”¨åˆ°çš„å…³é”®å› å­ï¼Œ</p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/XiongSiqi_blog/article/details/130515028">RSA--ç»´çº³æ”»å‡»--ä»£ç å’Œé¢˜ç›®åˆ†æ_ç»´çº³æ”»å‡»è„šæœ¬_Emmaaaaaaaaaaçš„åšå®¢-CSDNåšå®¢</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç›´æ¥ç”¨xennyçš„è½®å­</span><br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> xenny.ctf.crypto.modern.asymmetric.rsa <span class="hljs-keyword">import</span> wiener<br><span class="hljs-comment"># eå¾ˆå¤§ wieneræ”»å‡»</span><br>n = <span class="hljs-number">6969872410035233098344189258766624225446081814953480897731644163180991292913719910322241873463164232700368119465476508174863062276659958418657253738005689</span><br>e = <span class="hljs-number">3331016607237504021038095412236348385663413736904453330557803644384818257225138777641344877202234881627514102078530507171735156112302207979925588113589669</span><br>c = <span class="hljs-number">1754994938947260364311041300467524420957926989584983693004487724099773647229373820465164193428679197813476633649362998772470084452129370353136199193923837</span><br> <br>d, p, q = wiener.attack(n, e)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = libnum.n2s(<span class="hljs-built_in">int</span>(m))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># print(long_to_bytes(m))</span><br></code></pre></td></tr></table></figure>
<h3 id="exp2">exp2</h3>
<ul class="task-list">
<li><label><input type="checkbox" />ç”¨åŸç†å†™çš„ï¼Œè¿˜æ²¡ç†è§£</label></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">6969872410035233098344189258766624225446081814953480897731644163180991292913719910322241873463164232700368119465476508174863062276659958418657253738005689</span><br>e = <span class="hljs-number">3331016607237504021038095412236348385663413736904453330557803644384818257225138777641344877202234881627514102078530507171735156112302207979925588113589669</span><br>c = <span class="hljs-number">1754994938947260364311041300467524420957926989584983693004487724099773647229373820465164193428679197813476633649362998772470084452129370353136199193923837</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, numerator, denumerator</span>):<br>        self.numberlist = []  <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = []  <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList(numerator, denumerator)<br>        self.GenerateFractionList()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span>(<span class="hljs-params">self, numerator, denumerator</span>):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append(quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span>(<span class="hljs-params">self</span>):<br>        self.fractionlist.append([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i):<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i - j - <span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br><br><br>a = ContinuedFraction(e, n)<br><span class="hljs-keyword">for</span> k, d <span class="hljs-keyword">in</span> a.fractionlist:<br>    m = powmod(c, d, n)<br>    flag = long_to_bytes(m)<br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NSSCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<h2 id="rsa25ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»">[RSA2]5(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)</h2>
<h3 id="main-4">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>flag = os.getenv(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<br>m = bytes_to_long(flag.encode())<br>e = <span class="hljs-number">127</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    n = p*q<br>    c = <span class="hljs-built_in">pow</span>(m, e, n)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n: <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c: <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        opt = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;input&gt; &#x27;</span>))<br>        <span class="hljs-keyword">if</span> opt == <span class="hljs-number">1</span>:<br>            enc()<br><br>main()<br></code></pre></td></tr></table></figure>
<h3 id="exp-3">exp</h3>
<p>1ã€ä½åŠ å¯†æŒ‡æ•°</p>
<p>â€‹
æ‰€è°“<strong>ä½åŠ å¯†æŒ‡æ•°</strong>ï¼ŒæŒ‡çš„æ˜¯RSAåŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨çš„å‚æ•°eçš„å€¼å¾ˆå°ï¼Œè¿™æ ·å¾€å¾€ä¼šäº§ç”Ÿå®‰å…¨éšæ‚£ï¼Œå¯¼è‡´ä½åŠ å¯†æŒ‡æ•°æ”»å‡»çš„å‘ç”Ÿã€‚</p>
<p>2ã€å¹¿æ’­ã€</p>
<p>â€‹
æ‰€è°“<strong>å¹¿æ’­</strong>ï¼Œå°±æ˜¯å‘é€æ–¹å°†ä¸€ä»½æ˜æ–‡è¿›è¡Œå¤šä»½åŠ å¯†ï¼Œä½†æ˜¯æ¯ä»½ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œå³å¯†é’¥ä¸­çš„æ¨¡æ•°nä¸åŒï¼Œä½†æ˜¯æŒ‡æ•°eç›¸åŒä¸”å¾ˆå°ï¼Œå› æ­¤æˆ‘ä»¬åªè¦å¾—åˆ°å¤šä»½å¯†æ–‡å’Œå¯¹åº”çš„æ¨¡æ•°nå°±å¯ä»¥åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†è¿›è¡Œè§£å¯†ã€‚</p>
<p>3ã€ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</p>
<p>â€ƒå®ç°<strong>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</strong>éœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š</p>
<p>ï¼ˆ1ï¼‰åŠ å¯†æŒ‡æ•°eéå¸¸å°ã€‚</p>
<p>ï¼ˆ2ï¼‰åŒä¸€ä»½æ˜æ–‡ä½¿ç”¨ä¸åŒçš„æ¨¡æ•°nï¼Œç›¸åŒçš„åŠ å¯†æŒ‡æ•°eè¿›è¡Œå¤šæ¬¡åŠ å¯†ã€‚</p>
<p>ï¼ˆ3ï¼‰æ”»å‡»è€…å¯ä»¥å¾—åˆ°æ¯ä¸€ä»½åŠ å¯†åçš„å¯†æ–‡å’Œå¯¹åº”çš„æ¨¡æ•°nã€åŠ å¯†æŒ‡æ•°eã€‚</p>
<hr />
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202310271642498.png" srcset="/img/loading.gif" lazyload
alt="image-20231027164245430" />
<figcaption aria-hidden="true">image-20231027164245430</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Xennyå¸ˆå‚…wpï¼Œè¿˜åœ¨å­¦ï¼Œä¸»è¦è¿™ä¸ªæ˜¯äº¤äº’çš„</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">crt</span>(<span class="hljs-params">n_list, c_list</span>):  <span class="hljs-comment">#ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰</span><br>    n = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n_list:<br>        n *= i<br>    N = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> n_list:<br>        N.append(n // i)  <span class="hljs-comment">#è®¡ç®—æ¯ä¸ªæ¨¡æ•°å¯¹åº”çš„ N å€¼ï¼Œå³å°†æ€»ä¹˜ç§¯é™¤ä»¥å½“å‰æ¨¡æ•°ã€‚</span><br>    t = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n_list)):<br>        t.append(invert(N[i], n_list[i]))   <span class="hljs-comment">#ä½¿ç”¨invertå‡½æ•°è®¡ç®—æ¯ä¸ªæ¨¡æ•°å¯¹åº”çš„æ¨¡åå…ƒç´ ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°åˆ—è¡¨ t ä¸­ã€‚</span><br><br>    summary = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n_list)):<br>        <span class="hljs-comment">#ä½¿ç”¨CRTçš„å…¬å¼è®¡ç®—è§£å¯†ç»“æœï¼Œéå†æ¯ä¸ªæ¨¡æ•°ï¼Œå°†å…¶å¯†æ–‡ä¸ç›¸åº”çš„æƒé‡ç›¸ä¹˜ï¼Œç„¶åå–æ¨¡ï¼Œæœ€åç´¯åŠ åˆ° summary ä¸­ã€‚</span><br>        summary = (summary + c_list[i] * t[i] * N[i]) % n<br>    <span class="hljs-keyword">return</span> summary<br><br><br>io = remote(<span class="hljs-string">&#x27;node4.anna.nssctf.cn&#x27;</span>, <span class="hljs-number">28522</span>)<br>e = <span class="hljs-number">127</span><br>n_list = []<br>c_list = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">127</span>):<br>    io.sendlineafter(<span class="hljs-string">b&#x27;input&gt; &#x27;</span>, <span class="hljs-string">b&#x27;1&#x27;</span>)  <span class="hljs-comment"># ç­‰å¾…æ”¶åˆ°input&gt; åå‘é€1</span><br>    n = <span class="hljs-built_in">int</span>(io.recvline().decode()[<span class="hljs-number">2</span>:])  <span class="hljs-comment"># æ¥æ”¶ä¸€è¡Œæ•°æ® å³ n: xxxx</span><br>    c = <span class="hljs-built_in">int</span>(io.recvline().decode()[<span class="hljs-number">2</span>:])  <span class="hljs-comment"># æ¥æ”¶ä¸€è¡Œæ•°æ® å³ c: xxxx</span><br>    n_list.append(n)<br>    c_list.append(c)<br><br>M = crt(n_list, c_list)<br>m = iroot(M, e)[<span class="hljs-number">0</span>]<br>flag = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<blockquote>
<p>ä½ æ˜¯çœŸçš„éš¾å•Šï¼Œæˆ‘çš„å“¥åŸƒï¼Œé…ç½®b WSL 2ç¯å¢ƒç»™æˆ‘æŠ˜è…¾åºŸäº†</p>
<p>å…¶å®å°±æ˜¯ä½ å®‰è£…å¥½ä¹‹åç›´æ¥å» pycharm
é‡Œé¢æ“ä½œå°±å¯ä»¥äº†ï¼Œæœ‰æ²¡æœ‰çš„åŒ…å°±å®‰è£…ï¼Œå®‰è£…ä¸æˆå°±æ¢æº</p>
<p>æ¯”å¦‚æˆ‘å®‰çš„æ—¶å€™ç¬¬ä¸€æ¬¡å°±å¤±è´¥äº†ï¼Œç„¶åæ¢æºè§£å†³ï¼š
<code>pip install -i https://pypi.doubanio.com/simple/ pycryptodome</code></p>
<p>æ³¨æ„ï¼š</p>
<p>åœ¨ Linuxï¼ˆå¦‚ä½ å½“å‰çš„ Bash ç»ˆç«¯ï¼‰ä¸­ï¼Œè·¯å¾„åˆ†éš”ç¬¦æ˜¯æ–œæ  <code>/</code>
è€Œä¸æ˜¯åæ–œæ  <code>\</code>ã€‚å¦‚æœä½ æƒ³åˆ‡æ¢åˆ°
<code>D:\code\python\python3.8\Xenny_RSA2\[RSA2]P5</code>
ç›®å½•ï¼Œä½ éœ€è¦ä½¿ç”¨æ­£æ–œæ ï¼Œå¹¶ä¸”å¯èƒ½éœ€è¦å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚</p>
<p>å°è¯•ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cd <span class="hljs-regexp">/mnt/</span>d<span class="hljs-regexp">/code/</span>python<span class="hljs-regexp">/python3.8/</span>Xenny_RSA2/[RSA2]P5<br></code></pre></td></tr></table></figure>
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311142341052.png" srcset="/img/loading.gif" lazyload
alt="image-20231114234103995" />
<figcaption aria-hidden="true">image-20231114234103995</figcaption>
</figure>
</blockquote>
<h2 id="rsa26p-1å…‰æ»‘">[RSA2]6(p-1å…‰æ»‘)</h2>
<h3 id="main-5">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMyPrime</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br>        <br>        <span class="hljs-keyword">if</span> isPrime(p+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> p+<span class="hljs-number">1</span><br><br>p = getMyPrime(<span class="hljs-number">256</span>)<br>q = getMyPrime(<span class="hljs-number">256</span>)<br><br>n = p*q<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 53763529836257082401813045869248978487210852880716446938539970599235060144454914000042178896730979463959004404421520555831136502171902051936080825853063287829</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 50368170865606429432907125510556310647510431461588875539696416879298699197677994843344925466156992948241894107250131926237473102312181031875514294014181272618</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-4">exp</h3>
<blockquote>
<p>å…‰æ»‘æ•° (Smooth number)ï¼šæŒ‡å¯ä»¥åˆ†è§£ä¸ºå°ç´ æ•°ä¹˜ç§¯çš„æ­£æ•´æ•°</p>
<p>å½“pæ˜¯Nçš„å› æ•°ï¼Œå¹¶ä¸”pâˆ’1
æ˜¯å…‰æ»‘æ•°ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨<code>Pollard's p-1</code>ç®—æ³•æ¥åˆ†è§£N</p>
</blockquote>
<p>è¿™ç¯‡æ–‡ç« è®²çš„æŒºæ¸…æ™°çš„ï¼š</p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42667481/article/details/106729900">ã€å¤§æ•°åˆ†è§£ã€‘Pollardâ€˜s
p-1 method_å¤§æ•°åˆ†è§£ç¨‹åº-CSDNåšå®¢</a></p>
<p>å…¶å®å°±æ˜¯è®¡ç®—<span
class="math inline">\(gcd(a^{B!}-1,n)\)</span>æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ç»“æœä¸ä¸º1ä¹Ÿä¸ä¸ºnï¼Œé‚£ä¹ˆå­˜åœ¨çš„é‚£ä¸ªå€¼å°±æ˜¯p</p>
<p>ç„¶åå¯¹äº<span
class="math inline">\(a^{B!}\)</span>ï¼Œæˆ‘ä»¬é€‰å–a=2ï¼Œç„¶åB!æˆ‘ä»¬ä¹Ÿä»2å¼€å§‹ç´¯ä¹˜ï¼Œ</p>
<p>è¿™é‡Œç»“åˆæ¨¡çš„æ€§è´¨ï¼š<span class="math inline">\(a^{(x+1) !}
\equiv\left(a^{x !} \bmod n\right)^{x+1} \quad(\bmod
n)\)</span>ï¼Œå°±èƒ½å†™å‡ºä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">53763529836257082401813045869248978487210852880716446938539970599235060144454914000042178896730979463959004404421520555831136502171902051936080825853063287829</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">50368170865606429432907125510556310647510431461588875539696416879298699197677994843344925466156992948241894107250131926237473102312181031875514294014181272618</span><br><br>a = <span class="hljs-number">2</span><br>m = <span class="hljs-number">2</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    a = powmod(a, m, n)<br>    p = gcd(a-<span class="hljs-number">1</span>, n)<br>    <span class="hljs-keyword">if</span> p != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> p != n:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p=&quot;</span>,p)<br>        <span class="hljs-keyword">break</span><br>    m += <span class="hljs-number">1</span><br><br>q = n // p<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;q=&quot;</span>,q)<br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>m = powmod(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>
<h2 id="rsa27p1å…‰æ»‘">[RSA2]7(p+1å…‰æ»‘)</h2>
<h3 id="main-6">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMyPrime</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br><br>        <span class="hljs-keyword">if</span> isPrime(p - <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> p - <span class="hljs-number">1</span><br><br><br>p = getMyPrime(<span class="hljs-number">256</span>)<br>q = getMyPrime(<span class="hljs-number">256</span>)<br><br>n = p * q<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 63398538193562720708999492397588489035970399414238113344990243900620729661046648078623873637152448697806039260616826648343172207246183989202073562200879290937</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 26971181342240802276810747395669930355754928952080329914687241779532014305320191048439959934699795162709365987652696472998140484810728817991804469778237933925</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-5">exp</h3>
<blockquote>
<p>å½“pæ˜¯Nçš„å› æ•°ï¼Œå¹¶ä¸”p+1æ˜¯å…‰æ»‘æ•°ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨<code>Williams's p+1</code>ç®—æ³•æ¥åˆ†è§£N</p>
</blockquote>
<p>ä¸è¡Œï¼Œè¿™ç©æ„çš„åŸç†æœ‰äº›è¿‡äºå¤æ‚äº†ï¼Œå’±å°±å…ˆç•¥è¿‡ï¼Œå½“ä¸ªè„šæœ¬å°å­å…ˆï¼Œæœ‰æ—¶é—´å†å›æ¥çœ‹å§ğŸ˜¢</p>
<p><a target="_blank" rel="noopener" href="https://www.nssctf.cn/note/set/6">æ–‡ç« åˆ—è¡¨ | NSSCTF</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># from sage.all_cmdline import *</span><br><span class="hljs-keyword">from</span> xenny.ctf.crypto.modern.asymmetric.rsa <span class="hljs-keyword">import</span> williams_pp1<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert, powmod<br><br><span class="hljs-comment"># p+1å…‰æ»‘</span><br>n = <span class="hljs-number">63398538193562720708999492397588489035970399414238113344990243900620729661046648078623873637152448697806039260616826648343172207246183989202073562200879290937</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">26971181342240802276810747395669930355754928952080329914687241779532014305320191048439959934699795162709365987652696472998140484810728817991804469778237933925</span><br><br>p, q = williams_pp1.attack(n, <span class="hljs-number">55</span>)<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>m = powmod(c, d, n)<br>flag = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªä»£ç åœ¨WSL 2
Ubuntuè¿è¡ŒæˆåŠŸäº†ï¼Œä½†åœ¨windowsè¿è¡Œé”™è¯¯ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p>
<h2 id="rsa28å…±æ¨¡æ”»å‡»">[RSA2]8(å…±æ¨¡æ”»å‡»)</h2>
<h3 id="main-7">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q<br>e1 = getPrime(<span class="hljs-number">16</span>)<br>e2 = getPrime(<span class="hljs-number">16</span>)<br><br>m = bytes_to_long(flag)<br><br>c1 = <span class="hljs-built_in">pow</span>(m, e1, n)<br>c2 = <span class="hljs-built_in">pow</span>(m, e2, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e1 = <span class="hljs-subst">&#123;e1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e2 = <span class="hljs-subst">&#123;e2&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c1 = <span class="hljs-subst">&#123;c1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c2 = <span class="hljs-subst">&#123;c2&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 120294155186626082670474649118722298040433501930335450479777638508444129059776534554344361441717048531505985491664356283524886091709370969857047470362547600390987665105196367975719516115980157839088766927450099353377496192206005171597109864609567336679138620134544004766539483664270351472198486955623315909571</span><br><span class="hljs-string">e1 = 38317</span><br><span class="hljs-string">e2 = 63409</span><br><span class="hljs-string">c1 = 42703138696187395030337205860503270214353151588149506110731264952595193757235229215067638858431493587093612397165407221394174690263691095324298012134779703041752810028935711214038835584823385108771901216441784673199846041109074467177891680923593206326788523158180637665813642688824593788192044139055552031622</span><br><span class="hljs-string">c2 = 50460092786111470408945316270086812807230253234809303694007902628924057713984397041141665125615735752600114964852157684904429928771531639899496987905067366415806771003121954852465731110629459725994454904159277228514337278105207721011579794604761255522391446534458815389983562890631994726687526070228315925638</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-6">exp</h3>
<p><strong>å·²çŸ¥ï¼ˆnï¼Œe1ï¼Œe2ï¼Œc1ï¼Œc2ï¼‰ï¼Œæ±‚mã€‚</strong></p>
<blockquote>
<p>å½“ä¸¤ä¸ªç”¨æˆ·ä½¿ç”¨ç›¸åŒçš„æ¨¡æ•°
Nã€ä¸åŒçš„ç§é’¥æ—¶ï¼ŒåŠ å¯†åŒä¸€æ˜æ–‡æ¶ˆæ¯æ—¶å³å­˜åœ¨å…±æ¨¡æ”»å‡»ã€‚</p>
<p>æœ¬é¢˜ä½¿ç”¨ä¸¤ç»„å…¬é’¥å¯¹åŒä¸€æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼Œç»è¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸¤ç§å…¬é’¥çš„næ˜¯åŒä¸€ä¸ªnï¼Œä¹Ÿå°±æ˜¯è¯´æ¨¡æ•°ç›¸åŒï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨å…±æ¨¡æ”»å‡»è¿›è¡Œè§£å¯†ã€‚</p>
</blockquote>
<p><img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311151558469.png" srcset="/img/loading.gif" lazyload /></p>
<p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆåœ¨<code>gmpy2</code>ä¸­çš„<code>gcdext</code>ï¼‰</p>
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311151605501.png" srcset="/img/loading.gif" lazyload
alt="image-20231115160526421" />
<figcaption aria-hidden="true">image-20231115160526421</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">120294155186626082670474649118722298040433501930335450479777638508444129059776534554344361441717048531505985491664356283524886091709370969857047470362547600390987665105196367975719516115980157839088766927450099353377496192206005171597109864609567336679138620134544004766539483664270351472198486955623315909571</span><br>e1 = <span class="hljs-number">38317</span><br>e2 = <span class="hljs-number">63409</span><br>c1 = <span class="hljs-number">42703138696187395030337205860503270214353151588149506110731264952595193757235229215067638858431493587093612397165407221394174690263691095324298012134779703041752810028935711214038835584823385108771901216441784673199846041109074467177891680923593206326788523158180637665813642688824593788192044139055552031622</span><br>c2 = <span class="hljs-number">50460092786111470408945316270086812807230253234809303694007902628924057713984397041141665125615735752600114964852157684904429928771531639899496987905067366415806771003121954852465731110629459725994454904159277228514337278105207721011579794604761255522391446534458815389983562890631994726687526070228315925638</span><br><br><span class="hljs-built_in">print</span>(gcd(e1,e2))  <span class="hljs-comment"># 1</span><br>_,r,s = gcdext(e1,e2)       <span class="hljs-comment"># æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡ºr,sçš„å€¼ï¼Œæ»¡è¶³e1*r + e2*s = 1</span><br>m = <span class="hljs-built_in">pow</span>(c1,r,n) * <span class="hljs-built_in">pow</span>(c2,s,n) % n   <span class="hljs-comment">#è¿™ä¸ªç®—å¼æœ€åçš„ç»“æœå°±æ˜¯m</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>
<h2 id="rsa29dpdqæ³„æ¼æ”»å‡»">[RSA2]9(dp&amp;dqæ³„æ¼æ”»å‡»)</h2>
<h3 id="main-8">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q<br>e = getPrime(<span class="hljs-number">128</span>)<br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>dp = d % (p-<span class="hljs-number">1</span>)<br>dq = d % (q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;dp = <span class="hljs-subst">&#123;dp&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;dq = <span class="hljs-subst">&#123;dq&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 13070310882303377463944295715444821218324151935347454554272870042925400761984585838979931730897626589859098834802923539617244712852188293321626061072925723</span><br><span class="hljs-string">q = 10411551818233737389114520103233235272671271111546186997024935593000298916988792710521511848414549553426943998093077337023514210631662189798921671306236009</span><br><span class="hljs-string">c = 62492280219693914005334023569480350249964827909276875032578276064973191654731196407886841145547165693859745313398152742796887457192397932684370631253099255490064673499746314452067588181106154875239985334051909867580794242253066085627399488604907196244465911471895118443199543361883148941963668551684228132814</span><br><span class="hljs-string">dp = 11568639544706374912496682299967972464196129347160700749666263275305083977187758414725188926013198988871173614336707804756059951725809300386252339177953017</span><br><span class="hljs-string">dq = 3455040841431633020487528316853620383411361966784138992524801280785753201070735373348570840039176552952269927122259706586236960440300255065994052962742469</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-7">exp</h3>
<p><strong>å·²çŸ¥ï¼ˆpï¼Œqï¼Œcï¼Œdpï¼Œdqï¼Œeï¼‰ï¼Œæ±‚mã€‚</strong></p>
<p>æ—¶åˆ»è®°ä½ï¼š</p>
<p><span class="math display">\[
\begin{align}
Encï¼ˆpkï¼ŒmâˆˆZ_N^*ï¼‰:c = m^e\ mod \ N\\
Decï¼ˆskï¼Œcï¼‰ï¼š m = c^d\ mod\ N
\end{align}
\]</span> è¿™é‡Œä¸çŸ¥é“eï¼Œé‚£æˆ‘ä»¬çœ‹å®ƒè¦æ€ä¹ˆæ±‚</p>
<p>å·²çŸ¥ï¼š</p>
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311151626021.png" srcset="/img/loading.gif" lazyload
alt="image-20231115162626957" />
<figcaption aria-hidden="true">image-20231115162626957</figcaption>
</figure>
<p>è§£å¯†ï¼š</p>
<p><span class="math inline">\(m \equiv c^d(\bmod n) \equiv c^d(\bmod p
* q)=k * p * q+c^d\)</span></p>
<p>åˆ†åˆ«æ¨¡på’Œæ¨¡qï¼Œå¾—åˆ°ï¼š</p>
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311151628906.png" srcset="/img/loading.gif" lazyload
alt="image-20231115162805814" />
<figcaption aria-hidden="true">image-20231115162805814</figcaption>
</figure>
<blockquote>
<p>å…¬å¼ä¸­çš„k1å°±æ˜¯è¡¨ç¤ºä¸€ä¸ªæ•´æ•°ï¼Œä¸è¦å¤šæƒ³ï¼Œå› ä¸ºk1*pä¹‹åå†mod
på°±æ²¡äº†ï¼Œåªèƒ½è¯´æ•´ä¸ªå¼å­çš„æ¨å¯¼å¾ˆå·§å¦™~</p>
</blockquote>
<p>åˆ°è¿™é‡Œï¼Œmå°±å·²ç»è§£å‡ºæ¥äº†ï¼Œè¿™æ˜¯å…¶ä¸­çš„ä¸€ç§æ–¹æ³•ï¼Œå…¶å®éå¸¸çš„ç®€å•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">13070310882303377463944295715444821218324151935347454554272870042925400761984585838979931730897626589859098834802923539617244712852188293321626061072925723</span><br>q = <span class="hljs-number">10411551818233737389114520103233235272671271111546186997024935593000298916988792710521511848414549553426943998093077337023514210631662189798921671306236009</span><br>c = <span class="hljs-number">62492280219693914005334023569480350249964827909276875032578276064973191654731196407886841145547165693859745313398152742796887457192397932684370631253099255490064673499746314452067588181106154875239985334051909867580794242253066085627399488604907196244465911471895118443199543361883148941963668551684228132814</span><br>dp = <span class="hljs-number">11568639544706374912496682299967972464196129347160700749666263275305083977187758414725188926013198988871173614336707804756059951725809300386252339177953017</span><br>dq = <span class="hljs-number">3455040841431633020487528316853620383411361966784138992524801280785753201070735373348570840039176552952269927122259706586236960440300255065994052962742469</span><br><br>mp = gmpy2.powmod(c, dp, p)<br>mq = gmpy2.powmod(c, dq, q)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(mp))<br><span class="hljs-built_in">print</span>(long_to_bytes(mq)) <span class="hljs-comment">#ä¸¤ä¸ªå€¼ä¸€æ ·</span><br></code></pre></td></tr></table></figure>
<h2 id="rsa210dpæ³„æ¼æ”»å‡»">[RSA2]10(dpæ³„æ¼æ”»å‡»)</h2>
<h3 id="main-9">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span> + <span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">100</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q<br>e = <span class="hljs-number">65537</span><br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>dp = d % (p-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;dp = <span class="hljs-subst">&#123;dp&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 79201858340517902370077926747686673001645933420450220163567700296597652438275339093680329918615445030212417351430952656177171126427547284822789947152085534939195866096891005587613262293569611913019639653984932469691636338705418303482885987114085769045348074530172292982433373154900841135911548332400167290083</span><br><span class="hljs-string">c = 70109332985937768446301118795636999352761371683181615470371772202170324747707233792154935611826981798791499937601162039878070094663516868746240133223110650205575807753345252087103328657073552992431511929172241702073381723302143955977662087561904058172777520360991685289300855900793806183473523998422682944404</span><br><span class="hljs-string">dp = 3098334089252415941833934532457314870210700261428241562420857845879512952043729097866485406309479489101668423603305497982177150304625615059119312238777275</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-8">exp</h3>
<p><strong>å·²çŸ¥ï¼ˆnï¼Œcï¼Œdpï¼Œeï¼‰ï¼Œæ±‚mã€‚</strong></p>
<p>æœ¬é¢˜æˆ‘ä»¬åˆæœ‰eäº†ï¼Œä½†æ˜¯å´å¤±å»äº†äº†ä¸€ä¸ªdqï¼Œæ€ä¹ˆè§£å†³å‘¢ï¼Ÿä¸çŸ¥é“ï¼Œä¸Šç½‘æœä¸€ä¸‹å§iğŸ˜­</p>
<p><span class="math display">\[
\begin{align}
&amp;âˆµdpâ‰¡d\mod(p-1)ï¼Œâˆ´e*dpâ‰¡e*d\mod(p-1)ï¼Œâˆ´e*dp=k_1(p-1)+e*d\\
&amp;åˆâˆµedâ‰¡1\mod(p-1)(q-1)ï¼Œâˆ´ed=k_2(p-1)(q-1)+1\\
&amp;ç¬¬äºŒè¡Œä»£å…¥ç¬¬ä¸€è¡Œï¼š\\
&amp;e*dp=k_1(p-1)+k_2(p-1)(q-1)+1\\
&amp;=(p-1)(k_1+k_2(q-1))+1\\
&amp;âˆµdp&lt;p-1\\
&amp;âˆ´eï¼(k_1+k_2(q-1))\\
&amp;å³(k_1+k_2(q-1))âˆˆ(1,e)\\
&amp;ä»¤x=k_1+k_2(q-1)ï¼Œç”¨xéå†(1,e)å³å¯æ±‚å‡ºp\\
&amp;ç„¶åq=n//q\\
\end{align}
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> libnum<br><br>n = <span class="hljs-number">79201858340517902370077926747686673001645933420450220163567700296597652438275339093680329918615445030212417351430952656177171126427547284822789947152085534939195866096891005587613262293569611913019639653984932469691636338705418303482885987114085769045348074530172292982433373154900841135911548332400167290083</span><br>c = <span class="hljs-number">70109332985937768446301118795636999352761371683181615470371772202170324747707233792154935611826981798791499937601162039878070094663516868746240133223110650205575807753345252087103328657073552992431511929172241702073381723302143955977662087561904058172777520360991685289300855900793806183473523998422682944404</span><br>dp = <span class="hljs-number">3098334089252415941833934532457314870210700261428241562420857845879512952043729097866485406309479489101668423603305497982177150304625615059119312238777275</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,e):<br>    <span class="hljs-keyword">if</span> e * dp % x ==<span class="hljs-number">1</span>:<br>        p = (e*dp - <span class="hljs-number">1</span>) // x + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> n % p == <span class="hljs-number">0</span>:<br>            q = n // p<br>            d = invert(e, (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>))<br>            m = powmod(c,d,n)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(m))<br><br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br></code></pre></td></tr></table></figure>
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311291147798.png" srcset="/img/loading.gif" lazyload
alt="image-20231129114702659" />
<figcaption aria-hidden="true">image-20231129114702659</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æˆ–è€…ç›´æ¥ç”¨xennyå¸ˆå‚…çš„åº“</span><br><span class="hljs-keyword">from</span> xenny.ctf.crypto.modern.asymmetric.rsa <span class="hljs-keyword">import</span> dpleak<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>e = <span class="hljs-number">65537</span><br>n = <span class="hljs-number">79201858340517902370077926747686673001645933420450220163567700296597652438275339093680329918615445030212417351430952656177171126427547284822789947152085534939195866096891005587613262293569611913019639653984932469691636338705418303482885987114085769045348074530172292982433373154900841135911548332400167290083</span><br>c = <span class="hljs-number">70109332985937768446301118795636999352761371683181615470371772202170324747707233792154935611826981798791499937601162039878070094663516868746240133223110650205575807753345252087103328657073552992431511929172241702073381723302143955977662087561904058172777520360991685289300855900793806183473523998422682944404</span><br>dp = <span class="hljs-number">3098334089252415941833934532457314870210700261428241562420857845879512952043729097866485406309479489101668423603305497982177150304625615059119312238777275</span><br><br>m = dpleak.attack(dp,c,e=e,n=n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>
<h2 id="rsa211eå¾ˆå¤§çš„dpæ³„éœ²æ”»å‡»">[RSA2]11(eå¾ˆå¤§çš„dpæ³„éœ²æ”»å‡»)</h2>
<h3 id="main-10">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span> + <span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">80</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q<br>e = getPrime(<span class="hljs-number">128</span>)<br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><br>dp = d % (p-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;dp = <span class="hljs-subst">&#123;dp&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 108280026722298796068968170303156759745471686664814404724171434502249429011870583595808692893118419248225924869164875379709992190884930717654004006466664403479467573176438601715156464950045121937338569942817256182277141174728470067308962244296992229214749863655518517510026063088263849891990324547823192559069</span><br><span class="hljs-string">e = 305691242207901867366357529364270390903</span><br><span class="hljs-string">c = 26537258289122728220745496185201994733321402056894636636642710319261241111675937946139938310952968353253866895253865273981912174303818938005932883052177988834834575591342856235464380238486868448329727891268391728758132913642966389278296932186703733187105516710825918064228397602264185334108934765627411913661</span><br><span class="hljs-string">dp = 2656631506624565349527023729530989647164022271235521672257622068579788839123502046687139927161669209201953909023994372208117081512139181611949631467292513</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-9">exp</h3>
<p>ä¸Šä¸€é¢˜ä¸­æœ€åæˆ‘ä»¬å‘ç°æœªçŸ¥æ•°kæ˜¯ä¸€ä¸ªå°äº<em>e</em>çš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨äº†éå†[1,<em>e</em>)çš„æ–¹å¼æ¥è¿›è¡Œçˆ†ç ´ï¼Œä½†è¿™ç§æ–¹æ³•ä¸æ€»æ˜¯å¯è¡Œï¼Œä¾‹å¦‚åœ¨æœ¬é¢˜ä¸­<em>e</em>æ˜¯128ä¸ºçš„ç´ æ•°ï¼Œæ˜¾ç„¶æˆ‘ä»¬ä¸èƒ½å»çˆ†ç ´å®ƒäº†ã€‚</p>
<p>æœ¬é¢˜å¯ä»¥çœ‹ä½œ10çš„å‡çº§ç‰ˆï¼Œæ¯”èµ›ä¸­å…¶å®ä¼šæœ‰å¾ˆå¤šçš„å‡çº§ç‰ˆæœ¬ï¼Œè¿™é‡Œå¯ä»¥åˆ†æä¸€ä¸‹æ¡ä»¶</p>
<p>åœ¨RSAä¸­ï¼Œæˆ‘ä»¬ä¸ä»…æœ‰P10ä¸­e*dpçš„å…³ç³»ï¼Œè¿˜æœ‰å…¶ä»–æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„æ¡ä»¶ï¼Œç”±æ¬§æ‹‰é™å¹‚æœ‰</p>
<p><span class="math inline">\(a^{e*dp}â‰¡a^{e*dp \mod (p-1)}â‰¡a\mod
p\)</span></p>
<p>åˆ™ï¼š<span class="math inline">\(a^{e*dp}-aâ‰¡0\mod p\)</span>ï¼Œå³$
a^{e<em>dp} - a = k</em>p$</p>
<p>æ‰€ä»¥<span
class="math inline">\((a^{e*dp}-a)|p\)</span>ï¼Œæ˜¾ç„¶æˆ‘ä»¬å·²ç»æ”»ç ´äº†æœ¬é¢˜ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ±‚è§£<span
class="math inline">\((a^{e*dp}-a)\)</span>å’Œnçš„æœ€å¤§å…¬å› æ•°å³å¯ã€‚</p>
<figure>
<img
src="https://wiper3.oss-cn-guangzhou.aliyuncs.com/blogimage/202311291345449.png" srcset="/img/loading.gif" lazyload
alt="image-20231129134524369" />
<figcaption aria-hidden="true">image-20231129134524369</figcaption>
</figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å…¶å®æ˜¯è¿™ç§ç±»å‹é¢˜çš„é€šè§£</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">108280026722298796068968170303156759745471686664814404724171434502249429011870583595808692893118419248225924869164875379709992190884930717654004006466664403479467573176438601715156464950045121937338569942817256182277141174728470067308962244296992229214749863655518517510026063088263849891990324547823192559069</span><br>e = <span class="hljs-number">305691242207901867366357529364270390903</span><br>c = <span class="hljs-number">26537258289122728220745496185201994733321402056894636636642710319261241111675937946139938310952968353253866895253865273981912174303818938005932883052177988834834575591342856235464380238486868448329727891268391728758132913642966389278296932186703733187105516710825918064228397602264185334108934765627411913661</span><br>dp = <span class="hljs-number">2656631506624565349527023729530989647164022271235521672257622068579788839123502046687139927161669209201953909023994372208117081512139181611949631467292513</span><br><br>a = getPrime(<span class="hljs-number">64</span>)<br>pp = <span class="hljs-built_in">pow</span>(a, e*dp, n) - a<br><br>p = GCD(n, pp)<br>q = n // p<br>d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>
<p>æˆ–è€…ï¼š</p>
<p><strong>â­ä¸€æ‹›é²œåƒéå¤©ï¼Ÿ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> xenny.ctf.crypto.modern.asymmetric.rsa <span class="hljs-keyword">import</span> dpleak<br><br>n = <span class="hljs-number">108280026722298796068968170303156759745471686664814404724171434502249429011870583595808692893118419248225924869164875379709992190884930717654004006466664403479467573176438601715156464950045121937338569942817256182277141174728470067308962244296992229214749863655518517510026063088263849891990324547823192559069</span><br>e = <span class="hljs-number">305691242207901867366357529364270390903</span><br>c = <span class="hljs-number">26537258289122728220745496185201994733321402056894636636642710319261241111675937946139938310952968353253866895253865273981912174303818938005932883052177988834834575591342856235464380238486868448329727891268391728758132913642966389278296932186703733187105516710825918064228397602264185334108934765627411913661</span><br>dp = <span class="hljs-number">2656631506624565349527023729530989647164022271235521672257622068579788839123502046687139927161669209201953909023994372208117081512139181611949631467292513</span><br><br>m = dpleak.attack(dp,c,e=e,n=n)<br>flag = long_to_bytes( m )<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<h2 id="rsa212dæ³„éœ²æ”»å‡»">[RSA2]12(dæ³„éœ²æ”»å‡»)</h2>
<h3 id="main-11">main</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br><span class="hljs-keyword">assert</span> p &lt; q<br><br>n = p*q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = invert(e, phi)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;d = <span class="hljs-subst">&#123;d&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;flag is NSSCTF&#123;md5(p)&#125;&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 113917408220469425995764932761465306974540330325378601642830241920567032775895088098706711486764203845425248022960733155994427766750033219106642310531864450654102562104771892268897793145789045570107312401570269581223945259704851104645493075550316424129401227653740942495625720165869565257394427181127734628103</span><br><span class="hljs-string">d = 15762135247924329080208071933121250646888501386858311483546464344350547831176536290630826247188272280853810047335214127264865205744683174860903496832368687060941437002920094364116706593296591581117381565805322046922482804679245558495134876677733584718947309975077159564300049936769192724856722338627154192353</span><br><span class="hljs-string">flag is NSSCTF&#123;md5(p)&#125;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<h3 id="exp-10">exp</h3>
<p>ç®€åŒ–ä¸ºï¼ˆå…ˆçŸ¥é“ç»“æœï¼Œè¯æ˜è¿‡ç¨‹å…ˆç•¥ç•¥ğŸ˜ï¼‰ï¼š</p>
<p>æœ¬é¢˜æˆ‘ä»¬çš„ç›®æ ‡ä¸å†æ˜¯æ±‚è§£æ˜æ–‡ï¼Œè€Œæ˜¯è€ƒè™‘å½“ç§é’¥å·²ç»æ³„éœ²çš„æƒ…å†µï¼Œèƒ½å¦åˆ©ç”¨å…¬ç§é’¥æ¥è¿›è¡Œå› æ•°åˆ†è§£ã€‚</p>
<p>é¦–å…ˆæœ‰ä¸€ä¸ªå®šç† <span class="math display">\[
r \equiv s(\bmod \phi(n)) \Leftrightarrow a^r \equiv a^s(\bmod n)\\
ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å°†æ¨¡nçš„åŒä½™å¹‚å¼è½¬æ¢æˆå…¶æŒ‡æ•°éƒ¨åˆ†æ¨¡Ï•(n)ä¸‹çš„åŒä½™å¼ã€‚\\
å…¶ä¸­Ï•(n) = Ï†(n)/gï¼Œg=gcd(p-1,q-1)
\]</span> æ‰€ä»¥æœ‰ï¼š<span class="math inline">\(e * d \equiv 1(\bmod
\phi(n)) \Rightarrow a^{e * d} \equiv a(\bmod n)\)</span></p>
<p>æˆ‘ä»¬ä»¤ <span class="math inline">\(e * d-1=2^s * t\)</span></p>
<p>ä½¿å¾— <span class="math inline">\(t\)</span> æ˜¯ä¸€ä¸ªå¥‡æ•°ï¼Œè¿™æ ·æˆ‘ä»¬éå†
<span class="math inline">\([1, s]\)</span>
ï¼Œå‡è®¾èƒ½å¤Ÿæ‰¾åˆ°æ»¡è¶³ä¸‹åˆ—å…³ç³»å¼çš„å¼å­ <span class="math inline">\(a^{2^i *
t} \equiv 1(\bmod n)\)</span> ä¸” <span class="math inline">\(a^{2^{i-1}
* t} \not \equiv \pm 1(\bmod n)\)</span></p>
<p>å°±ä¼šæœ‰ <span class="math inline">\(\operatorname{gcd}\left(a^{2^{i-1}
* t}-1, n\right)=p\)</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>n = <span class="hljs-number">113917408220469425995764932761465306974540330325378601642830241920567032775895088098706711486764203845425248022960733155994427766750033219106642310531864450654102562104771892268897793145789045570107312401570269581223945259704851104645493075550316424129401227653740942495625720165869565257394427181127734628103</span><br>d = <span class="hljs-number">15762135247924329080208071933121250646888501386858311483546464344350547831176536290630826247188272280853810047335214127264865205744683174860903496832368687060941437002920094364116706593296591581117381565805322046922482804679245558495134876677733584718947309975077159564300049936769192724856722338627154192353</span><br>e = <span class="hljs-number">65537</span><br><br>t = e * d - <span class="hljs-number">1</span><br>s = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span>(t % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>):<br>    t = t // <span class="hljs-number">2</span><br>    s += <span class="hljs-number">1</span><br><br><span class="hljs-comment"># æ­¤æ—¶ e * d - 1 = ( 2^s ) * t</span><br>p = <span class="hljs-number">2</span><br>q = <span class="hljs-number">2</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,s):<br>    c1 = powmod(<span class="hljs-number">2</span>,powmod(<span class="hljs-number">2</span>,i,n) * t , n )<br>    c2 = powmod(<span class="hljs-number">2</span>,powmod(<span class="hljs-number">2</span>,(i-<span class="hljs-number">1</span>),n) * t, n )<br>    <span class="hljs-keyword">if</span>(c2 != <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> c2 != n-<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> c1 == <span class="hljs-number">1</span> ):<br>        p = gcd(c2 - <span class="hljs-number">1</span>,n)<br>        q = n // p<br>        <span class="hljs-keyword">break</span><br><br><br><span class="hljs-keyword">if</span> p &gt; q:<br>    p, q = q, p  <span class="hljs-comment">#äº¤æ¢</span><br><br>flag = md5(<span class="hljs-built_in">str</span>(p).encode()).hexdigest()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;NSSCTF&#123;&quot;</span>+flag+<span class="hljs-string">&quot;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure>
<blockquote>
<p>å‚è€ƒï¼š <a
target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74345946/article/details/131192056?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%5BRSA1%5DP4&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-131192056.nonecase&amp;spm=1018.2226.3001.4187">Crypto--RSAç³»åˆ—_irootå‡½æ•°_yolocthçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ruanx.net/rsa-solutions/">CTF RSAé¢˜è§£é›†
(ruanx.net)</a></p>
<p><a target="_blank" rel="noopener" href="https://shimo.im/docs/Dy5ekHJhKo0ap5v3/read">NewStarCTF 2023
Week2 å®˜æ–¹WriteUp (shimo.im)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ruanx.net/rsa-solutions/">CTF RSAé¢˜è§£é›†
(ruanx.net)</a></p>
</blockquote>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF-Crypto/" class="category-chain-item">CTF-Crypto</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CTF/" class="print-no-link">#CTF</a>
      
        <a href="/tags/Crypto/" class="print-no-link">#Crypto</a>
      
        <a href="/tags/RSA/" class="print-no-link">#RSA</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰</div>
      <div>http://viper2383.github.io/2023/09/14/Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>wiper3</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´9æœˆ14æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/09/17/C%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/" title="Cè¯­è¨€å­¦ä¹ è®°å½•">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Cè¯­è¨€å­¦ä¹ è®°å½•</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/14/Crypto%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94RSA%EF%BC%88%E4%B8%80%EF%BC%89/" title="Cryptoç³»åˆ—â€”â€”RSAï¼ˆä¸€ï¼‰">
                        <span class="hidden-mobile">Cryptoç³»åˆ—â€”â€”RSAï¼ˆä¸€ï¼‰</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"Ck2kyOHOxuuBAfQUohEOKi96-gzGzoHsz","appKey":"wdfGUQEKR40axI1tqBj4ZMs6","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
      <div>
        <span id="timeDate">è½½å…¥å¤©æ•°...</span>
        <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
        <script>
        var now = new Date();
        function createtime(){
            var grt= new Date("05/27/2023 00:00:00");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
            now.setTime(now.getTime()+250);
            days = (now - grt ) / 1000 / 60 / 60 / 24;
            dnum = Math.floor(days);
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
            hnum = Math.floor(hours);
            if(String(hnum).length ==1 ){
                hnum = "0" + hnum;
            }
            minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
            mnum = Math.floor(minutes);
            if(String(mnum).length ==1 ){
                      mnum = "0" + mnum;
            }
            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
            snum = Math.round(seconds);
            if(String(snum).length ==1 ){
                      snum = "0" + snum;
            }
            document.getElementById("timeDate").innerHTML = "ğŸš€ &nbsp"+dnum+"&nbspå¤©";  //æ­¤æ¬¡è‡ªå®šä¹‰æ˜¾ç¤ºå†…å®¹
            document.getElementById("times").innerHTML = hnum + "&nbspå°æ—¶&nbsp" + mnum + "&nbspåˆ†&nbsp" + snum + "&nbspç§’";
        }  //æ­¤æ¬¡è‡ªå®šä¹‰æ˜¾ç¤ºå†…å®¹
        setInterval("createtime()",250);
        </script>

      </div>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="leancloud-site-pv"></span>
         æ¬¡
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="leancloud-site-uv"></span>
         äºº
      </span>
    
    

  
</div>

  


  
  

  <script type="text/javascript" id="clustrmaps" src="//clustrmaps.com/map_v2.js?d=BHu02doWTfACgsoaKUKdCvghL0B4M-WZR956AK7Bn-I&cl=ffffff&w=600"></script>
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
