<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>NewStarCTF 2023 week1</title>
    <link href="/2023/09/26/NewStarCTF%202023%20week1/"/>
    <url>/2023/09/26/NewStarCTF%202023%20week1/</url>
    
    <content type="html"><![CDATA[<h2 id="Vigenere"><a href="#Vigenere" class="headerlink" title="VigenÃ¨re"></a>VigenÃ¨re</h2><p>æ‰“å¼€txtåå°±ä¸€æ®µå­—ç¬¦ï¼š</p><p>pqcq{qc_m1kt4_njn_5slp0b_lkyacx_gcdy1ud4_g3nv5x0}</p><p>è¿™æ®µå­—ç¬¦å®³çš„æˆ‘å¥½è‹¦ï¼Œå¤ªå‚»äº†æˆ‘ï¼Œå› ä¸º</p>]]></content>
    
    
    <categories>
      
      <category>CTF-Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MoeCTF 2023</title>
    <link href="/2023/09/24/MoeCTF%202023/"/>
    <url>/2023/09/24/MoeCTF%202023/</url>
    
    <content type="html"><![CDATA[<h2 id="Crypto-å…¥é—¨æŒ‡åŒ—"><a href="#Crypto-å…¥é—¨æŒ‡åŒ—" class="headerlink" title="Crypto å…¥é—¨æŒ‡åŒ—"></a>Crypto å…¥é—¨æŒ‡åŒ—</h2><h3 id="main-py"><a href="#main-py" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag <span class="hljs-comment"># è¿™ä¸ªsecretä¸æ˜¯ä¸€ä¸ªåº“ï¼Œflagæ˜¯ä½ è¦è‡ªå·±æ±‚å‡ºæ¥çš„ï¼Œæ‰€ä»¥ä¸è¦é—®ä¸ºä»€ä¹ˆæ‰¾ä¸åˆ°è¿™ä¸ªåº“äº†ï¼ˆ</span><br><br>p,q = getPrime(<span class="hljs-number">512</span>), getPrime(<span class="hljs-number">512</span>) <span class="hljs-comment"># éšæœºç”Ÿæˆäº†ä¸¤ä¸ªè´¨æ•°</span><br>e = <span class="hljs-number">65537</span> <span class="hljs-comment"># è¿™æ˜¯ä»€ä¹ˆï¼Ÿ</span><br>n = p*q<br>m = <span class="hljs-built_in">int</span>.from_bytes(flag.encode(),<span class="hljs-string">&quot;big&quot;</span>) <span class="hljs-comment"># æŠŠflagç¼–ç æˆbytesï¼Œå†è½¬æ¢æˆä¸€ä¸ªé•¿æ•´æ•°</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n) <span class="hljs-comment"># RSAåŠ å¯†ï¼</span><br><br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-comment"># p = 0xe82a76eeb5ac63e054128e040171630b993feb33e0d3d38fbb7c0b54df3a2fb9b5589d1205e0e4240b8fcb4363acaa4c3c44dd6e186225ebf3ce881c7070afa7</span><br><span class="hljs-comment"># q = 0xae5c2e450dbce36c8d6d1a5c989598fc01438f009f9b4c29352d43fd998d10984d402637d7657d772fb9f5e4f4feee63b267b401b67704979d519ad7f0a044eb</span><br><span class="hljs-comment"># c = 0x4016bf1fe655c863dd6c08cbe70e3bb4e6d4feefacaaebf1cfa2a8d94051d21e51919ea754c1aa7bd1674c5330020a99e2401cb1f232331a2da61cb4329446a17e3b9d6b59e831211b231454e81cc8352986e05d44ae9fcd30d68d0ce288c65e0d22ce0e6e83122621d2b96543cec4828f590af9486aa57727c5fcd8e74bd296</span><br></code></pre></td></tr></table></figure><blockquote><p><code>m = int.from_bytes(flag.encode(),&quot;big&quot;)</code> </p><p>è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸² <code>flag</code> è½¬æ¢æˆä¸€ä¸ªå¤§æ•´æ•° <code>m</code>ã€‚å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li><code>flag</code>: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸åŒ…å«éœ€è¦è¿›è¡ŒåŠ å¯†æˆ–å…¶ä»–æ“ä½œçš„æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚å¯†ç æˆ–æ ‡å¿—ã€‚</li><li><code>flag.encode()</code>: è¿™æ˜¯å°†å­—ç¬¦ä¸² <code>flag</code> è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„æ“ä½œã€‚åœ¨è®¡ç®—æœºä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®æœ€ç»ˆéƒ½ä¼šä»¥å­—èŠ‚çš„å½¢å¼è¡¨ç¤ºã€‚<code>encode()</code> æ–¹æ³•å°†å­—ç¬¦ä¸²ç¼–ç ä¸ºå­—èŠ‚ï¼Œä½¿ç”¨é»˜è®¤çš„ç¼–ç æ–¹å¼ï¼ˆé€šå¸¸æ˜¯UTF-8ï¼‰ã€‚</li><li><code>&quot;big&quot;</code>: è¿™æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œå®ƒå‘Šè¯‰Pythonå°†å­—èŠ‚åºåˆ—è§†ä¸ºä¸€ä¸ªå¤§ç«¯ï¼ˆbig-endianï¼‰çš„æ•´æ•°ã€‚åœ¨å¤§ç«¯è¡¨ç¤ºæ³•ä¸­ï¼Œé«˜ä½å­—èŠ‚åœ¨å‰ï¼Œä½ä½å­—èŠ‚åœ¨åã€‚è¿™æ˜¯ä¸€ç§å¸¸è§çš„è¡¨ç¤ºæ•´æ•°çš„æ–¹å¼ã€‚</li><li><code>int.from_bytes(...)</code>: è¿™æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†å­—èŠ‚åºåˆ—è½¬æ¢ä¸ºæ•´æ•°ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è½¬æ¢çš„å­—èŠ‚åºåˆ—ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¡¨ç¤ºå­—èŠ‚åºåˆ—é¡ºåºçš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œæ˜¯ <code>&quot;big&quot;</code>ã€‚å®ƒä¼šå°†å­—èŠ‚åºåˆ—æŒ‰ç…§æŒ‡å®šçš„é¡ºåºè§£é‡Šä¸ºä¸€ä¸ªæ•´æ•°ã€‚</li></ul><p>å› æ­¤ï¼Œ<code>m</code> å°†åŒ…å«äº†ä»å­—ç¬¦ä¸² <code>flag</code> è½¬æ¢è€Œæ¥çš„æ•´æ•°è¡¨ç¤ºã€‚åœ¨åŠ å¯†ç®—æ³•ä¸­ï¼Œé€šå¸¸ä¼šå°†æ˜æ–‡æ¶ˆæ¯è½¬æ¢æˆæ•´æ•°å½¢å¼ï¼Œä»¥ä¾¿è¿›è¡Œæ•°å­¦è¿ç®—ï¼Œä¾‹å¦‚RSAåŠ å¯†ä¸­çš„æŒ‡æ•°è¿ç®—ã€‚</p></blockquote><blockquote><p><code>c = pow(m,e,n) </code></p><p>è¿™è¡Œä»£ç å®ç°äº†RSAï¼ˆRivestâ€“Shamirâ€“Adlemanï¼‰åŠ å¯†çš„æ ¸å¿ƒæ“ä½œã€‚å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li><code>m</code>: è¿™æ˜¯æ˜æ–‡æ¶ˆæ¯çš„æ•´æ•°è¡¨ç¤ºã€‚åœ¨RSAåŠ å¯†ä¸­ï¼Œæ˜æ–‡æ¶ˆæ¯é€šå¸¸é¦–å…ˆè¢«ç¼–ç æˆä¸€ä¸ªæ•´æ•°ï¼Œè¿™ä¸ªæ•´æ•°åœ¨åŠ å¯†è¿‡ç¨‹ä¸­è¢«å¤„ç†ã€‚</li><li><code>e</code>: è¿™æ˜¯RSAåŠ å¯†ç®—æ³•ä¸­çš„å…¬é’¥æŒ‡æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œé€šå¸¸æ˜¯65537ã€‚å…¬é’¥æŒ‡æ•°æ˜¯ç”¨äºåŠ å¯†æ¶ˆæ¯çš„æŒ‡æ•°ã€‚</li><li><code>n</code>: è¿™æ˜¯RSAåŠ å¯†ç®—æ³•ä¸­çš„æ¨¡æ•°ï¼ˆæˆ–ç§°ä¸ºæ¨¡ulusï¼‰ã€‚å®ƒæ˜¯ä¸¤ä¸ªå¤§ç´ æ•° p å’Œ q çš„ä¹˜ç§¯ã€‚æ¨¡æ•°åœ¨RSAåŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ä¸­éƒ½ä¼šç”¨åˆ°ã€‚</li><li><strong><code>pow(m, e, n)</code>: è¿™æ˜¯Pythonä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè®¡ç®— m çš„ e æ¬¡æ–¹é™¤ä»¥ n çš„ä½™æ•°</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ‰§è¡Œçš„æ˜¯æ¨¡æŒ‡æ•°è¿ç®—ã€‚åœ¨RSAåŠ å¯†ä¸­ï¼Œè¿™ç­‰æ•ˆäºå¯¹æ˜æ–‡æ¶ˆæ¯ m è¿›è¡ŒåŠ å¯†æ“ä½œã€‚</li></ul><p>æœ€ç»ˆï¼Œ<code>c</code> å°†åŒ…å«åŠ å¯†åçš„å¯†æ–‡ï¼Œå®ƒæ˜¯æ•´æ•°å½¢å¼çš„ï¼Œå¯ä»¥é€šè¿‡RSAç§é’¥è¿›è¡Œè§£å¯†ï¼Œä»è€Œè¿˜åŸä¸ºåŸå§‹çš„æ˜æ–‡æ¶ˆæ¯ <code>m</code>ã€‚RSAæ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå…¬é’¥ç”¨äºåŠ å¯†ï¼Œç§é’¥ç”¨äºè§£å¯†ï¼Œè¿™ä½¿å¾—åªæœ‰æ‹¥æœ‰ç§é’¥çš„äººæ‰èƒ½å¤Ÿè§£å¯†å¯†æ–‡ã€‚</p></blockquote><p><em><strong>å“¦~~ï¼Œè¿™é‡Œå°±æ˜¯è¯´flagæ˜¯ä¸çŸ¥é“çš„ï¼Œå°±æ˜¯è®©æˆ‘ä»¬æ±‚ä¸€ä¸‹flag</strong></em></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> * <span class="hljs-comment"># ä¸€ä¸ªéå¸¸å¥½ç”¨çš„cryptoåº“</span><br><br>p = <span class="hljs-number">0xe82a76eeb5ac63e054128e040171630b993feb33e0d3d38fbb7c0b54df3a2fb9b5589d1205e0e4240b8fcb4363acaa4c3c44dd6e186225ebf3ce881c7070afa7</span><br>q = <span class="hljs-number">0xae5c2e450dbce36c8d6d1a5c989598fc01438f009f9b4c29352d43fd998d10984d402637d7657d772fb9f5e4f4feee63b267b401b67704979d519ad7f0a044eb</span><br>c = <span class="hljs-number">0x4016bf1fe655c863dd6c08cbe70e3bb4e6d4feefacaaebf1cfa2a8d94051d21e51919ea754c1aa7bd1674c5330020a99e2401cb1f232331a2da61cb4329446a17e3b9d6b59e831211b231454e81cc8352986e05d44ae9fcd30d68d0ce288c65e0d22ce0e6e83122621d2b96543cec4828f590af9486aa57727c5fcd8e74bd296</span><br>e = <span class="hljs-number">65537</span><br>n = p*q<br>phi = (p-<span class="hljs-number">1</span>) * (q-<span class="hljs-number">1</span>) <span class="hljs-comment"># ä½ çŸ¥é“ä»€ä¹ˆæ˜¯ æ¬§æ‹‰å‡½æ•°å— [1]</span><br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi) <span class="hljs-comment"># ä»€ä¹ˆæ˜¯ä¹˜æ³•é€†å…ƒï¼Ÿ [2]</span><br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>ç›¸å½“äºæˆ‘ä»¬çŸ¥é“äº†pï¼Œqï¼Œcï¼Œeï¼Œç„¶åæ±‚mï¼Œé‚£å°±æ±‚å‡º n å’Œ d å³å¯</p><p>æ‰€ä»¥å…³é”®çš„å°±æ˜¯æ±‚d</p><blockquote><p><code>d = pow(e, -1, phi)</code></p><p>è¿™è¡Œä»£ç è®¡ç®—äº†ç§é’¥ <code>d</code>ï¼Œå®ƒæ˜¯å…¬é’¥æŒ‡æ•° <code>e</code> åœ¨æ¨¡ <code>phi</code> ä¸‹çš„ä¹˜æ³•é€†å…ƒã€‚</p><p>å› ä¸º e å’Œ d ä¹‹é—´ä¸€å®šæ»¡è¶³ï¼š<code>(e * d) % phi(n) = 1</code>ï¼Œå³<code>e*d â‰¡ 1(mod Ï†(N))</code></p><p>è¿™è¡Œä»£ç å…¶å®è·Ÿä¹‹å‰ <em>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_rsa</em> è§£å¯†ä»£ç ä¸­<code>d = gmpy2.invert(e, phi)</code>æ˜¯ä¸€ä¸ªæ„æ€</p></blockquote><ul><li><input disabled="" type="checkbox"> ç”±$ e*d â‰¡ 1(mod Ï†(N)) $å¯ä»¥å¾—å‡º $ e^{-1} â‰¡ d(mod Ï†(N)) $ å—ï¼Ÿ</li></ul><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œç»è¿‡ç®€å•çš„è¿ç®—å³å¯å¾—åˆ°</p><p>çŸ¥è¯†ï¼š[ä¹˜æ³•é€†å…ƒ](<a href="https://oi-wiki.org/math/number-theory/inverse/#%E5%AE%9A%E4%B9%89">ä¹˜æ³•é€†å…ƒ - OI Wiki (oi-wiki.org)</a>)ã€[æ¬§æ‹‰å‡½æ•°](<a href="https://oi-wiki.org/math/number-theory/euler/">æ¬§æ‹‰å‡½æ•° - OI Wiki (oi-wiki.org)</a>) ç­‰</p><hr><h2 id="baby-e"><a href="#baby-e" class="headerlink" title="baby_e"></a>baby_e</h2><h3 id="main-py-1"><a href="#main-py-1" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,bytes_to_long<br><br>p,q = getPrime(<span class="hljs-number">2048</span>),getPrime(<span class="hljs-number">2048</span>)<br>e = <span class="hljs-number">7</span><br>n = p*q<br>m = bytes_to_long(<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read().strip())<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c = &quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n = &quot;</span>,n)<br><br><span class="hljs-comment"># c =  147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span><br><span class="hljs-comment"># n =  553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span><br></code></pre></td></tr></table></figure><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>c = <span class="hljs-number">147693154873835354725007152781732424355869776162377337823960431913672366269917723916891506269449726723757821517328874729037838600793748824028829185409932536014732765063216715033843955453706710187792772702199448156372644163429786386035008302836467605094954587157232829525150652611067567669525072625329634860065850520051628272535479197120008981979404760445193750864902244921407742155742716289495581989134730376783828846663464819337418977287363028738701414486788851136608957124505485242331701209645216580641917007780811842757125048746184068597664780265422321550909392419865169775282217442331295071069272774722564587602419768461231775480847018941840911357926330143045826277813722919121117172763493242590521245640828462665947672485094793188432098216701511715232654611338293295459889814699850788048985878279440740712956248569068077253790198036918598519191892836075254345518967666166925163908185663991353344555402397055977817370082929420443034626201745027965444069777059760865359310439815816749939498993014457995041394803598825093836045546578310632172636478575946653375857640993393714607308326474003446154152048840071034349831168612740218034679021240949747357214453636633636662650940968576792518622437627529244515229173</span><br>n = <span class="hljs-number">553409369582823237678532685244026647155180191225879439432235077135813123637186465008813830373646133388592395760175777499266561095087891764348044063111935877931069321764391883899483374576303169645488542398590564148654412004383012178107972880058460460806768779452529433458826925606225797078653905380530651390617109384086518728626571028089036812787671647095695947167204428442727185744172445701874820612799168887428075695751162763647868386879374037826876671079326544820609721731078985096813307183878793033824330869698508952853770794414757655681370862323768018291030331209143189638496644361618184164228294031490537429556439588954274708598530042700988138862000054458742762198052079867259365645914383561162796796952346445529346145323567650621600171442575319262718389389870407629339714751583360252884338116164466349449862781112019462555743429653595045695696967783338371470032332852204294900011651434678829104876529439166176589508898757122660322523937330848536715937381297551894198974459004139082562228022412335520195652419375915216074658463954339332593244483927157329404652516225481116614815221154229491846087288087715884363786672244655901308480290011237244562251084095684531716327141154558809471185132979704992609461470501119328696999713829</span><br>e = <span class="hljs-number">7</span>       <span class="hljs-comment"># ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“på’Œqå•Šï¼Œè¿™æ€ä¹ˆæ±‚å•Š</span><br><br><br>a, b = gmpy2.iroot(c, <span class="hljs-number">7</span>)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(a))<br><span class="hljs-comment"># print(a)</span><br><br></code></pre></td></tr></table></figure><p>æ€è·¯ï¼ˆvery very very æ„Ÿè°¢å³°å“¥ï¼ˆ<del>å…¶å®æ˜¯å­¦å¼Ÿï¼Œæƒ­æ„§</del>ï¼‰ï¼‰ï¼š</p><p>å°å…¬é’¥æŒ‡æ•°æ”»å‡»ï¼š</p><ul><li>å› ä¸º e å¾ˆå°ï¼Œn å¾ˆå¤§</li><li>æ‰€ä»¥æ˜æ–‡ m ä¹˜äº† e æ¬¡æ–¹ä¹Ÿæ²¡åˆ° n ï¼Œn æ ¹æœ¬æ²¡ç”¨åˆ°</li><li>æ‰€ä»¥ c ç›´æ¥å¼€7æ¬¡æ ¹å°±æ˜¯æ˜æ–‡äº†ï¼Œè¿™é‡Œè¦ç”¨<code>gmpy2.iroot(c, 7)</code>ï¼Œè€Œä¸èƒ½<code>pow(c,1/7)</code>ï¼Œåè€…ç®—ä¸åŠ¨</li><li>æ‰¾æ—¶é—´å»çœ‹ï¼š<a href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_e_attack/">å…¬é’¥æŒ‡æ•°ç›¸å…³æ”»å‡» - CTF Wiki (ctf-wiki.org)</a></li></ul><hr><h2 id="bad-E"><a href="#bad-E" class="headerlink" title="bad_E"></a>bad_E</h2><h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-built_in">print</span>(p) <span class="hljs-comment"># 6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span><br><span class="hljs-built_in">print</span>(q) <span class="hljs-comment"># 11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> fs:<br>    flag = fs.read().strip()<br><br>m = bytes_to_long(flag.encode())<br>c = <span class="hljs-built_in">pow</span>(m,e,p*q)<br><span class="hljs-built_in">print</span>(c) <span class="hljs-comment"># 63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span><br><br></code></pre></td></tr></table></figure><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><p>å‚è€ƒä¸‹é¢çš„åšå®¢ï¼š</p><p><a href="https://blog.csdn.net/qq_57235775/article/details/132575196?ops_request_misc=&request_id=&biz_id=102&utm_term=e%E5%92%8Cphi%E4%B8%8D%E4%BA%92%E7%B4%A0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-132575196.142%5Ev94%5EchatsearchT3_1&spm=1018.2226.3001.4187">eä¸phiä¸äº’ç´ çš„æƒ…å†µ_ä½™åˆ‡66çš„åšå®¢-CSDNåšå®¢</a> </p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-img1694699685619.png" alt="1694699685619"></p><p>eå’Œphiä¸äº’ç´ ï¼Œæœ¬é¢˜æ˜¯gcd(e,q-1)&#x3D;1ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> * <span class="hljs-comment"># ä¸€ä¸ªéå¸¸å¥½ç”¨çš„cryptoåº“</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">6853495238262155391975011057929314523706159020478084061020122347902601182448091015650787022962180599741651597328364289413042032923330906135304995252477571</span><br>q = <span class="hljs-number">11727544912613560398705401423145382428897876620077115390278679983274961030035884083100580422155496261311510530671232666801444557695190734596546855494472819</span><br><br>c = <span class="hljs-number">63388263723813143290256836284084914544524440253054612802424934400854921660916379284754467427040180660945667733359330988361620691457570947823206385692232584893511398038141442606303536260023122774682805630913037113541880875125504376791939861734613177272270414287306054553288162010873808058776206524782351475805</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-built_in">print</span>(gcd(e,q-<span class="hljs-number">1</span>))<br><br><br>phi = q-<span class="hljs-number">1</span><br>d = gmpy2.invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,q)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h2 id="factor-signin"><a href="#factor-signin" class="headerlink" title="factor_signin"></a>factor_signin</h2><h3 id="main-1"><a href="#main-1" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> prod<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    flag = f.read().strip()<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">72</span><br><br>m1 = <span class="hljs-built_in">int</span>.from_bytes(flag[:<span class="hljs-number">36</span>],<span class="hljs-string">&quot;big&quot;</span>)<br>m2 = <span class="hljs-built_in">int</span>.from_bytes(flag[<span class="hljs-number">36</span>:],<span class="hljs-string">&quot;big&quot;</span>)<br><br>e = <span class="hljs-number">65537</span><br><br>p,q = getPrime(<span class="hljs-number">2048</span>),getPrime(<span class="hljs-number">2048</span>)<br>n1 = p*q<br>c1 = <span class="hljs-built_in">pow</span>(m1,e,n1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c1 = &quot;</span>,c1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n1 = &quot;</span>,n1)<br><br>primes = [getPrime(<span class="hljs-number">64</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br>n2 = prod(primes)<br>c2 = <span class="hljs-built_in">pow</span>(m2,e,n2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c2 = &quot;</span>,c2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n2 = &quot;</span>,n2)<br><br><span class="hljs-comment"># c1 =  10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br><span class="hljs-comment"># n1 =  343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span><br><span class="hljs-comment"># c2 =  4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br><span class="hljs-comment"># n2 =  8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br></code></pre></td></tr></table></figure><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><p>å‰åŠéƒ¨åˆ†ï¼šç›´æ¥åˆ†è§£n1</p><p>ååŠéƒ¨åˆ†ï¼šn2æ˜¯å¤šä¸ªç´ æ•°çš„ä¹˜ç§¯ï¼Œæ±‚æ¬§æ‹‰å‡½æ•°ï¼Œæˆ‘æ•™è¿‡ä½ å§ğŸ˜‹<del>ï¼ˆä½†æ˜¯è¿™ä¸ªè„šæœ¬æˆ‘è¿˜çœŸç¬¬ä¸€æ¬¡è§</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><br>e = <span class="hljs-number">65537</span><br><br>c1 =  <span class="hljs-number">10004937130983861141937782436252502991050957330184611684406783226971057978666503675149401388381995491152372622456604317681236160071166819028679754762162125904637599991943368450200313304999566592294442696755822585022667008378021280392976010576970877334159755332946926433635584313137140987588847077645814987268595739733550220882135750267567373532603503399428451548677091911410732474324157868011686641243202218731844256789044721309478991918322850448456919991540932206923861653518190974620161055008847475600980152660468279765607319838003177639654115075183493029803981527882155542925959658123816315099271123470754815045214896642428657264709805029840253303446203030294879166242867850331945166255924821406218090304893024711068773287842075208409312312188560675094244318565148284432361706108491327014254387317744284876018328591380705408407853404828189643214087638328376675071962141118973835178054884474523241911240926274907256651801384433652425740230755811160476356172444327762497910600719286629420662696949923799255603628210458906831175806791599965316549386396788014703044837917283461862338269599464440202019922379625071512100821922879623930069349084917919100015782270736808388388006084027673781004085620817521378823838335749279055639005125</span><br>n1 =  <span class="hljs-number">343504538870081878757729748260620800783581983635281373321527119223374418103340873199654926888439040391545101913132680017655039577253974802351999985470115474655124168592386965001556620077117966153475518658881140827499124290142523464795351995478153288872749817655925271395693435582010998996210909883510311066017237567799370371513462802547313382594409676803895262837061350017911885033133654781876923251129406855067993830824618637981136966134029212516871210627954762147349788788999116702635535406398258621926040887099782494271000823401788337120154104692934583729065189687995570122890809807661370008740283447636580308161498808092269041815719148127168137018600113465985504975054319601741498799761500526467431533990903047624407330243357514588557352746347337683868781554819821575385685459666842162355673947984514687068626166144076257334426612302554448774082488600083569900006274897032242821388126274957846236552373226099112200392102883351088570736254707966329366625911183721875374731791052229266503696334310835323523568132399330263642353927504971311717117370721838701629885670598853025212521537158141447625623337563164790788106598854822686494249848796441153496412236527242235888308435573209980270776407776277489669763803746640746378181948641</span><br>c2 =  <span class="hljs-number">4948422459907576438725352912593232312182623872749480015295307088166392790756090961680588458629287353136729331282506869598853654959933189916541367579979613191505226006688017103736659670745715837820780269669982614187726024837483992949073998289744910800139692315475427811724840888983757813069849711652177078415791290894737059610056340691753379065563574279210755232749774749757141836708161854072798697882671844015773796030086898649043727563289757423417931359190238689436180953442515869613672008678717039516723747808793079592658069533269662834322438864456440701995249381880745586708718334052938634931936240736457181295</span><br>n2 =  <span class="hljs-number">8582505375542551134698364096640878629785534004976071646505285128223700755811329156276289439920192196962008222418309136528180402357612976316670896973298407081310073283979903409463559102445223030866575563539261326076167685019121804961393115251287057504682389257841337573435085535013992761172452417731887700665115563173984357419855481847035192853387338980937451843809282267888616833734087813693242841580644645315837196205981207827105545437201799441352173638172133698491126291396194764373021523547130703629001683366722885529834956411976212381935354905525700646776572036418453784898084635925476199878640087165680193737</span><br><br>p1 = <span class="hljs-number">18055722101348711626577381571859114850735298658417345663254295930584841136416234624852520581982069555948490061840244710773146585295336094872892685938420880462305333393436098181186277450475949236132458958671804132443554885896037342335902958516394876382378829317303693655605215373555988755516058130500801822723195474873517960624159417903134580987202400855946137101429970119186394052011747475879598126195607938106163892658285305921071673588966184054026228745012993740035399652049777986535759039077634555909031397541116025395236871778797949216479130412500655359057128438928721459688727543057760739527720641179290282309741</span><br>q1 = <span class="hljs-number">19024691283015651666032297670418553586155390575928421823630922553034857624430114628839720683172187406577114034710093054198921843669645736474448836706112221787749688565566635453151716934583685087745112614898780150391513798368931496744574075511968933800467288441832780919514199410584786925010518564670786685241724643282580795568609339268652910564215887176803735675069372979560024792322029911970574914829712553975379661212645059271137916107885326625543090473004683836665262304916304580076748336858662108554591235698235221618061328251985929904075811056422186525179189846420226944944513865790999242309352900287977666792901</span><br><br>phi = (p1-<span class="hljs-number">1</span>)*(q1-<span class="hljs-number">1</span>)<br>d = invert(e,phi)<br>m = <span class="hljs-built_in">pow</span>(c1,d,n1)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><br>factor = <span class="hljs-string">&#x27;&#x27;&#x27;P20 = 14745811312384518031</span><br><span class="hljs-string">P20 = 18345408081492711641</span><br><span class="hljs-string">P20 = 14678737767649343977</span><br><span class="hljs-string">P20 = 14619040595108594017</span><br><span class="hljs-string">P19 = 9949603102225364603</span><br><span class="hljs-string">P20 = 12034779627328165471</span><br><span class="hljs-string">P20 = 10596280721192026229</span><br><span class="hljs-string">P20 = 15211380502610462057</span><br><span class="hljs-string">P20 = 14813953870710226847</span><br><span class="hljs-string">P20 = 13062839684118954553</span><br><span class="hljs-string">P20 = 15332916111580607077</span><br><span class="hljs-string">P20 = 16870346804576162551</span><br><span class="hljs-string">P20 = 11092420583960163379</span><br><span class="hljs-string">P20 = 14397830993057803133</span><br><span class="hljs-string">P20 = 16123604149048919099</span><br><span class="hljs-string">P20 = 13645878578452317313</span><br><span class="hljs-string">P20 = 17093292308638969889</span><br><span class="hljs-string">P20 = 17289161209347211817</span><br><span class="hljs-string">P20 = 15175734709842430433</span><br><span class="hljs-string">P20 = 15751974537676958401</span><br><span class="hljs-string">P20 = 10864078180916418691</span><br><span class="hljs-string">P20 = 17673334943789572513</span><br><span class="hljs-string">P20 = 18390046459144888243</span><br><span class="hljs-string">P20 = 12404642343676224637</span><br><span class="hljs-string">P20 = 18106525049998616747</span><br><span class="hljs-string">P20 = 11853704782834170959</span><br><span class="hljs-string">P20 = 17543713628803023199</span><br><span class="hljs-string">P20 = 10049235158029375571</span><br><span class="hljs-string">P20 = 12448177342966243757</span><br><span class="hljs-string">P20 = 17265001711647542137</span><br><span class="hljs-string">P20 = 10547615587767500213</span><br><span class="hljs-string">P20 = 16408421615173973083&#x27;&#x27;&#x27;</span><br><br>factor = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,[i.split()[-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> factor.split(<span class="hljs-string">&#x27;\n&#x27;</span>)]))<br>phin = reduce(<span class="hljs-keyword">lambda</span> a,b:a*(b-<span class="hljs-number">1</span>),[<span class="hljs-number">1</span>] + factor)<br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phin)<br>m2 = <span class="hljs-built_in">pow</span>(c2,d,n2)<br><br><span class="hljs-comment"># print(bytes.fromhex(hex(pow(c2,d,n2))[2:]))</span><br><br><br><span class="hljs-built_in">print</span>(long_to_bytes(m2))<br><span class="hljs-comment"># b&#x27;moectf&#123;fACtord6_And_YAfu_Are_6oth_good_utils_to_fACtorize_num6ers_ff90S&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="feistel"><a href="#feistel" class="headerlink" title="feistel"></a>feistel</h2><h3 id="main-2"><a href="#main-2" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-built_in">round</span> = <span class="hljs-number">2</span><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./secret&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read().strip()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">m, key</span>):<br>    m = m ^ (m &gt;&gt; <span class="hljs-number">4</span>)<br>    m = m ^ (m &lt;&lt; <span class="hljs-number">5</span>)<br>    m = m ^ (m &gt;&gt; <span class="hljs-number">8</span>)<br>    m ^= key<br>    m = (m * <span class="hljs-number">1145</span> + <span class="hljs-number">14</span>) % <span class="hljs-number">2</span>**<span class="hljs-number">64</span><br>    m = (m * <span class="hljs-number">1919</span> + <span class="hljs-number">810</span>) % <span class="hljs-number">2</span>**<span class="hljs-number">64</span><br>    m = (m * key) % <span class="hljs-number">2</span>**<span class="hljs-number">64</span><br>    <span class="hljs-keyword">return</span> m<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">m, key, <span class="hljs-built_in">round</span></span>):<br>    key = bytes_to_long(key)<br>    left = bytes_to_long(m[:<span class="hljs-number">8</span>])<br>    right = bytes_to_long(m[<span class="hljs-number">8</span>:])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">round</span>):<br>        left, right = right, f(right, key) ^ left<br>    left, right = right, left<br>    <span class="hljs-keyword">return</span> long_to_bytes(left).rjust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>) + long_to_bytes(right).rjust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">padding</span>(<span class="hljs-params">m</span>):<br>    mlen = <span class="hljs-built_in">len</span>(m)<br>    pad = <span class="hljs-number">16</span> - mlen % <span class="hljs-number">16</span><br>    <span class="hljs-keyword">return</span> m + pad * <span class="hljs-built_in">bytes</span>([pad])<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ecb_enc</span>(<span class="hljs-params">m, key</span>):<br>    m = padding(m)<br>    mlen = <span class="hljs-built_in">len</span>(m)<br>    c = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(mlen // <span class="hljs-number">16</span>):<br>        c += enc(m[i * <span class="hljs-number">16</span> : i * <span class="hljs-number">16</span> + <span class="hljs-number">16</span>], key, <span class="hljs-built_in">round</span>)<br>    <span class="hljs-keyword">return</span> c<br><br><br><span class="hljs-built_in">print</span>(ecb_enc(flag, <span class="hljs-string">b&quot;wulidego&quot;</span>))<br><br><span class="hljs-comment"># b&#x27;\x0b\xa7\xc6J\xf6\x80T\xc6\xfbq\xaa\xd8\xcc\x95\xad[\x1e\&#x27;W5\xce\x92Y\xd3\xa0\x1fL\xe8\xe1&quot;^\xad&#x27;</span><br><br></code></pre></td></tr></table></figure><h2 id="n-n"><a href="#n-n" class="headerlink" title="n&amp;n"></a>n&amp;n</h2><h3 id="main-3"><a href="#main-3" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    flag = f.read().strip().encode()<br><br>m = bytes_to_long(flag)<br>n = p * q<br>e1 = <span class="hljs-number">0x114514</span><br>e2 = <span class="hljs-number">19198101</span><br><br>c1 = <span class="hljs-built_in">pow</span>(m,e1,n)<br>c2 = <span class="hljs-built_in">pow</span>(m,e2,n)<br><span class="hljs-built_in">print</span>(c1) <br><span class="hljs-built_in">print</span>(c2)<br><span class="hljs-built_in">print</span>(n)<br><br><span class="hljs-comment"># 5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span><br><span class="hljs-comment"># 4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span><br><span class="hljs-comment"># 13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span><br></code></pre></td></tr></table></figure><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><p>å…±æ¨¡æ”»å‡»ï¼Œç”¨çš„è„šæœ¬</p><p><u>è¿™é‡Œåå…­è¿›åˆ¶çš„e1ç«Ÿç„¶ä¸ç”¨è½¬æ¢</u></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gmpy2<br> <br>c1 = <span class="hljs-number">5776799746376051463605370130675046329799612910435315968508603116759552095183027263116443417343895252766060748671845650457077393391989018107887540639775168897954484319381180406512474784571389477212123123540984850033695748142755414954158933345476509573211496722528388574841686164433315356667366007165419697987147258498693175698918104120849579763098045116744389310549687579302444264316133642674648294049526615350011916160649448726069001139749604430982881450187865197137222762758538645387391379108182515717949428258503254717940765994927802512049427407583200118969062778415073135339774546277230281966880715506688898978925</span><br>c2 = <span class="hljs-number">4664955020023583143415931782261983177552050757537222070347847639906354901601382630034645762990079537901659753823666851165175187728532569040809797389706253282757017586285211791297567893874606446000074515260509831946210526182765808878824360460569061258723122198792244018463880052389205906620425625708718545628429086424549277715280217165880900037900983008637302744555649467104208348070638137050458275362152816916837534704113775562356277110844168173111385779258263874552283927767924979691542028126412133709129601685315027689094437957165812994784648540588277901241854031439324974562449032290219652206466731675967045633360</span><br>e1 = <span class="hljs-number">0x114514</span><br>e2 = <span class="hljs-number">19198101</span><br><br><span class="hljs-comment"># e1 = int(str(e1), 16) </span><br><br><br>n = <span class="hljs-number">13612969130810965900902742090064423006385890357159609755971027204203418808937093492927060428980020085273603754747223030702684866992231913349067578014240319426522039068836171388168087260774376277346092066880984406890296520951318296354893551565670293486797637522297989653182109744864444697818991039473180752980752117041574628063002176339235126861152739066489620021077091941250365101779354009854706729448088217051728432010328667839532327286559570597994183126402340332924370812383312664419874352306052467284992411543921858024469098268800500500651896608097346389396273293747664441553194179933758992070398387066135330851531</span><br><br><br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RSA_ComModAtk</span>(<span class="hljs-params">e1, e2, c1, c2, n</span>):<br>    e1, e2, c1, c2, n = <span class="hljs-built_in">int</span>(e1), <span class="hljs-built_in">int</span>(e2), <span class="hljs-built_in">int</span>(c1), <span class="hljs-built_in">int</span>(c2), <span class="hljs-built_in">int</span>(n)<br>    <span class="hljs-keyword">if</span> gmpy2.gcd(e1,e2) ==<span class="hljs-number">1</span>:<br>        s = gmpy2.gcdext(e1, e2)  <span class="hljs-comment"># æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•-è¾—è½¬ç›¸é™¤æ³•ä½¿å¾—  x*e1+y*e2=1,æ±‚å‡ºtå’Œz</span><br>        x = s[<span class="hljs-number">1</span>]<br>        y = s[<span class="hljs-number">2</span>]<br>        <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span>:<br>            x = - x  <span class="hljs-comment"># å˜æŒ‡æ•°ä¸ºæ­£å€¼</span><br>            c1 = gmpy2.invert(c1, n)  <span class="hljs-comment"># æ±‚c1çš„é€†å…ƒ</span><br>        <span class="hljs-keyword">if</span> y &lt; <span class="hljs-number">0</span>:<br>            y = -y  <span class="hljs-comment"># å˜æŒ‡æ•°ä¸ºæ­£å€¼</span><br>            c2 = gmpy2.invert(c2, n)  <span class="hljs-comment"># æ±‚c2çš„é€†å…ƒ</span><br>        m = (<span class="hljs-built_in">pow</span>(c1, x, n) * <span class="hljs-built_in">pow</span>(c2, y, n)) % n  <span class="hljs-comment"># (c1^x*c2^y)%n=m^e1x*me2y%n=m^(e1x+e2y)%n=m%n=m</span><br>        <span class="hljs-keyword">return</span> m<br>    <span class="hljs-keyword">else</span> :<br>        <span class="hljs-keyword">return</span> bytes_to_long(<span class="hljs-string">b&#x27;e1 and e2 are not relatively prime&#x27;</span>) <span class="hljs-comment"># e1å’Œe2ä¸äº’è´¨</span><br>    <br><br>m = RSA_ComModAtk(e1, e2, c1, c2, n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h2 id="factorize-me"><a href="#factorize-me" class="headerlink" title="factorize_me!"></a>factorize_me!</h2><h3 id="main-4"><a href="#main-4" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> prod<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> nextprime<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choices<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> fs:<br>    flag = fs.read().strip()<br><br>primes = [getPrime(<span class="hljs-number">512</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;prod(primes) = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;prod(p - <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> primes) = &#125;</span>&quot;</span>)<br><br>primes2 = [nextprime(p) <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> choices(primes, k=<span class="hljs-number">3</span>)]<br>n = prod(primes2)<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">int</span>.from_bytes(flag, <span class="hljs-string">&#x27;big&#x27;</span>), e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># 363364907814244019888662301376841344262476227242899756862391470731421569394957444030214887114615748277199649349781524749919652160244484352285668794188836866602305788131186220057989320357344904731322223310531945208433910803617954798258382169132907508787682006064930747033681966462568715421005454243255297306718356766130469885581576362173340673516476386201173298433892314145854649884922769732583885904512624543994675379894718657682146178638074984373206937523380103438050549181568015985546172618830480078894445808092527561363650503540062128543705172678754195578429520889784813733491180748361345720247750720179608752244490362713103319685024237941527268458213442611663415417005556439749055222361212059968254748751273361732365487788593341859760309778894350385339764442343374673786357175846291309425081492959910254127778240522152676060766139057453197528944251599979227271074508795482632471242983094008619339488744362509349734218480932255216087706001484182136783834973304870508270118505737767002256270427907341952256516206663258530300791364944105025764611810001781971638030661367630116818647252727909489405550104641122269772492252464714694507693447974171377200402508765841829763548525530878309985480248379655169722567051495205792089930014228403456098065971372039443284193603395249634283366194562380309469628114581468645669390610963076340643757972439104287127375438663839421605531570285615180251</span><br><span class="hljs-comment"># 363364907814244019888662301376841344262476227242899756862391470731421569394957444030214887114615748277199649349781524749919652160244484352285668794188836492373364350673588273863828369502073826782362255108313852264064760467561392054178047091483873483255491431451728274259516789065331176728192953741805933100379191778599394515981288225535175013258094287912195847642598436035132783919453991516358280321085873745330313812205910011387125778714795906023110368957596998222544234082487264006696812862179916726781327290284827659294751262185328816323311831349296593013038823107653943652771448719760448938995150646738377177532550757319539185878535087009904848382493668686831331474113789651777885239747000076063679062106375348803749466079052774597412239427050432901553466002731972993029311850718200685157193170716432600165476733200831046297530470544781309612128231925681374239849452623513538498417735984094919756374577623486416462101457492789215144166273775249387638107644634704270216130852885082174564648445147377239033930079759024399532146184753110240154062693457622208373371290126810856885343328090305620627668495081760346853701632815149478447405718664667978825807101325764916405446176183238866136433205933785973568759281210319422288153910340542098573782006262190181726245838857185687242960093445000287347616796984610291664809895901301187179157382169999966124177588884152267266994164841066291200</span><br><span class="hljs-comment"># n = 899081756851564072995842371038848265712822308942406479625157544735473115850983700580364485532298999127834142923262920189902691972009898741820291331257478170998867183390650298055916005944577877856728843264502218692432679062445730259562784479410120575777748292393321588239071577384218317338474855507210816917917699500763270490789679076190405915250953860114858086078092945282693720016414837231157788381144668395364877545151382171251673050910143023561541226464220441</span><br><span class="hljs-comment"># e = 65537</span><br><span class="hljs-comment"># c = 841335863342518623856757469220437045493934999201203757845757404101093751603513457430254875658199946020695655428637035628085973393246970440054477600379027466651143466332405520374224855994531411584946074861018245519106776529260649700756908093025092104292223745612991818151040610497258923925952531383407297026038305824754456660932812929344928080812670596607694776017112795053283695891798940700646874515366341575417161087304105309794441077774052357656529143940010140</span><br></code></pre></td></tr></table></figure><h3 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h3><p><strong>[RSA1]P7</strong>ï¼Œç›´æ¥åˆ†è§£nè¿ç®—å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">841335863342518623856757469220437045493934999201203757845757404101093751603513457430254875658199946020695655428637035628085973393246970440054477600379027466651143466332405520374224855994531411584946074861018245519106776529260649700756908093025092104292223745612991818151040610497258923925952531383407297026038305824754456660932812929344928080812670596607694776017112795053283695891798940700646874515366341575417161087304105309794441077774052357656529143940010140</span><br><br>p = <span class="hljs-number">6991223361118904775931217829045348785013077549030883418924453538830605687999480005714979700653172534877541317997174968789510984315425270755055110913347349</span><br>q = <span class="hljs-number">9987009117206906203158749743824168660291275882852229158070368815160479543708376165641735042845357978292384303332559592302507789120810447986634662721490849</span><br>r = <span class="hljs-number">12876877424944854147075816504195994138450356002779004886384584287813869165469217718717854027672044903401715370348223932937626725119320180795716270261309141</span><br><br><br>n = p * q * r<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)<br><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))  <br><br><span class="hljs-comment"># ä¸çŸ¥é“ä¸Šé¢ç»™é‚£ä¸¤ä¸ªå¤§æ•°æ˜¯å¹²å•¥çš„</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> gcd<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> isqrt<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randrange<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">factorize_multi_prime</span>(<span class="hljs-params">N, phi</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span><br><span class="hljs-string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span><br><span class="hljs-string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span><br><span class="hljs-string">    :param N: the modulus</span><br><span class="hljs-string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span><br><span class="hljs-string">    :return: a tuple containing the prime factors</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    prime_factors = <span class="hljs-built_in">set</span>()<br>    factors = [N]<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(factors) &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-comment"># Element to factorize.</span><br>        N = factors[<span class="hljs-number">0</span>]<br><br>        w = randrange(<span class="hljs-number">2</span>, N - <span class="hljs-number">1</span>)<br>        i = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> phi % (<span class="hljs-number">2</span> ** i) == <span class="hljs-number">0</span>:<br>            sqrt_1 = <span class="hljs-built_in">pow</span>(w, phi // (<span class="hljs-number">2</span> ** i), N)<br>            <span class="hljs-keyword">if</span> sqrt_1 &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> sqrt_1 != N - <span class="hljs-number">1</span>:<br>                <span class="hljs-comment"># We can remove the element to factorize now, because we have a factorization.</span><br>                factors = factors[<span class="hljs-number">1</span>:]<br><br>                p = gcd(N, sqrt_1 + <span class="hljs-number">1</span>)<br>                q = N // p<br><br>                <span class="hljs-keyword">if</span> is_prime(p):<br>                    prime_factors.add(p)<br>                <span class="hljs-keyword">elif</span> p &gt; <span class="hljs-number">1</span>:<br>                    factors.append(p)<br><br>                <span class="hljs-keyword">if</span> is_prime(q):<br>                    prime_factors.add(q)<br>                <span class="hljs-keyword">elif</span> q &gt; <span class="hljs-number">1</span>:<br>                    factors.append(q)<br><br>                <span class="hljs-comment"># Continue in the outer loop</span><br>                <span class="hljs-keyword">break</span><br><br>            i += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">tuple</span>(prime_factors)<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF-Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cryptoç³»åˆ—â€”â€”RSAï¼ˆäºŒï¼‰</title>
    <link href="/2023/09/24/Crypto%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94RSA%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2023/09/24/Crypto%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94RSA%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>ã€Šä»0å¼€å§‹çš„å¯†ç å­¦ä¸–ç•Œç”Ÿæ´»ã€‹ğŸ˜‹æ…¢æ…¢å­¦å¯†ç æ–¹å‘</p><p>2023.09.14-</p><h2 id="RSA2-1-å°æ˜æ–‡æ”»å‡»"><a href="#RSA2-1-å°æ˜æ–‡æ”»å‡»" class="headerlink" title="[RSA2]1(å°æ˜æ–‡æ”»å‡»)"></a>[RSA2]1(å°æ˜æ–‡æ”»å‡»)</h2><h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">5120</span>)<br>q = getPrime(<span class="hljs-number">5120</span>)<br><br>n = p*q<br>e = <span class="hljs-number">97</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 1392208858696945158251408085300402884210409327605255122395601049457847957306648819174395014931778575812308192875319127224095733396726388842605854427013313599830150182564652493067830031524869535522568868597852507293377043240832819715539722122306829543983051745406887140154364256267942350230636870212935356815475345989038318923389132101208917912083817520799490534351545373438629367819085151041702754019127891155542476560972125790519584018715794669416759039955180436830478697704458250990786586357019211642837879273967620287257818400267757312623543898635740200839249361087580046496969637043238450499583879116276661827372750638403042213043389905183760455450595752578482968202040860053524276678108325784161897719093223308370971388068813420487879756084379519128232693549989942550047529174783976176943482484756074638704076740157397067892580297182979526978967352014250386678155843772313996171396582929433057131989693861316408604436872931427368192437680361830753162284661119995125858203931094922686321756465463988790748131178263745308042820480140189644732824717255521633534750635979508673908361269979175726073254050574688259969290376926807033728165164896588540691889207252105903436659968119091774687841336252628343233161941187968365128093917171537997137001140227677728923114895809278926486615010954871408034272872411042537353956193868948909981683850857262457369506288525323882308421700421661036191853577105238753230479541719001794464585534292774768292358961920606891227776349593589481547577148801600196035588544512224775960892265021565124673788852875005526313525709353599584812394138968970647681759439523307392275602626903789154682706839530654070108096741181206975334567778238856983205004289416400671597321919876279909765650782227834097342294844294386380646928266942749144240020420237153276705785759403019072953506982997681174635673907151856644499332322321579088035719680421458310273802481031746012298208449699089203065699598926690947025679591160106357130634946357609420125223580319677387654711233585375013067828291928349946599077331636017784447090096340360087970540477975170379810969501197027775838769222713506443846417124839450184827707739588007707714623211453528342755023849716924694572679150284882978804641986457119009272574734697043321033091757474387114449914271460113979531460465175717705674905568446670579332667139075523255580471183372714211547822093365025438653384719374474230360983878837077517864405475258349436531094649276628214288499716485354283135575921258757214288792410583835467572916298688718758374714560819702413058421373661892101033513816116981698045524150518509405086125781764762145577981637953775680403132163846782252745029783387112660812179706752454175492501665442704630131729362621965258498471247871904163412798544329515689112368523703890083138721480476796720323855371775568097188216621368341228806795058046403892301673157631331636430392885315997250027372621883549649614866115616619234953579196607399899485002042456482969222428121605212017146571466818179341621066715472184636758016242256725063854155219754299817717414423725704356940589670902509021070871847017199593680033</span><br><span class="hljs-string">e = 97</span><br><span class="hljs-string">c = 79418540691422578656139651796213224829563266521211325595707569487401417030874358531413674275017334363641194166574500833916574827523075402219754470871728896772312056257743844227927800121160288525434484105786180547178403828613331285574461293211150728313415280329153597549251599876668080073528625299164784405291297754331374420687599875173508778209038236713812747215157059659564867241144529476211694011692007565732793105429228730285249025627762831080251661835294067942958070742202862164086250986988784472568266652325462247009294865764533077164470382743735937483173523682749295196383707694876943634298051820105410771024861599560176707940488888601355473498847493259474613261665538825299531665650233837474894442826242097663456648233384047622152817959729025415665280499618951478005159820575701483220155180955748454167435711033379910310483689839303198822665341421591234243891877857520663120183063591818656508336831518527692847950877186870610083654117153248336928856886934232488927132245720058243202637258025864487122393335118118013444397135476780564523166548571927547341556616683070253790368891423731046742936358877118104790084195711730135202600692806999992373490439385845158780392894927697171401722699273071306493916233696254958735540772870249139252741670476667099529502282392011715616110876451102234600267482991583515122052976378641894214562203326290939184469206074418127906704847146567350085797480500249400491003993809769407575997740985283755035509654310797061339563655229926356893455738361409861102662109994984398860070584568014471082484198504331014073023689622378943694856212172718725529473812336321642429261822836311084518735006587545920946664595488768239633950124822001162595168106106356115962424210028401369438479550293237915944302351566624339603616714683958384871326105542659559877758488581425288668613061792514360263277530824203967659102107889148367539858141289229124274098921748855341045565232484417195620758495861456624842263649414501657786484816662971421962216348340311859717286253287173293151613310383128702607971580042308515018120559903265609733911340589091613087560931098833849573462572181625894166772788435459280323623477689159384354671220634694792005231505741029567734616435905915192606539962414882105254409847885996949466940350184140166614950171110955365828033747003120697209120916652982201967537088553504504252785632280900095976870510754563400828951684036526240669112248351928072177486091157562600003336544767896806392523395037345770580482363058065676920013089896399387769312374871419827762872050800055872960573607645266626972865053489632548224840580503746879607167797904430560935476705014800973841917939689270919224595772574781478285359220463175042728750523639669204218676238297875644055563803457896409252533724486937378974745777400567080239687055154021761534918106133195512030935957251049812753269173090858930245212145938555697547499155977225759702066548720079477737104010668116693232798415289735481194922014811945312893853446826780868861295203942063380964100360870361328125</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><ul><li><input checked="" disabled="" type="checkbox"> <strong>å°æ˜æ–‡æ”»å‡»</strong></li></ul><p><strong>åŠ å¯†æŒ‡æ•°æŒ‡çš„æ˜¯eï¼Œeä¸€èˆ¬å–65535ï¼Œä½†å½“eå¾ˆå°æ—¶ï¼Œå¯ç›´æ¥è§£å¯†</strong></p><p>è¿™é‡Œ**$ m^{e} &lt; c$**</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">1392208858696945158251408085300402884210409327605255122395601049457847957306648819174395014931778575812308192875319127224095733396726388842605854427013313599830150182564652493067830031524869535522568868597852507293377043240832819715539722122306829543983051745406887140154364256267942350230636870212935356815475345989038318923389132101208917912083817520799490534351545373438629367819085151041702754019127891155542476560972125790519584018715794669416759039955180436830478697704458250990786586357019211642837879273967620287257818400267757312623543898635740200839249361087580046496969637043238450499583879116276661827372750638403042213043389905183760455450595752578482968202040860053524276678108325784161897719093223308370971388068813420487879756084379519128232693549989942550047529174783976176943482484756074638704076740157397067892580297182979526978967352014250386678155843772313996171396582929433057131989693861316408604436872931427368192437680361830753162284661119995125858203931094922686321756465463988790748131178263745308042820480140189644732824717255521633534750635979508673908361269979175726073254050574688259969290376926807033728165164896588540691889207252105903436659968119091774687841336252628343233161941187968365128093917171537997137001140227677728923114895809278926486615010954871408034272872411042537353956193868948909981683850857262457369506288525323882308421700421661036191853577105238753230479541719001794464585534292774768292358961920606891227776349593589481547577148801600196035588544512224775960892265021565124673788852875005526313525709353599584812394138968970647681759439523307392275602626903789154682706839530654070108096741181206975334567778238856983205004289416400671597321919876279909765650782227834097342294844294386380646928266942749144240020420237153276705785759403019072953506982997681174635673907151856644499332322321579088035719680421458310273802481031746012298208449699089203065699598926690947025679591160106357130634946357609420125223580319677387654711233585375013067828291928349946599077331636017784447090096340360087970540477975170379810969501197027775838769222713506443846417124839450184827707739588007707714623211453528342755023849716924694572679150284882978804641986457119009272574734697043321033091757474387114449914271460113979531460465175717705674905568446670579332667139075523255580471183372714211547822093365025438653384719374474230360983878837077517864405475258349436531094649276628214288499716485354283135575921258757214288792410583835467572916298688718758374714560819702413058421373661892101033513816116981698045524150518509405086125781764762145577981637953775680403132163846782252745029783387112660812179706752454175492501665442704630131729362621965258498471247871904163412798544329515689112368523703890083138721480476796720323855371775568097188216621368341228806795058046403892301673157631331636430392885315997250027372621883549649614866115616619234953579196607399899485002042456482969222428121605212017146571466818179341621066715472184636758016242256725063854155219754299817717414423725704356940589670902509021070871847017199593680033</span><br>e = <span class="hljs-number">97</span><br>c = <span class="hljs-number">79418540691422578656139651796213224829563266521211325595707569487401417030874358531413674275017334363641194166574500833916574827523075402219754470871728896772312056257743844227927800121160288525434484105786180547178403828613331285574461293211150728313415280329153597549251599876668080073528625299164784405291297754331374420687599875173508778209038236713812747215157059659564867241144529476211694011692007565732793105429228730285249025627762831080251661835294067942958070742202862164086250986988784472568266652325462247009294865764533077164470382743735937483173523682749295196383707694876943634298051820105410771024861599560176707940488888601355473498847493259474613261665538825299531665650233837474894442826242097663456648233384047622152817959729025415665280499618951478005159820575701483220155180955748454167435711033379910310483689839303198822665341421591234243891877857520663120183063591818656508336831518527692847950877186870610083654117153248336928856886934232488927132245720058243202637258025864487122393335118118013444397135476780564523166548571927547341556616683070253790368891423731046742936358877118104790084195711730135202600692806999992373490439385845158780392894927697171401722699273071306493916233696254958735540772870249139252741670476667099529502282392011715616110876451102234600267482991583515122052976378641894214562203326290939184469206074418127906704847146567350085797480500249400491003993809769407575997740985283755035509654310797061339563655229926356893455738361409861102662109994984398860070584568014471082484198504331014073023689622378943694856212172718725529473812336321642429261822836311084518735006587545920946664595488768239633950124822001162595168106106356115962424210028401369438479550293237915944302351566624339603616714683958384871326105542659559877758488581425288668613061792514360263277530824203967659102107889148367539858141289229124274098921748855341045565232484417195620758495861456624842263649414501657786484816662971421962216348340311859717286253287173293151613310383128702607971580042308515018120559903265609733911340589091613087560931098833849573462572181625894166772788435459280323623477689159384354671220634694792005231505741029567734616435905915192606539962414882105254409847885996949466940350184140166614950171110955365828033747003120697209120916652982201967537088553504504252785632280900095976870510754563400828951684036526240669112248351928072177486091157562600003336544767896806392523395037345770580482363058065676920013089896399387769312374871419827762872050800055872960573607645266626972865053489632548224840580503746879607167797904430560935476705014800973841917939689270919224595772574781478285359220463175042728750523639669204218676238297875644055563803457896409252533724486937378974745777400567080239687055154021761534918106133195512030935957251049812753269173090858930245212145938555697547499155977225759702066548720079477737104010668116693232798415289735481194922014811945312893853446826780868861295203942063380964100360870361328125</span><br><br><br>a, b = gmpy2.iroot(c, <span class="hljs-number">97</span>)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(a))<br><br></code></pre></td></tr></table></figure><p>ä¹Ÿèƒ½ç”¨ <strong>[RSA2]P2</strong> çš„æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ°kæ˜¯ç­‰äº0çš„ï¼Œä¹ŸéªŒè¯äº†$ m^{e}&#x3D; c$ ,ä¹Ÿå°±æ˜¯åœ¨å–æ¨¡çš„è¿‡ç¨‹ä¸­æ²¡æœ‰ä¸¢å¤±ä»»ä½•ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼€æ–¹ä»è€Œè·å¾—m</p><h2 id="RSA2-2-ä½åŠ å¯†æŒ‡æ•°æ”»å‡»"><a href="#RSA2-2-ä½åŠ å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="[RSA2]2(ä½åŠ å¯†æŒ‡æ•°æ”»å‡»)"></a>[RSA2]2(ä½åŠ å¯†æŒ‡æ•°æ”»å‡»)</h2><h3 id="main-1"><a href="#main-1" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>n = p*q<br>e = <span class="hljs-number">3</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>m = bytes_to_long(flag)<br><br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 111573371787314339229652810703380127177507745009618224416171957526984270337589283887959174610818933914845556276472159360153787395638087723501889651641965684241070152541291185349571453536221312112508437223801640552330390095266644485311958102687735113533739324296417077804219395793942670324182191309872918900717</span><br><span class="hljs-string">e = 3</span><br><span class="hljs-string">c = 90782646242308381145716338972639920044710403094882163620436540965475107006005657722222634294458956650085252212452241377251397323707019480880284004845674260662647720809672266571040936376737882878688872281858048646517100139303896804340224961592424635124272549514473232731744884837572128596217771005209683966262</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><ul><li><input checked="" disabled="" type="checkbox"> <strong>ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</strong></li></ul><p>yafuå’Œ<a href="http://factordb.com/">factordb.com</a>éƒ½æ²¡åˆ†è§£æˆåŠŸï¼Œ<strong>è¿™é‡Œçš„nä¹Ÿä¸å¤§ï¼Œæ€ä¹ˆå°±æ²¡æˆåŠŸå‘¢ğŸ™„</strong></p><p>é‚£åªèƒ½çœ‹çœ‹åŸç†äº†</p><p>ç›´æ¥ä½¿ç”¨ä¸Šé¢˜çš„æ–¹å¼å¼€æ–¹å¹¶ä¸è¡Œï¼Œåˆ™è¯´æ˜$ m^{e}&gt; c$ ï¼Œä¸èƒ½ç›´æ¥å¼€æ–¹ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘åŸç†ï¼š<br>$$<br>c \equiv m^{e} (mod\quad n)<br>$$<br>æ¶ˆå»å–æ¨¡ï¼Œæœ‰ï¼š<br>$$<br>m^{e} &#x3D; c + k\cdot n<br>$$<br>å› ä¸ºæœ¬é¢˜ä¸­åŠ å¯†æŒ‡æ•°eå¾ˆå°ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘$m^{e}$çš„å€¼å¹¶ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡éå†<code>k</code>çš„æ–¹å¼å°†å–æ¨¡åä¸¢å¤±çš„ä¿¡æ¯æ‰¾å›æ¥ï¼Œ</p><p>éå†åˆ°ä½•æ—¶åœæ­¢å‘¢ï¼Ÿå½“$c + k\cdot n$æ˜¯ä¸€ä¸ªå®Œå…¨eæ¬¡æ–¹æ•°æ—¶ï¼Œåˆ™è¯´æ˜æˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„ç­”æ¡ˆï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">111573371787314339229652810703380127177507745009618224416171957526984270337589283887959174610818933914845556276472159360153787395638087723501889651641965684241070152541291185349571453536221312112508437223801640552330390095266644485311958102687735113533739324296417077804219395793942670324182191309872918900717</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">90782646242308381145716338972639920044710403094882163620436540965475107006005657722222634294458956650085252212452241377251397323707019480880284004845674260662647720809672266571040936376737882878688872281858048646517100139303896804340224961592424635124272549514473232731744884837572128596217771005209683966262</span><br><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000</span>):<br>    cc = c + k*n<br>    res = iroot(cc, e)<br>    <span class="hljs-keyword">if</span> res[<span class="hljs-number">1</span>]:             <span class="hljs-comment">#å¦‚æœç¬¬äºŒä¸ªå‚æ•°è¿”å›çš„æ˜¯trueï¼Œåˆ™mç­‰äºç¬¬ä¸€ä¸ªå‚æ•°</span><br>        m = res[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;k:&#x27;</span>,k)                <span class="hljs-comment"># k=11</span><br></code></pre></td></tr></table></figure><h2 id="RSA2-3-Rabin"><a href="#RSA2-3-Rabin" class="headerlink" title="[RSA2]3(Rabin)"></a>[RSA2]3(Rabin)</h2><h3 id="main-2"><a href="#main-2" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">256</span>)<br>q = getPrime(<span class="hljs-number">256</span>)<br><br><span class="hljs-keyword">assert</span> p%<span class="hljs-number">4</span> == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> q%<span class="hljs-number">4</span> == <span class="hljs-number">3</span><br><br>n = p*q<br>e = <span class="hljs-number">2</span><br>m = bytes_to_long(flag)<br><br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 67711062621608175960173275013534737889372437946924512522469843485353704013203</span><br><span class="hljs-string">q = 91200252033239924238625443698357031288749612243099728355449192607988117291739</span><br><span class="hljs-string">e = 2</span><br><span class="hljs-string">c = 5251890478898826530186837207902117236305266861227697352434308106457554098811792713226801824100629792962861125855696719512180887415808454466978721678349614</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><ul><li><input disabled="" type="checkbox"> <strong>RSA è¡ç”Ÿç®—æ³•â€”â€”Rabinç®—æ³•</strong></li></ul><p><a href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_e_attack/#rsa-rabin">å…¬é’¥æŒ‡æ•°ç›¸å…³æ”»å‡» - CTF Wiki (ctf-wiki.org)</a></p><p>expå®Œå…¨copyçš„xennyä½¬çš„ï¼Œè¿˜ä¸æ‡‚åŸç†ğŸ˜”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">67711062621608175960173275013534737889372437946924512522469843485353704013203</span><br>q = <span class="hljs-number">91200252033239924238625443698357031288749612243099728355449192607988117291739</span><br>e = <span class="hljs-number">2</span><br>c = <span class="hljs-number">5251890478898826530186837207902117236305266861227697352434308106457554098811792713226801824100629792962861125855696719512180887415808454466978721678349614</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rabin_attack</span>(<span class="hljs-params">c, n, p, q</span>):<br>    c1 = powmod(c, (p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, p)<br>    c2 = powmod(c, (q+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, q)<br>    cp1 = p - c1<br>    cp2 = q - c2<br><br>    t1 = invert(p, q)<br>    t2 = invert(q, p)<br><br>    m1 = (q*c1*c2 + p*c2*t1) % n<br>    m2 = (q*c1*t2 + p*cp2*t1) % n<br>    m3 = (q*cp1*t2 + p*c2*t1) % n<br>    m4 = (q*cp1*t2 + p*cp2*t1) % n<br><br>    <span class="hljs-keyword">return</span> m1, m2, m3, m4<br><br>ms = rabin_attack(c, p*q, p, q)<br><br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> ms:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(m))    <span class="hljs-comment"># å››ä¸ªåªæœ‰ä¸€ä¸ªæ˜¯</span><br></code></pre></td></tr></table></figure><h2 id="RSA2-4-Wiener"><a href="#RSA2-4-Wiener" class="headerlink" title="[RSA2]4(Wiener)"></a>[RSA2]4(Wiener)</h2><h3 id="main-3"><a href="#main-3" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">256</span>)<br>q = getPrime(<span class="hljs-number">256</span>)<br><br>n = p*q<br>d = getPrime(<span class="hljs-number">128</span>)<br>e = inverse(d, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = bytes_to_long(flag)<br><br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 6969872410035233098344189258766624225446081814953480897731644163180991292913719910322241873463164232700368119465476508174863062276659958418657253738005689</span><br><span class="hljs-string">e = 3331016607237504021038095412236348385663413736904453330557803644384818257225138777641344877202234881627514102078530507171735156112302207979925588113589669</span><br><span class="hljs-string">c = 1754994938947260364311041300467524420957926989584983693004487724099773647229373820465164193428679197813476633649362998772470084452129370353136199193923837</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h3><ul><li><input disabled="" type="checkbox"> <strong>Wieneræ”»å‡»</strong></li></ul><p><strong>å·²çŸ¥ï¼ˆeï¼Œnï¼Œcï¼‰ï¼Œæ±‚mã€‚då¾ˆå°ä¸”eå¾ˆå¤§ï¼Œå¯çŸ¥æ˜¯ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼ˆWieneræ”»å‡»ï¼‰ã€‚</strong></p><p><strong>è¿™é‡Œç›¸å½“äºæ˜¯åè¿‡æ¥äº†ï¼Œå…ˆç”Ÿæˆäº†dï¼Œå†ç”±då»æ±‚e</strong>ï¼Œå½“æˆ‘ä»¬å‘ç°<strong>e å¾ˆå¤§æˆ–è€…è¯´å¾ˆæ¥è¿‘ n</strong>æ—¶ï¼Œä¾¿å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿åˆ†æ•°å±•å¼€çš„æ–¹å¼ï¼Œéå†æ¯ä¸€ä¸ªç³»æ•°ï¼Œæµ‹è¯•æ˜¯å¦æ˜¯è§£é¢˜ä¸­éœ€è¦ç”¨åˆ°çš„å…³é”®å› å­ï¼Œ</p><p><a href="https://blog.csdn.net/XiongSiqi_blog/article/details/130515028">RSAâ€“ç»´çº³æ”»å‡»â€“ä»£ç å’Œé¢˜ç›®åˆ†æ_ç»´çº³æ”»å‡»è„šæœ¬_Emmaaaaaaaaaaçš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç›´æ¥ç”¨xennyå¸ˆå‚…çš„åº“</span><br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> xenny.ctf.crypto.modern.asymmetric.rsa <span class="hljs-keyword">import</span> wiener<br><span class="hljs-comment"># eå¾ˆå¤§ wieneræ”»å‡»</span><br>n = <span class="hljs-number">6969872410035233098344189258766624225446081814953480897731644163180991292913719910322241873463164232700368119465476508174863062276659958418657253738005689</span><br>e = <span class="hljs-number">3331016607237504021038095412236348385663413736904453330557803644384818257225138777641344877202234881627514102078530507171735156112302207979925588113589669</span><br>c = <span class="hljs-number">1754994938947260364311041300467524420957926989584983693004487724099773647229373820465164193428679197813476633649362998772470084452129370353136199193923837</span><br> <br>d, p, q = wiener.attack(n, e)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br>flag = libnum.n2s(<span class="hljs-built_in">int</span>(m))<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># print(long_to_bytes(m))</span><br></code></pre></td></tr></table></figure><h3 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h3><ul><li><input disabled="" type="checkbox"> ç”¨åŸç†å†™çš„ï¼Œè¿˜æ²¡ç†è§£</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">6969872410035233098344189258766624225446081814953480897731644163180991292913719910322241873463164232700368119465476508174863062276659958418657253738005689</span><br>e = <span class="hljs-number">3331016607237504021038095412236348385663413736904453330557803644384818257225138777641344877202234881627514102078530507171735156112302207979925588113589669</span><br>c = <span class="hljs-number">1754994938947260364311041300467524420957926989584983693004487724099773647229373820465164193428679197813476633649362998772470084452129370353136199193923837</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, numerator, denumerator</span>):<br>        self.numberlist = []  <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = []  <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList(numerator, denumerator)<br>        self.GenerateFractionList()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span>(<span class="hljs-params">self, numerator, denumerator</span>):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append(quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span>(<span class="hljs-params">self</span>):<br>        self.fractionlist.append([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i):<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i - j - <span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br><br><br>a = ContinuedFraction(e, n)<br><span class="hljs-keyword">for</span> k, d <span class="hljs-keyword">in</span> a.fractionlist:<br>    m = powmod(c, d, n)<br>    flag = long_to_bytes(m)<br>    <br>    <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;NSSCTF&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="RSA2-5-ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#RSA2-5-ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="[RSA2]5(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)"></a>[RSA2]5(ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»)</h2><h3 id="main-4"><a href="#main-4" class="headerlink" title="main"></a>main</h3><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><h2 id="RSA2-6-p-1å…‰æ»‘"><a href="#RSA2-6-p-1å…‰æ»‘" class="headerlink" title="[RSA2]6(p-1å…‰æ»‘)"></a>[RSA2]6(p-1å…‰æ»‘)</h2><h3 id="main-5"><a href="#main-5" class="headerlink" title="main"></a>main</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMyPrime</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br>        <br>        <span class="hljs-keyword">if</span> isPrime(p+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> p+<span class="hljs-number">1</span><br><br>p = getMyPrime(<span class="hljs-number">256</span>)<br>q = getMyPrime(<span class="hljs-number">256</span>)<br><br>n = p*q<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 53763529836257082401813045869248978487210852880716446938539970599235060144454914000042178896730979463959004404421520555831136502171902051936080825853063287829</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 50368170865606429432907125510556310647510431461588875539696416879298699197677994843344925466156992948241894107250131926237473102312181031875514294014181272618</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
    
    
    <categories>
      
      <category>CTF-Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§ä»£æ•°å­¦ä¹ </title>
    <link href="/2023/09/23/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/09/23/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>bydè¿™ä¸ªç”¨markdownå†™ç€å¤ªéº»çƒ¦äº†ğŸ˜¡</p></blockquote><h2 id="Lec01-æ–¹ç¨‹ç»„çš„å‡ ä½•è§£é‡Š"><a href="#Lec01-æ–¹ç¨‹ç»„çš„å‡ ä½•è§£é‡Š" class="headerlink" title="Lec01_æ–¹ç¨‹ç»„çš„å‡ ä½•è§£é‡Š"></a>Lec01_æ–¹ç¨‹ç»„çš„å‡ ä½•è§£é‡Š</h2><p>çº¿æ€§ä»£æ•°çš„åŸºæœ¬é—®é¢˜å°±æ˜¯è§£nå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ã€‚</p><p>ä¾‹å¦‚ï¼šäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„<br>$$<br>\left{\begin{matrix}<br> 2x+y&#x3D;0   \<br> -x+2y&#x3D;3<br>\end{matrix}\right.<br>$$<br>å†™æˆçŸ©é˜µå½¢å¼å°±æ˜¯ï¼š<br>$$<br>\begin{bmatrix}<br> 2&amp;-1  \<br> -1&amp;2  \<br>\end{bmatrix}<br>\begin{bmatrix}<br>x \<br>y\end{bmatrix}</p><p>&#x3D;<br>\begin{bmatrix}<br>0 \ 3<br>\end{bmatrix}<br>$$<br>å…¶ä¸­$A &#x3D; \begin{bmatrix}<br> 2&amp;-1  \<br> -1&amp;2  \<br>\end{bmatrix}$è¢«ç§°ä¸ºç³»æ•°çŸ©é˜µ</p><p>æœªçŸ¥æ•°å‘é‡é€šå¸¸è®°ä¸º $ X &#x3D; \begin{bmatrix}<br> x \<br> y<br>\end{bmatrix}$</p><p>è€Œç­‰å·å³ä¾§çš„å‘é‡è®°ä¸º<strong>b</strong>ã€‚çº¿æ€§æ–¹ç¨‹ç»„ç®€è®°ä¸º <strong>Ax&#x3D;b</strong>ã€‚</p><h3 id="è¡Œå›¾åƒ"><a href="#è¡Œå›¾åƒ" class="headerlink" title="è¡Œå›¾åƒ"></a>è¡Œå›¾åƒ</h3><p>å°±æ˜¯æŒ‰è¡Œæ¥ç”»ï¼Œè·Ÿæˆ‘ä»¬ä¹‹å‰çš„æ€ç»´å¾ˆåƒ</p><p>è¡Œå›¾åƒéµä»è§£æå‡ ä½•çš„æè¿°ï¼Œæ¯ä¸ªæ–¹ç¨‹åœ¨å¹³é¢ä¸Šçš„å›¾åƒä¸ºä¸€æ¡ç›´çº¿ã€‚æ‰¾åˆ°ç¬¦åˆæ–¹ç¨‹çš„ä¸¤ä¸ªæ•°ç»„ï¼Œå°±å¯ä»¥ç¡®å®šå‡ºx-yå¹³é¢ä¸Šçš„ä¸¤ä¸ªç‚¹ï¼Œ</p><p>è¿æ¥ä¸¤ç‚¹å¯ä»¥ç”»å‡ºè¯¥æ–¹ç¨‹æ‰€ä»£è¡¨çš„ç›´çº¿ã€‚ä¸¤ç›´çº¿äº¤ç‚¹å³ä¸ºæ–¹ç¨‹ç»„çš„è§£x&#x3D;1,y&#x3D;2ã€‚</p><h3 id="åˆ—å›¾åƒ"><a href="#åˆ—å›¾åƒ" class="headerlink" title="åˆ—å›¾åƒ"></a>åˆ—å›¾åƒ</h3><p>åœ¨åˆ—å›¾åƒä¸­ï¼Œæˆ‘ä»¬å°†ç³»æ•°çŸ©é˜µå†™æˆåˆ—å‘é‡çš„å½¢å¼ï¼Œåˆ™æ±‚è§£åŸæ–¹ç¨‹å˜ä¸ºå¯»æ‰¾åˆ—å‘é‡çš„çº¿æ€§ç»„åˆæ¥æ„æˆå‘é‡<strong>b</strong>ã€‚</p><p>$x\begin{bmatrix}<br> 2 \<br> -1 \<br>\end{bmatrix}+y\begin{bmatrix}<br> -1  \<br> -2  \<br>\end{bmatrix}&#x3D;\begin{bmatrix}<br> 0 \<br> 3 \<br>\end{bmatrix}$</p><p>å‘é‡çº¿æ€§ç»„åˆæ˜¯è´¯ç©¿æœ¬è¯¾ç¨‹çš„é‡è¦æ¦‚å¿µã€‚å¯¹äºç»™å®šçš„å‘é‡<strong>c</strong>å’Œ<strong>d</strong>ä»¥åŠæ ‡é‡<em>x</em>å’Œ<em>y</em>ï¼Œæˆ‘ä»¬å°†x<strong>c</strong>+y<strong>d</strong>ç§°ä¹‹ä¸º<strong>c</strong>å’Œ<strong>d</strong>çš„ä¸€ä¸ªçº¿æ€§ç»„åˆã€‚</p><p>å‡ ä½•ä¸Šè®²ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230923165849317.png" alt="image-20230923165849317"></p>]]></content>
    
    
    
    <tags>
      
      <tag>çº¿æ€§ä»£æ•°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„å­¦ä¹ </title>
    <link href="/2023/09/19/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/09/19/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¬¬äºŒç« -çº¿æ€§è¡¨"><a href="#ç¬¬äºŒç« -çº¿æ€§è¡¨" class="headerlink" title="ç¬¬äºŒç«  çº¿æ€§è¡¨"></a>ç¬¬äºŒç«  çº¿æ€§è¡¨</h2><h3 id="2-5"><a href="#2-5" class="headerlink" title="2.5"></a>2.5</h3><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">L</span><span class="hljs-operator">=</span>(LinkList)malloc(sizeof(LNode))<span class="hljs-comment">; P=L;</span><br>for(i<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-comment">;i&lt;=4;i++)&#123;</span><br>    P-&gt;next<span class="hljs-operator">=</span>(LinkList)malloc(sizeof(LNode))<span class="hljs-comment">;</span><br>P<span class="hljs-operator">=</span>P-&gt;next<span class="hljs-comment">; </span><br>P-&gt;data<span class="hljs-operator">=</span>i*<span class="hljs-number">2</span>-<span class="hljs-number">1</span><span class="hljs-comment">;</span><br>&#125;<br>P-&gt;next<span class="hljs-operator">=</span>NULL<span class="hljs-comment">;</span><br>for(i<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-comment">;i&gt;=1;i--) Ins_LinkList(L,i+1,i*2);</span><br>for(i<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-comment">;i&lt;=3;i++) Del_LinkList(L,i);</span><br></code></pre></td></tr></table></figure><p><code>L=(LinkList)malloc(sizeof(LNode));</code></p><p>è¿™è¡Œä»£ç æ˜¯Cæˆ–C++ä¸­ç”¨äºåŠ¨æ€åˆ†é…å†…å­˜å¹¶åˆ›å»ºä¸€ä¸ªé“¾è¡¨ï¼ˆæˆ–é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼‰çš„ä»£ç ã€‚</p><p>è¿™è¡Œä»£ç ä½œç”¨çš„è¯¦ç»†è§£é‡Šï¼š</p><ol><li><code>malloc</code> å‡½æ•°ï¼š<code>malloc</code> æ˜¯Cå’ŒC++ä¸­ç”¨äºåŠ¨æ€åˆ†é…å†…å­˜çš„å‡½æ•°ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨å †ï¼ˆheapï¼‰ä¸­åˆ†é…ä¸€å—æŒ‡å®šå¤§å°çš„å†…å­˜ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å†…å­˜å—çš„æŒ‡é’ˆã€‚åœ¨è¿™é‡Œï¼Œ<code>malloc(sizeof(LNode))</code> åˆ†é…äº†ä¸€å—å¤§å°ä¸º <code>sizeof(LNode)</code> å­—èŠ‚çš„å†…å­˜ã€‚</li><li><code>sizeof(LNode)</code>ï¼š<code>sizeof</code> æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œç”¨äºè·å–æ•°æ®ç±»å‹æˆ–ç»“æ„ä½“çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚<code>LNode</code> æ˜¯é“¾è¡¨èŠ‚ç‚¹çš„æ•°æ®ç»“æ„ï¼ˆæˆ–ç±»å‹ï¼‰ï¼Œå› æ­¤ <code>sizeof(LNode)</code> è¿”å› <code>LNode</code> ç»“æ„ä½“çš„å¤§å°ã€‚</li><li><code>(LinkList)</code> å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šåœ¨Cå’ŒC++ä¸­ï¼Œ<code>malloc</code> è¿”å›ä¸€ä¸ª <code>void</code> æŒ‡é’ˆï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºæ‰€éœ€çš„æ•°æ®ç±»å‹ï¼Œè¿™é‡Œæ˜¯ <code>LinkList</code> ç±»å‹ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†è®©æŒ‡é’ˆæŒ‡å‘æ­£ç¡®çš„æ•°æ®ç±»å‹ï¼Œä»¥ä¾¿åç»­æ“ä½œã€‚</li><li><code>L</code>ï¼šè¿™æ˜¯é“¾è¡¨çš„å¤´æŒ‡é’ˆï¼Œå®ƒè¢«åˆ†é…äº†ä¸€å—å†…å­˜ï¼Œå¹¶æŒ‡å‘äº†é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</li></ol><p>æ€»ç»“èµ·æ¥ï¼Œè¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªé“¾è¡¨ï¼Œå¹¶å°†é“¾è¡¨çš„å¤´æŒ‡é’ˆ <code>L</code> æŒ‡å‘ä¸€ä¸ªæ–°åˆ†é…çš„å†…å­˜å—ï¼Œè¯¥å†…å­˜å—å¤§å°ä¸º <code>sizeof(LNode)</code> å­—èŠ‚ï¼Œç”¨æ¥å­˜å‚¨é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</p><p>è¿™æ˜¯åˆ›å»ºé“¾è¡¨çš„èµ·å§‹æ­¥éª¤ï¼Œé€šå¸¸ä¼šè·Ÿéšå…¶ä»–æ“ä½œæ¥æ„å»ºé“¾è¡¨çš„èŠ‚ç‚¹å’Œè¿æ¥ã€‚åœ¨ä½¿ç”¨å®Œé“¾è¡¨åï¼Œéœ€è¦è®°å¾—ä½¿ç”¨ <code>free</code> å‡½æ•°æ¥é‡Šæ”¾åˆ†é…çš„å†…å­˜ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚ä¾‹å¦‚ï¼š<code>free(L)</code>ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">for(i<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-comment">;i&lt;=4;i++)&#123;</span><br>    P-&gt;next<span class="hljs-operator">=</span>(LinkList)malloc(sizeof(LNode))<span class="hljs-comment">;</span><br>P<span class="hljs-operator">=</span>P-&gt;next<span class="hljs-comment">; </span><br>P-&gt;data<span class="hljs-operator">=</span>i*<span class="hljs-number">2</span>-<span class="hljs-number">1</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œå®ƒç”¨äºåœ¨é“¾è¡¨ä¸­åˆ›å»ºå››ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹èµ‹å€¼ã€‚è§£é‡Šå¦‚ä¸‹ï¼š</p><ol><li><code>for(i=1;i&lt;=4;i++)</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œå®ƒä¼šæ‰§è¡Œå››æ¬¡ï¼Œ<code>i</code> ä»1å¼€å§‹ï¼Œæ¯æ¬¡é€’å¢1ï¼Œç›´åˆ° <code>i</code> çš„å€¼ä¸º4ã€‚</li><li><code>P-&gt;next=(LinkList)malloc(sizeof(LNode));</code>ï¼šè¿™è¡Œä»£ç åˆ†é…äº†ä¸€ä¸ªæ–°çš„å†…å­˜å—ï¼Œç”¨äºå­˜å‚¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å°†å½“å‰èŠ‚ç‚¹çš„ <code>next</code> æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªæ–°èŠ‚ç‚¹ã€‚è¿™æ„å‘³ç€åˆ›å»ºäº†ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶é“¾æ¥åˆ°é“¾è¡¨ä¸­ã€‚</li><li><code>P=P-&gt;next;</code>ï¼šå°†æŒ‡é’ˆ <code>P</code> ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ç°åœ¨ <code>P</code> æŒ‡å‘äº†æ–°åˆ›å»ºçš„èŠ‚ç‚¹ï¼Œä»¥ä¾¿ä¸ºå®ƒèµ‹å€¼ã€‚</li><li><code>P-&gt;data=i*2-1;</code>ï¼šä¸ºå½“å‰èŠ‚ç‚¹çš„ <code>data</code> æˆå‘˜èµ‹å€¼ã€‚è¿™é‡Œåº”è¯¥æ˜¯ <code>P-&gt;data = i*2 - 1;</code>ï¼Œå°†å½“å‰èŠ‚ç‚¹çš„æ•°æ®è®¾ä¸º <code>i</code> ä¹˜ä»¥ 2 å‡å» 1 çš„ç»“æœã€‚</li></ol><p>æ‰€ä»¥ï¼Œè¿™ä¸ªå¾ªç¯ä¼šåˆ›å»ºå››ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨æ¯ä¸ªèŠ‚ç‚¹çš„ <code>data</code> æˆå‘˜ä¸­å­˜å‚¨ä¸€ä¸ªå¥‡æ•°å€¼ï¼ˆ1ã€3ã€5ã€7ï¼‰ã€‚</p><p>ç„¶åæœ€åä¸¤è¡Œè¯­å¥â€”â€“</p><ul><li><code>Ins_LinkList(L,i+1,i*2);</code>ï¼šè°ƒç”¨äº†ä¸€ä¸ªåä¸º <code>Ins_LinkList</code> çš„å‡½æ•°ï¼Œå°†å…ƒç´  <code>i*2</code> æ’å…¥åˆ°é“¾è¡¨çš„ç¬¬ <code>i+1</code> ä¸ªä½ç½®ã€‚</li><li><code>Del_LinkList(L,i);</code>ï¼šè°ƒç”¨äº†ä¸€ä¸ªåä¸º <code>Del_LinkList</code> çš„å‡½æ•°ï¼Œåˆ é™¤é“¾è¡¨ä¸­çš„ç¬¬ <code>i</code> ä¸ªå…ƒç´ (<strong>è¿™é‡Œæ˜¯ä¸ç®—å¤´èŠ‚ç‚¹çš„,å› ä¸ºå¤´èŠ‚ç‚¹æ²¡æœ‰è¢«èµ‹äºˆå…ƒç´ ?????</strong>)ã€‚</li></ul><h3 id="2-6"><a href="#2-6" class="headerlink" title="2.6"></a>2.6</h3><ul><li><input checked="" disabled="" type="checkbox"> <code>while(P-&gt;next!=NULL) P=P-&gt;next;</code></li></ul><p>è¿™è¡Œä»£ç æ˜¯ä¸€ä¸ª <code>while</code> å¾ªç¯ï¼Œå…¶ç›®çš„æ˜¯åœ¨é“¾è¡¨ä¸­ç§»åŠ¨æŒ‡é’ˆ <code>P</code> ç›´åˆ° <code>P</code> çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸º <code>NULL</code>ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨çš„æœ«å°¾èŠ‚ç‚¹ã€‚</p><p>è§£é‡Šå¦‚ä¸‹ï¼š</p><ol><li><code>P-&gt;next != NULL</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œå®ƒæ£€æŸ¥å½“å‰èŠ‚ç‚¹ <code>P</code> çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸ç­‰äº <code>NULL</code>ã€‚æ¡ä»¶è¡¨è¾¾å¼çš„ç»“æœæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸æ˜¯ <code>NULL</code>ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸï¼Œç»§ç»­æ‰§è¡Œå¾ªç¯ä½“ã€‚</li><li><strong><code>P = P-&gt;next;</code>ï¼šå¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œå°±æ‰§è¡Œè¿™è¡Œä»£ç ã€‚è¿™è¡Œä»£ç å°†æŒ‡é’ˆ <code>P</code> ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå³å°† <code>P</code> æ›´æ–°ä¸ºå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»¥ä¾¿ç»§ç»­æ£€æŸ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸ºé“¾è¡¨çš„æœ«å°¾ã€‚(ç»ˆäºç†è§£ğŸ˜­)</strong></li></ol><p>å¾ªç¯å°†ä¸€ç›´æ‰§è¡Œï¼Œç›´åˆ° <code>P</code> çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸º <code>NULL</code>ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨çš„æœ«å°¾èŠ‚ç‚¹ã€‚ä¸€æ—¦é“¾è¡¨æœ«å°¾è¢«æ‰¾åˆ°ï¼Œæ¡ä»¶è¡¨è¾¾å¼ä¸ºå‡ï¼Œå¾ªç¯ç»ˆæ­¢ã€‚è¿™æ®µä»£ç é€šå¸¸ç”¨äºéå†æ•´ä¸ªé“¾è¡¨ï¼Œç›´åˆ°åˆ°è¾¾é“¾è¡¨çš„æœ«å°¾èŠ‚ç‚¹ã€‚</p><p>æ€»ä¹‹ï¼Œè¿™æ®µä»£ç çš„ç›®çš„æ˜¯åœ¨é“¾è¡¨ä¸­ç§»åŠ¨æŒ‡é’ˆ <code>P</code> ç›´åˆ°è¾¾åˆ°é“¾è¡¨çš„æœ«å°¾èŠ‚ç‚¹ã€‚</p><p>å·²çŸ¥ L æ˜¯å¸¦è¡¨å¤´ç»“ç‚¹çš„éç©ºå•é“¾è¡¨ï¼Œå’Œå·²çŸ¥ L æ˜¯æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«</p><h3 id="2-7"><a href="#2-7" class="headerlink" title="2.7"></a>2.7</h3><p><strong>å¸¦è¡¨å¤´ç»“ç‚¹</strong>å’Œ<strong>æ— è¡¨å¤´ç»“ç‚¹</strong>çš„å•é“¾è¡¨åœ¨æ•°æ®ç»“æ„ä¸­æœ‰ä¸€äº›é‡è¦åŒºåˆ«ï¼š</p><ol><li><strong>å­˜åœ¨ä¸å¦ï¼š</strong><ul><li><strong>å¸¦è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> è¿™ç§é“¾è¡¨åœ¨å¤´éƒ¨æœ‰ä¸€ä¸ªé¢å¤–çš„ç»“ç‚¹ï¼Œé€šå¸¸ç§°ä¸ºè¡¨å¤´ç»“ç‚¹æˆ–è€…å“¨å…µç»“ç‚¹ã€‚è¿™ä¸ªç»“ç‚¹ä¸å­˜å‚¨å®é™…çš„æ•°æ®ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä½¿é“¾è¡¨æ“ä½œæ›´å®¹æ˜“å®ç°ï¼Œå› ä¸ºå®ƒå¯ä»¥é¿å…å¯¹ç©ºé“¾è¡¨çš„ç‰¹æ®Šå¤„ç†ã€‚å¸¦è¡¨å¤´ç»“ç‚¹çš„é“¾è¡¨é€šå¸¸åœ¨æ“ä½œä¸Šæ›´åŠ ç»Ÿä¸€ï¼Œå› ä¸ºå¤´ç»“ç‚¹å§‹ç»ˆå­˜åœ¨ï¼Œå³ä½¿é“¾è¡¨ä¸ºç©ºã€‚</li><li><strong>æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> è¿™ç§é“¾è¡¨ä¸åŒ…å«è¡¨å¤´ç»“ç‚¹ï¼Œç›´æ¥ä»ç¬¬ä¸€ä¸ªå­˜å‚¨æ•°æ®çš„ç»“ç‚¹å¼€å§‹ã€‚è¿™æ„å‘³ç€å¦‚æœé“¾è¡¨ä¸ºç©ºï¼Œé‚£ä¹ˆé“¾è¡¨å¤´éƒ¨å°±æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ã€‚</li></ul></li><li><strong>ç´¢å¼•&#x2F;éå†èµ·å§‹ç‚¹ï¼š</strong><ul><li><strong>å¸¦è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> ç”±äºå¤´ç»“ç‚¹çš„å­˜åœ¨ï¼Œé“¾è¡¨çš„ç¬¬ä¸€ä¸ªæ•°æ®ç»“ç‚¹ä»å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹å¼€å§‹ï¼Œç´¢å¼•ä¸º1ã€‚</li><li><strong>æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> åœ¨æ²¡æœ‰å¤´ç»“ç‚¹çš„æƒ…å†µä¸‹ï¼Œé“¾è¡¨çš„ç¬¬ä¸€ä¸ªæ•°æ®ç»“ç‚¹é€šå¸¸æ˜¯é“¾è¡¨çš„å¤´éƒ¨ï¼Œç´¢å¼•ä¸º0ã€‚</li></ul></li><li><strong>ç©ºé“¾è¡¨å¤„ç†ï¼š</strong><ul><li><strong>å¸¦è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> å³ä½¿é“¾è¡¨ä¸ºç©ºï¼Œå¤´ç»“ç‚¹å§‹ç»ˆå­˜åœ¨ï¼Œå› æ­¤å¯¹äºç©ºé“¾è¡¨çš„å¤„ç†ä¸éç©ºé“¾è¡¨ä¸€æ ·ï¼Œä¸éœ€è¦é¢å¤–çš„ç‰¹æ®Šæƒ…å†µå¤„ç†ã€‚</li><li><strong>æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> å¦‚æœé“¾è¡¨ä¸ºç©ºï¼Œå¤´éƒ¨å°±æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œå¦åˆ™åœ¨è®¿é—®é“¾è¡¨æ—¶å¯èƒ½ä¼šå¼•å‘é”™è¯¯ã€‚</li></ul></li><li><strong>æ“ä½œå®ç°çš„å¤æ‚æ€§ï¼š</strong><ul><li><strong>å¸¦è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> ç”±äºå¤´ç»“ç‚¹çš„å­˜åœ¨ï¼Œé€šå¸¸å¯ä»¥æ›´å®¹æ˜“åœ°å®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œå› ä¸ºä¸éœ€è¦ç‰¹æ®Šæƒ…å†µå¤„ç†å¤´éƒ¨èŠ‚ç‚¹ã€‚</li><li><strong>æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼š</strong> æ“ä½œå®ç°å¯èƒ½ç¨å¾®å¤æ‚ä¸€äº›ï¼Œå› ä¸ºéœ€è¦å¤„ç†å¤´éƒ¨èŠ‚ç‚¹çš„ç‰¹æ®Šæƒ…å†µã€‚</li></ul></li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€‰æ‹©ä½¿ç”¨å¸¦è¡¨å¤´ç»“ç‚¹è¿˜æ˜¯æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨å–å†³äºå…·ä½“çš„éœ€æ±‚å’Œè®¾è®¡ã€‚å¸¦è¡¨å¤´ç»“ç‚¹çš„é“¾è¡¨é€šå¸¸åœ¨å®ç°ä¸Šæ›´åŠ ç»Ÿä¸€å’Œæ–¹ä¾¿ï¼Œè€Œæ— è¡¨å¤´ç»“ç‚¹çš„é“¾è¡¨å¯èƒ½æ›´èŠ‚çœä¸€äº›å†…å­˜ç©ºé—´ã€‚</p><p><strong>é¦–å…ƒç»“ç‚¹&amp;å°¾å…ƒç»“ç‚¹</strong></p><p>åˆ¤æ–­: åœ¨å¸¦å¤´ç»“ç‚¹çš„å¾ªç¯å•é“¾è¡¨ä¸­ï¼Œå°¾å…ƒç»“ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘é“¾è¡¨çš„é¦–å…ƒç»“ç‚¹ã€‚</p><blockquote><p>false </p><p>å°¾å…ƒç»“ç‚¹çš„nextå€¼æŒ‡å‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯é¦–å…ƒç»“ç‚¹ã€‚</p><p>é¦–å…ƒç»“ç‚¹æŒ‡çš„æ˜¯é“¾è¡¨ä¸­å­˜å‚¨ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´ çš„ç»“ç‚¹ã€‚å¤´èŠ‚ç‚¹æ˜¯åœ¨é¦–å…ƒç»“ç‚¹ä¹‹å‰è®¾ç½®çš„ä¸€ä¸ªç»“ç‚¹ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230919200445761.png" alt="image-20230919200445761"></p><p>è¿™é‡Œçš„Dæ˜¯å°¾å…ƒç»“ç‚¹</p><p><strong>ã€å¤´ç»“ç‚¹ã€‘ã€å¤´æŒ‡é’ˆã€‘ã€é¦–å…ƒç»“ç‚¹ã€‘</strong></p><p>å¤´ç»“ç‚¹ï¼ˆä¸ä¸€å®šæœ‰ï¼‰ï¼Œå­˜åœ¨ä¸ºäº†æ–¹ä¾¿æ“ä½œï¼Œå¤´ç»“ç‚¹æ˜¯ä¸ºäº†æ“ä½œçš„ç»Ÿä¸€å’Œæ–¹ä¾¿è€Œè®¾ç«‹çš„ï¼Œæ”¾åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç»“ç‚¹ä¹‹å‰ï¼Œå…¶æ•°æ®åŸŸä¸€èˆ¬æ— æ„ä¹‰ï¼ˆä½†ä¹Ÿå¯ä»¥ç”¨æ¥å­˜æ”¾é“¾è¡¨çš„é•¿åº¦ï¼‰ï¼Œå¯¹åœ¨ç¬¬ä¸€å…ƒç´ ç»“ç‚¹å‰æ’å…¥ç»“ç‚¹å’Œåˆ é™¤ç¬¬ä¸€ç»“ç‚¹èµ·æ“ä½œä¸å…¶å®ƒç»“ç‚¹çš„æ“ä½œå°±ç»Ÿä¸€äº†ã€‚</p><p>é¦–å…ƒç»“ç‚¹ï¼šå®é™…è®°å½•æ•°æ®çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼›</p><p>å¤´æŒ‡é’ˆï¼šæŒ‡å‘ç¬¬ä¸€ä¸ªç‰©ç†èŠ‚ç‚¹åœ°å€çš„æŒ‡é’ˆï¼Œå°±æ˜¯å®šä¹‰çš„é“¾è¡¨åï¼Œè¿™ä¸ªå¤´æŒ‡é’ˆçš„æ„ä¹‰åœ¨äºï¼Œåœ¨è®¿é—®é“¾è¡¨æ—¶ï¼Œæ€»è¦çŸ¥é“é“¾è¡¨å­˜å‚¨åœ¨ä»€ä¹ˆä½ç½®ï¼ˆä»ä½•å¤„å¼€å§‹è®¿é—®ï¼‰ï¼Œç”±äºé“¾è¡¨çš„ç‰¹æ€§ï¼ˆnextæŒ‡é’ˆï¼‰ï¼ŒçŸ¥é“äº†å¤´æŒ‡é’ˆï¼Œé‚£ä¹ˆæ•´ä¸ªé“¾è¡¨çš„å…ƒç´ éƒ½èƒ½å¤Ÿè¢«è®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´å¤´æŒ‡é’ˆæ˜¯å¿…é¡»å­˜åœ¨çš„ã€‚</p><h3 id="2-9"><a href="#2-9" class="headerlink" title="2.9"></a>2.9</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> åˆ†æä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç <br>Status A(LinkedList L) &#123; <span class="hljs-regexp">//</span>L æ˜¯æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨<br><span class="hljs-keyword">if</span>(L &amp;&amp; L-&gt;<span class="hljs-keyword">next</span>) &#123;<br>    Q=L; L=L-&gt;<span class="hljs-keyword">next</span>; P=L;<br>    <span class="hljs-keyword">while</span>(P-&gt;<span class="hljs-keyword">next</span>) P=P-&gt;<span class="hljs-keyword">next</span>;<br>    P-&gt;<span class="hljs-keyword">next</span>=Q; Q-&gt;<span class="hljs-keyword">next</span>=NULL;<br>&#125;<br>return OK;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå‡½æ•° <code>Status A(LinkedList L)</code>ï¼Œå…¶ç›®çš„æ˜¯å°†æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ <code>L</code> ä¸­çš„é¦–å…ƒç´ ç§»åˆ°é“¾è¡¨çš„æœ«å°¾ã€‚ä»¥ä¸‹æ˜¯ä»£ç çš„é€è¡Œè§£é‡Šï¼š</p><ol><li><code>if (L &amp;&amp; L-&gt;next)</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ¡ä»¶è¯­å¥ï¼Œç¡®ä¿é“¾è¡¨ <code>L</code> ä¸ä¸ºç©ºä¸”è‡³å°‘åŒ…å«ä¸¤ä¸ªå…ƒç´ ã€‚å¦‚æœé“¾è¡¨ä¸ºç©ºæˆ–åªåŒ…å«ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæ²¡æœ‰å¿…è¦æ‰§è¡Œé¦–å…ƒç´ ç§»åˆ°æœ«å°¾çš„æ“ä½œã€‚</li><li><code>Q = L;</code>ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆ <code>Q</code>ï¼Œç”¨äºæš‚æ—¶ä¿å­˜é“¾è¡¨çš„é¦–å…ƒç´ ã€‚</li><li><code>L = L-&gt;next;</code>ï¼šå°†é“¾è¡¨å¤´æŒ‡é’ˆ <code>L</code> ç§»åŠ¨åˆ°é“¾è¡¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå³è·³è¿‡äº†åŸå§‹çš„é¦–å…ƒç´ ã€‚</li><li><code>P = L;</code>ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æ–°æŒ‡é’ˆ <code>P</code>ï¼Œç”¨äºéå†é“¾è¡¨å¹¶æ‰¾åˆ°æœ«å°¾å…ƒç´ ã€‚</li><li><code>while (P-&gt;next) P=P-&gt;next</code>ï¼šè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œè¯¥å¾ªç¯å°† <code>P</code> ç§»åŠ¨åˆ°é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå³å½“ <code>P</code> çš„ä¸‹ä¸€ä¸ªå…ƒç´ ä¸ä¸ºç©ºæ—¶ç»§ç»­æ‰§è¡Œã€‚</li><li><code>P-&gt;next = Q;</code>ï¼šå°†æœ«å°¾å…ƒç´ çš„ <code>next</code> æŒ‡é’ˆæŒ‡å‘åŸå§‹é¦–å…ƒç´  <code>Q</code>ï¼Œè¿™æ ·å°±å°†é¦–å…ƒç´ ç§»åˆ°äº†é“¾è¡¨çš„æœ«å°¾ã€‚</li><li><code>Q-&gt;next = NULL;</code>ï¼šå°†åŸå§‹é¦–å…ƒç´  <code>Q</code> çš„ <code>next</code> æŒ‡é’ˆè®¾ç½®ä¸º <code>NULL</code>ï¼Œä»¥ç¡®ä¿å®ƒæˆä¸ºæ–°é“¾è¡¨çš„æœ«å°¾å…ƒç´ ã€‚</li><li><code>return OK;</code>ï¼šå‡½æ•°è¿”å› OKï¼Œè¡¨ç¤ºæ“ä½œæˆåŠŸå®Œæˆã€‚</li></ol><p>æ€»ä¹‹ï¼Œè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å°†æ— è¡¨å¤´ç»“ç‚¹çš„å•é“¾è¡¨ <code>L</code> ä¸­çš„é¦–å…ƒç´ ç§»åˆ°é“¾è¡¨çš„æœ«å°¾ã€‚å¦‚æœé“¾è¡¨ä¸ºç©ºæˆ–åªåŒ…å«ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚å¦åˆ™ï¼Œå®ƒå°†é€šè¿‡é‡æ–°è¿æ¥æŒ‡é’ˆæ¥å®ç°é¦–å…ƒç´ çš„ç§»åŠ¨ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">//åˆ†æä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç </span><br>void <span class="hljs-constructor">BB(LNode <span class="hljs-operator">*</span><span class="hljs-params">s</span>, LNode <span class="hljs-operator">*</span><span class="hljs-params">q</span>)</span> &#123;<br>    <span class="hljs-comment">// å£°æ˜æŒ‡é’ˆ pï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸º s</span><br>    p = s;<br>    <span class="hljs-comment">// å½“ p æŒ‡å‘çš„ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹ä¸ç­‰äº q æ—¶ï¼Œæ‰§è¡Œå¾ªç¯</span><br>    <span class="hljs-keyword">while</span> (p-&gt;next != q) &#123;<br>        <span class="hljs-comment">// å°† p ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç»“ç‚¹</span><br>        p = p-&gt;next;<br>    &#125;<br>    <span class="hljs-comment">// å°† q ç»“ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘ sï¼Œå½¢æˆé—­ç¯</span><br>    p-&gt;next = s;<br>&#125;<br>void <span class="hljs-constructor">AA(LNode <span class="hljs-operator">*</span><span class="hljs-params">pa</span>, LNode <span class="hljs-operator">*</span><span class="hljs-params">pb</span>)</span> &#123;<br>    <span class="hljs-comment">// è°ƒç”¨ BB å‡½æ•°ï¼Œå°†ç»“ç‚¹ pa åˆ° pb ä¹‹é—´çš„ç»“ç‚¹é—­ç¯</span><br>    <span class="hljs-constructor">BB(<span class="hljs-params">pa</span>, <span class="hljs-params">pb</span>)</span>;<br>    <span class="hljs-comment">// å†æ¬¡è°ƒç”¨ BB å‡½æ•°ï¼Œå°†ç»“ç‚¹ pb åˆ° pa ä¹‹é—´çš„ç»“ç‚¹é—­ç¯</span><br>    <span class="hljs-constructor">BB(<span class="hljs-params">pb</span>, <span class="hljs-params">pa</span>)</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="2-11"><a href="#2-11" class="headerlink" title="2.11"></a>2.11</h3><ul><li><input disabled="" type="checkbox"> 2.11 è®¾é¡ºåºè¡¨ va ä¸­çš„æ•°æ®å…ƒç´ é€’å¢æœ‰åºã€‚è¯•å†™ä¸€ç®—æ³•ï¼Œå°† x æ’å…¥åˆ°é¡ºåºè¡¨çš„é€‚å½“ä½ç½®ä¸Šï¼Œä»¥ä¿æŒè¯¥è¡¨çš„æœ‰åºæ€§ã€‚</li></ul><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs maxima">Status InsertOrderList(SqList &amp;va,ElemType x)<br>&#123;<br>//åœ¨éé€’å‡çš„é¡ºåºè¡¨ va ä¸­æ’å…¥å…ƒç´  x å¹¶ä½¿å…¶ä»æˆä¸ºé¡ºåºè¡¨çš„ç®—æ³•<br>int i;<br><span class="hljs-keyword">if</span>(va.<span class="hljs-built_in">length</span>==va.listsize)<span class="hljs-built_in">return</span>(OVERFLOW);<br><br><span class="hljs-keyword">for</span>(i=va.<span class="hljs-built_in">length</span>;i&gt;<span class="hljs-number">0</span>,x&lt;va.<span class="hljs-built_in">elem</span>[i-<span class="hljs-number">1</span>];i--)<br>va.<span class="hljs-built_in">elem</span>[i]=va.<span class="hljs-built_in">elem</span>[i-<span class="hljs-number">1</span>];<br><br>va.<span class="hljs-built_in">elem</span>[i]=x;<br>va.<span class="hljs-built_in">length</span>++;<br><span class="hljs-built_in">return</span> OK;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><code>Status InsertOrderList(SqList &amp;va,ElemType x)</code></p><p>è¿™è¡Œä»£ç æ˜¯ä¸€ä¸ªå‡½æ•°çš„å£°æ˜ï¼Œå…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li><code>Status</code>ï¼šè¿™æ˜¯å‡½æ•°çš„è¿”å›ç±»å‹ã€‚åœ¨C&#x2F;C++ä¸­ï¼Œå‡½æ•°é€šå¸¸ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œè¡¨ç¤ºå‡½æ•°çš„æ‰§è¡Œç»“æœæˆ–çŠ¶æ€ã€‚åœ¨è¿™é‡Œï¼Œå‡½æ•°è¿”å›ç±»å‹æ˜¯ <code>Status</code>ï¼Œè¿™æ„å‘³ç€è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªè¡¨ç¤ºæ“ä½œçŠ¶æ€çš„å€¼ã€‚</li><li><code>InsertOrderList</code>ï¼šè¿™æ˜¯å‡½æ•°çš„åç§°ã€‚å‡½æ•°åç”¨äºæ ‡è¯†å’Œè°ƒç”¨å‡½æ•°ã€‚åœ¨è¿™ä¸ªæƒ…å¢ƒä¸‹ï¼Œå‡½æ•°åæ˜¯ <code>InsertOrderList</code>ï¼Œå®ƒè¡¨ç¤ºè¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ’å…¥åˆ°ä¸€ä¸ªé¡ºåºè¡¨ä¸­ã€‚</li><li><code>(SqList &amp;va, ElemType x)</code>ï¼šè¿™æ˜¯å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚å®ƒæŒ‡å®šäº†å‡½æ•°æ¥å—çš„è¾“å…¥å‚æ•°ã€‚å…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š<ul><li><code>SqList &amp;va</code>ï¼šè¿™æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼•ç”¨ï¼ˆ<code>&amp;</code> ç¬¦å·è¡¨ç¤ºå¼•ç”¨ï¼‰ã€‚è¿™æ„å‘³ç€å‡½æ•°å°†æ¥å—ä¸€ä¸ªåä¸º <code>va</code> çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª <code>SqList</code> ç±»å‹çš„é¡ºåºè¡¨ã€‚é€šè¿‡å¼•ç”¨ä¼ é€’ï¼Œå‡½æ•°å¯ä»¥ç›´æ¥ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„é¡ºåºè¡¨ï¼Œè€Œä¸éœ€è¦å¤åˆ¶æ•´ä¸ªæ•°æ®ç»“æ„ï¼Œè¿™å¯ä»¥æé«˜æ€§èƒ½å¹¶èŠ‚çœå†…å­˜ã€‚</li><li><code>ElemType x</code>ï¼šè¿™æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªåä¸º <code>x</code> çš„å‚æ•°ï¼Œè¡¨ç¤ºè¦æ’å…¥åˆ°é¡ºåºè¡¨ä¸­çš„å…ƒç´ ã€‚<code>ElemType</code> å¯èƒ½æ˜¯ä¸€ä¸ªåœ¨ä»£ç çš„å…¶ä»–åœ°æ–¹å®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå…ƒç´ çš„ç±»å‹ã€‚</li></ul></li></ul><p>ç»¼ä¸Šï¼Œè¿™è¡Œä»£ç çš„å«ä¹‰æ˜¯å£°æ˜ä¸€ä¸ªåä¸º <code>InsertOrderList</code> çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªé¡ºåºè¡¨ <code>va</code> å’Œä¸€ä¸ªå…ƒç´  <code>x</code> ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ª <code>Status</code> ç±»å‹çš„å€¼ï¼Œç”¨äºè¡¨ç¤ºå‡½æ•°æ‰§è¡Œçš„çŠ¶æ€æˆ–ç»“æœã€‚</p><p><code>for (i = va.length; i &gt; 0 &amp;&amp; x &lt; va.elem[i - 1]; i--)    va.elem[i] = va.elem[i - 1];</code></p><ul><li><p>è¿™æ˜¯ä¸€ä¸ª <code>for</code> å¾ªç¯ï¼Œä»é¡ºåºè¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ å¼€å§‹å‘å‰éå†ï¼ŒåŒæ—¶æ£€æŸ¥å…ƒç´  <code>x</code> æ˜¯å¦å°äºå½“å‰ä½ç½®çš„å…ƒç´ ã€‚å¾ªç¯æ¡ä»¶åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š<code>i &gt; 0</code> è¡¨ç¤ºå¾ªç¯è¦ç»§ç»­ç›´åˆ°éå†åˆ°é¡ºåºè¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›<code>x &lt; va.elem[i - 1]</code> è¡¨ç¤ºåªè¦å…ƒç´  <code>x</code> å°äºå½“å‰ä½ç½®çš„å…ƒç´ ï¼Œå°±ç»§ç»­å¾ªç¯ã€‚è¿™ä¸ªå¾ªç¯çš„ç›®çš„æ˜¯æ‰¾åˆ°æ’å…¥ä½ç½®ã€‚</p></li><li><p>åœ¨å¾ªç¯ä¸­ï¼Œå°†å½“å‰ä½ç½®çš„å…ƒç´ å‘åç§»åŠ¨ï¼Œä»¥ä¸ºæ–°å…ƒç´  <code>x</code> è…¾å‡ºä½ç½®ã€‚è¿™æ˜¯ä¸ºäº†ä¸ºæ–°å…ƒç´  <code>x</code> è®©è·¯ï¼Œä¸ºå…¶æ‰¾åˆ°é€‚å½“çš„æ’å…¥ä½ç½®ã€‚</p></li></ul><h3 id="2-15"><a href="#2-15" class="headerlink" title="2.15"></a>2.15</h3><ul><li><input disabled="" type="checkbox"> 2.15 å·²çŸ¥æŒ‡é’ˆ ha å’Œ hb åˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªå•é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œå¹¶ä¸”å·²çŸ¥ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦åˆ†åˆ«ä¸º m å’Œ nã€‚è¯•å†™ä¸€ç®—æ³•å°†è¿™ä¸¤ä¸ªé“¾è¡¨è¿æ¥åœ¨ä¸€èµ·ï¼Œå‡è®¾æŒ‡é’ˆ hc æŒ‡å‘è¿æ¥åçš„é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œå¹¶è¦æ±‚ç®—æ³•ä»¥å°½å¯èƒ½çŸ­çš„æ—¶é—´å®Œæˆè¿æ¥è¿ç®—ã€‚</li></ul><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xl">void MergeList_L(LinkList &amp;ha,LinkList &amp;hb,LinkList &amp;hc) <br>&#123; <br>    LinkList pa,pb; <br>    pa=ha; <br>    pb=hb; <br>    <span class="hljs-function"><span class="hljs-title">while</span>(pa-&gt;</span><span class="hljs-function"><span class="hljs-title">next</span>&amp;&amp;pb-&gt;</span>next)&#123; <br>        <span class="hljs-function"><span class="hljs-title">pa</span>=pa-&gt;</span>next; <br>        <span class="hljs-function"><span class="hljs-title">pb</span>=pb-&gt;</span>next; <br>    &#125; <br>    <span class="hljs-function"><span class="hljs-title">if</span>(!pa-&gt;</span>next)&#123;          <span class="hljs-comment">//paåˆ°å¤´äº†</span><br>        hc=hb; <br>        <span class="hljs-function"><span class="hljs-title">while</span>(pb-&gt;</span><span class="hljs-function"><span class="hljs-title">next</span>) pb=pb-&gt;</span>next; <br>        <span class="hljs-function"><span class="hljs-title">pb</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">next</span>=ha-&gt;</span>next; <br>    &#125; <br>    <span class="hljs-keyword">else</span>&#123; <br>        hc=ha; <br>        <span class="hljs-function"><span class="hljs-title">while</span>(pa-&gt;</span><span class="hljs-function"><span class="hljs-title">next</span>) pa=pa-&gt;</span>next; <br>        <span class="hljs-function"><span class="hljs-title">pa</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">next</span>=hb-&gt;</span>next; <br>    &#125; <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-16"><a href="#2-16" class="headerlink" title="2.16"></a>2.16</h3><p>å·²çŸ¥æŒ‡é’ˆ la å’Œ lb åˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªæ— å¤´ç»“ç‚¹å•é“¾è¡¨ä¸­çš„é¦–å…ƒç»“ç‚¹ã€‚å†™ä¸€ä¸ªç®—æ³•å®ç°:</p><p>ä»è¡¨ la ä¸­åˆ é™¤è‡ªç¬¬ i ä¸ªå…ƒç´ èµ·å…± len ä¸ªå…ƒç´ åï¼Œå°†å®ƒä»¬æ’å…¥åˆ°è¡¨ lb ä¸­ç¬¬ i ä¸ªå…ƒç´ ä¹‹å‰ã€‚</p><h3 id="2-22"><a href="#2-22" class="headerlink" title="2.22"></a>2.22</h3><ul><li><input checked="" disabled="" type="checkbox"> è¯•å†™ä¸€ç®—æ³•ï¼Œå¯¹å•é“¾è¡¨å®ç°å°±åœ°é€†ç½®ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Lnode</span> &#123;</span><br>    ElemType data; <br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Lnode</span> *<span class="hljs-title">next</span>;</span> <br>&#125; Lnode, *LinkList;<br><br><span class="hljs-comment">//Lnodeï¼Œå°† struct Lnode é‡å‘½åä¸º Lnodeï¼Œè¿™å…è®¸æˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨ Lnode æ¥å£°æ˜ç»“æ„ä½“ç±»å‹çš„å˜é‡ã€‚ï¼Ÿï¼Ÿ</span><br><span class="hljs-comment">//LinkListï¼Œå°† struct Lnode* é‡å‘½åä¸º LinkListï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ LinkList æ¥å£°æ˜æŒ‡å‘é“¾è¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆå˜é‡ã€‚</span><br><br>Status <span class="hljs-title function_">ListOppose_L</span><span class="hljs-params">(LinkList &amp;L)</span> <br>&#123; <br>    LinkList p,q;   <span class="hljs-comment">//ä¸¤ä¸ªè¾…åŠ©æŒ‡é’ˆ</span><br>    p=L;       <span class="hljs-comment">//å°† p æŒ‡é’ˆæŒ‡å‘é“¾è¡¨å¤´èŠ‚ç‚¹ã€‚</span><br>    p=p-&gt;next;  <span class="hljs-comment">// å°† p ç§»åŠ¨åˆ°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªçœŸå®èŠ‚ç‚¹ï¼Œå³è·³è¿‡å¤´èŠ‚ç‚¹ã€‚</span><br>    L-&gt;next=<span class="hljs-literal">NULL</span>; <span class="hljs-comment">// å°†å¤´èŠ‚ç‚¹çš„ next æŒ‡é’ˆç½®ç©ºï¼Œå³å°†é€†ç½®åçš„é“¾è¡¨æœ«å°¾èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘ç©ºã€‚</span><br>    <span class="hljs-keyword">while</span>(p)&#123; <br>        q=p;         <br>        p=p-&gt;next;   <span class="hljs-comment">//è¿™ä¸¤è¡Œå°±æ˜¯æŠŠ q æŒ‡å‘ pï¼Œç„¶åå°† p å‘åç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼š</span><br>        q-&gt;next=L-&gt;next;  <br>        L-&gt;next=q;   <span class="hljs-comment">//è¿™ä¸¤è¡Œå°±æ˜¯è¿›è¡Œæ’å…¥ï¼Œå³ï¼šå°† q æ‰€æŒ‡çš„èŠ‚ç‚¹æ’å…¥åˆ°ç°åœ¨çš„è¡¨ L çš„å¤´ç»“ç‚¹å’Œé¦–å…ƒç»“ç‚¹ä¸­é—´ï¼š</span><br>    &#125; <br>    <span class="hljs-keyword">return</span> OK; <br>&#125;<br><br><br><br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_41109668/article/details/104636252?ops_request_misc=%7B%22request_id%22:%22169519655816800227422429%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=169519655816800227422429&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-104636252-null-null.142%5Ev94%5EchatsearchT3_1&utm_term=%E8%AF%95%E5%86%99%E4%B8%80%E7%AE%97%E6%B3%95%EF%BC%8C%E5%AF%B9%E5%8D%95%E9%93%BE%E8%A1%A8%E5%AE%9E%E7%8E%B0%E5%B0%B1%E5%9C%B0%E9%80%86%E7%BD%AE%E3%80%82&spm=1018.2226.3001.4187">è¯•å†™ä¸€ç®—æ³•ï¼Œå¯¹å•é“¾è¡¨è¿›è¡Œé€†ç½®è¯•å†™ä¸€ç®—æ³•,å®ç°å•é“¾è¡¨çš„å°±åœ°é€†ç½®(è¦æ±‚åœ¨åŸé“¾è¡¨ä¸Šè¿›è¡Œ)_ç™½è–‡.çš„åšå®¢-CSDNåšå®¢</a></p><p>å¤§ä½¬ï¼ï¼ï¼è¿™ç¯‡åšå®¢è§£é‡Šçš„éå¸¸æ¸…æ¥š</p>]]></content>
    
    
    <categories>
      
      <category>å¤§ä¸‰ä¸Š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•è®¾è®¡ä¸åˆ†æ-æ’åº</title>
    <link href="/2023/09/18/%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-%E6%8E%92%E5%BA%8F/"/>
    <url>/2023/09/18/%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1-%E6%8E%92%E5%BA%8F/</url>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/weixin_43586713/article/details/119820797?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-9-119820797.142%5Ev94%5EchatsearchT3_1&spm=1018.2226.3001.4187">å¿«é€Ÿæ’åº(è¯¦ç»†è®²è§£)-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/justidle/article/details/104203958?ops_request_misc=%7B%22request_id%22:%22169518266216800185894255%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=169518266216800185894255&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-104203958-null-null.142%5Ev94%5EchatsearchT3_1&utm_term=%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F&spm=1018.2226.3001.4187">æ’åºâ€”â€”å½’å¹¶æ’åºï¼ˆMerge sort)-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>å¤§ä¸‰ä¸Š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cè¯­è¨€å­¦ä¹ </title>
    <link href="/2023/09/17/C%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/09/17/C%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>å¦‚æœåœ¨<code>int</code>å‹å˜é‡çš„å£°æ˜ä¸­ä¸ºå˜é‡èµ‹åº”è¯¥å®æ•°å€¼çš„åˆå§‹å€¼ï¼ˆå¦‚3.14æˆ–5.7ç­‰ï¼‰ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p><ul><li>ä¼šç›´æ¥èˆå»å°æ•°éƒ¨åˆ†ï¼Œåªä¿ç•™æ•´æ•°éƒ¨åˆ†</li></ul><p>å•ç›®è¿ç®—ç¬¦&amp;ï¼ˆå–å€¼è¿ç®—ç¬¦ï¼‰</p><ul><li>&amp;aï¼Œå–å¾—açš„åœ°å€ï¼ˆç”Ÿäº§æŒ‡å‘açš„æŒ‡é’ˆï¼‰</li></ul><p>å•ç›®è¿ç®—ç¬¦*ï¼ˆæŒ‡é’ˆè¿ç®—ç¬¦ï¼‰</p><ul><li>*aï¼ŒaæŒ‡å‘çš„å¯¹è±¡</li></ul><p>èµ‹å€¼è¡¨è¾¾å¼çš„å·¦æ“ä½œæ•°ä¸å¯ä»¥æ˜¯æ•°ç»„åã€‚</p><p><code>p</code>æŒ‡å‘<code>x</code>æ—¶ï¼Œ<code>*p</code>æ˜¯<code>x</code>çš„åˆ«å</p><p>æŒ‡é’ˆ<code>p</code>æŒ‡å‘æ•°ç»„ä¸­çš„å…ƒç´ <code>e</code>æ—¶</p><ul><li><code>p + i</code>ä¸ºæŒ‡å‘å…ƒç´ <code>e</code>åç¬¬<code>i</code>ä¸ªå…ƒç´ çš„æŒ‡é’ˆ</li><li><code>p - i</code>ä¸ºæŒ‡å‘å…ƒç´ <code>e</code>å‰ç¬¬<code>i</code>ä¸ªå…ƒç´ çš„æŒ‡é’ˆ</li><li>æŒ‡å‘å…ƒç´ <code>e</code>åç¬¬<code>i</code>ä¸ªå…ƒç´ çš„<code>*(p + i)</code>ï¼Œå¯ä»¥å†™ä¸º<code>p[i]</code></li><li>æŒ‡å‘å…ƒç´ <code>e</code>å‰ç¬¬<code>i</code>ä¸ªå…ƒç´ çš„<code>*(p - i)</code>ï¼Œå¯ä»¥å†™ä¸º<code>p[-i]</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230917142303857.png" alt="image-20230917142303857"></p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230917142327597.png" alt="image-20230917142327597"></p><p><code>c</code>è¯­è¨€ç¼–è¯‘é˜¶æ®µå‡ºç°å¦‚ä¸‹çš„é—®é¢˜ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgc00e0930273a652d2e9d0d0b218eb41.png" alt="c00e0930273a652d2e9d0d0b218eb41"></p><p>å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯æœ‰æ­£åœ¨è¿è¡Œçš„ç«¯å£æ²¡å…³é—­ï¼ï¼ï¼</p>]]></content>
    
    
    <categories>
      
      <category>code</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cryptoç³»åˆ—â€”â€”RSAï¼ˆä¸€ï¼‰</title>
    <link href="/2023/09/14/Crypto%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94RSA%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2023/09/14/Crypto%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94RSA%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>ä¸çŸ¥é“ä¸ºå•¥å°±å¯¹å¯†ç å­¦æ„Ÿå…´è¶£äº†ï¼Œä¸Šå­¦æœŸå­¦äº†åŠå¤©pwnæ²¡ææ‡‚ï¼Œæˆ–è®¸å°±ä¸é€‚åˆæ‰“å­¦ppwnå§ğŸ˜­</p><p>ã€Šä»0å¼€å§‹çš„å¯†ç å­¦ä¸–ç•Œç”Ÿæ´»ã€‹ğŸ˜‹æ…¢æ…¢å­¦å¯†ç æ–¹å‘</p><p>åœ¨æ¢å§¬çš„å»ºè®®ä¸‹ï¼Œè¿˜æ˜¯ä¹°äº†è¿™å¥—è¯¾ç¨‹ï¼Œå¼€å¹²ï¼</p><h2 id="RSA1-P1"><a href="#RSA1-P1" class="headerlink" title="[RSA1]P1"></a>[RSA1]P1</h2><h3 id="main-py"><a href="#main-py" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 10554915510546378513140074459658086644656654144905337809416976066414771647836950941616441505897207397834928781511863699153349798682451297889979721668885951</span><br><span class="hljs-string">q = 8246403321715011123191410826902524505032643184038566851264109473851746507405534573077909160292816825514872584170252311902322051822644609979417178306809223</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 40005881669517895877352756665523238535105922590962714344556374248977905431683140065629966778249773228248201807844489945346731806741025157651474530811920115794270396320935022110691338083709019538562205165553541077855422953438117902279834449006455379382431883650004540282758907332683496655914597029545677184720</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py"><a href="#decrypt-py" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥p,q,e,c,å¯ç›´æ¥æ±‚å‡ºd,ç„¶åæ±‚å‡ºm</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">10554915510546378513140074459658086644656654144905337809416976066414771647836950941616441505897207397834928781511863699153349798682451297889979721668885951</span><br>q = <span class="hljs-number">8246403321715011123191410826902524505032643184038566851264109473851746507405534573077909160292816825514872584170252311902322051822644609979417178306809223</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">40005881669517895877352756665523238535105922590962714344556374248977905431683140065629966778249773228248201807844489945346731806741025157651474530811920115794270396320935022110691338083709019538562205165553541077855422953438117902279834449006455379382431883650004540282758907332683496655914597029545677184720</span><br><br>n = p * q<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))   <span class="hljs-comment"># b&#x27;NSSCTF&#123;now!you_know_rsa&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>å…³äºç±»å‹çš„è½¬æ¢ï¼Œpepperå¸ˆå‚…è¿™é‡Œè¯´çš„å¾ˆå¥½ï¼Œæˆ‘å°±ç›´æ¥copyäº†</p><p>æœ¬é¢˜éœ€è¦ç†è§£æ˜æ–‡å’Œå¯†æ–‡çš„ç±»å‹åŠå…¶ç±»å‹è½¬æ¢å‡½æ•°ã€‚<strong>longç±»å‹ä¸ºä¸€ä¸²æ•°å­—</strong>ï¼Œ<strong>bytesæ˜¯å­—ç¬¦</strong>ã€‚</p><p>åœ¨ä¸‹åˆ—ç¤ºä¾‹ä¸­ï¼Œmessageè¡¨ç¤ºbytesç±»å‹æ˜æ–‡ï¼Œmè¡¨ç¤ºlongç±»å‹æ˜æ–‡ï¼Œcè¡¨ç¤ºlongç±»å‹å¯†æ–‡ã€‚</p><p>åœ¨rsa.pyå‡½æ•°ä¸­ï¼š</p><ol><li><p>è¾“å…¥ message æ˜æ–‡ä¸º bytes ç±»å‹,åŠ å¯† c&#x3D;pow(m,e,n) ä¸­æ˜æ–‡ m ä¸º long ç±»å‹ï¼Œè¾“å‡ºå¯†æ–‡ c æ˜¯ long ç±»å‹ã€‚</p><p>message åˆ° m éœ€è¦é€šè¿‡ bytes_to_long(message) æ–¹æ³•è¿›è¡Œè½¬æ¢</p></li><li><p>è§£å¯† m&#x3D; pow(c, d, n) ä¸­ m ä¸º long ç±»å‹ï¼Œc ä¸º long ç±»å‹ã€‚</p><p>æ‰“å°è¾“å‡ºçš„æ˜æ–‡ message éœ€è¦ bytes ç±»å‹ï¼Œé€šè¿‡ long_to_bytes(m) æ–¹æ³•è¿›è¡Œè½¬æ¢</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">m = bytes_to_long(message) <span class="hljs-built_in">bytes</span>è½¬long<br>message = long_to_bytes(m) longè½¬<span class="hljs-built_in">bytes</span><br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P2"><a href="#RSA1-P2" class="headerlink" title="[RSA1]P2"></a>[RSA1]P2</h2><h3 id="main-py-1"><a href="#main-py-1" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">256</span>)<br>q = getPrime(<span class="hljs-number">256</span>)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 7382582015733895208810490097582153009797420348201515356767397357174775587237553842395468027650317457503579404097373070312978350435795210286224491315941881</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 6511001389892474870028836129813814173158254564777610289284056550272120510686249909340499673868720839756059423749304765055919251717618117507007046973023557</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-1"><a href="#decrypt-py-1" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥n,e,c,åˆ†è§£nï¼Œå¾—åˆ°p,q</strong></p><p>æœ¬é¢˜æ„æ€æ˜¯åªçŸ¥é“äº†nï¼Œè€Œpå’Œqéƒ½ä¸çŸ¥é“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æŠŠnè¿™ä¸ªå¤§æ•´æ•°åˆ†è§£ï¼Œç”¨åˆ°ç½‘ç«™<a href="http://factordb.com/">factordb.com</a></p><p>å¾—åˆ°åˆ†è§£çš„ä¸¤ä¸ªæ•°på’Œqï¼Œå³å¯å†™å‡ºdecrypt.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">7382582015733895208810490097582153009797420348201515356767397357174775587237553842395468027650317457503579404097373070312978350435795210286224491315941881</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">6511001389892474870028836129813814173158254564777610289284056550272120510686249909340499673868720839756059423749304765055919251717618117507007046973023557</span><br><br>p = <span class="hljs-number">70538125404512947763739093348083497980212021962975762144416432920656660487657</span><br>q = <span class="hljs-number">104660876276442216612517835199819767034152013287345576481899196023866133215633</span><br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P3"><a href="#RSA1-P3" class="headerlink" title="[RSA1]P3"></a>[RSA1]P3</h2><h3 id="main-py-2"><a href="#main-py-2" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">128</span>)<br>q = getPrime(<span class="hljs-number">128</span>)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 53690629441472827148854210396580805205350972614395425306316047967905824330731</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 22130296334673852790451396673112575082637108306697684532954477845025885087040</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-2"><a href="#decrypt-py-2" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥n,e,c,yafuåˆ†è§£nï¼Œå¾—åˆ°p,q</strong></p><p>è™½ç„¶å®ƒè¯´æ˜¯è¦è®©ç”¨yafuï¼Œå‘½ä»¤ä¸ºï¼š<code>.\yafu-x64.exe &quot;factor(@)&quot; -batchfile 1.txt</code></p><p><a href="https://wiki.mrskye.cn/Crypto/yafu%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8/">yafuå®‰è£…åŠä½¿ç”¨ - SkYe Wiki (mrskye.cn)</a></p><p>ä½†æˆ‘å¯»æ€è¿™ä¸ªæ•°æ¯”ä¸Šé¢çš„æ•°è¿˜å°ï¼Œç›´æ¥<a href="http://factordb.com/">factordb.com</a>ä¸å°±è¡Œè¾£ğŸ˜‹</p><p>æ±‚å‡ºpå’Œqåï¼Œè§£å¯†å‡½æ•°è·Ÿ**[RSA1]P2**ä¸€æ ·</p><hr><h2 id="RSA1-P4"><a href="#RSA1-P4" class="headerlink" title="[RSA1]P4"></a>[RSA1]P4</h2><h3 id="main-py-3"><a href="#main-py-3" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = gmpy2.next_prime(p)<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 115637000420176820831322601039129424406844427046456738651883381559357542765613732363445112111006849040385859313572091386802534464534403117787314180179562651607533039692795522388596550968316951090748054495960090527479954143448774136390568881020918710834542819900918984139672802889774720153267841255456602500057</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 98161406745910866780822530171878255235776133393411573803496865047700715941955255328757920065032397556905095591171977170479344602512244671081108703687450560269408412671849929423399172588599903975793985819498354819305128607934552101433664794909855378636055525016664559476808490723554481335856183927702549281730</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-3"><a href="#decrypt-py-3" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥n,e,cï¼Œä¸”p,qç›¸å·®ä¸å¤§ï¼ˆç‰¹ä¾‹æ¬¾ï¼‰ã€‚</strong></p><p>ç›´æ¥copyäº†xennyå¸ˆå‚…çš„wpï¼ŒğŸ˜°ğŸ˜¢</p><ul><li>æœ¬é¢˜çš„å…³é”®æ˜¯<code>q = gmpy2.next_prime(p)</code>ï¼Œç›¸å½“äºqæ˜¯pçš„ä¸‹ä¸€ä¸ªç´ æ•°</li><li>ç„¶åè¿™é‡Œé‡‡ç”¨äº†ä¸€ä¸ª$ \sqrt{n} $ï¼Œå› ä¸º$n &#x3D; p*q$ï¼Œè€ƒè™‘nçš„ç®—æœ¯å¹³æ–¹æ ¹ä¸º$sn &#x3D; \sqrt{n} $ï¼ŒåŒæ—¶ sn ä¹Ÿæ˜¯på’Œqçš„å‡ ä½•å¹³å‡å€¼ã€‚æ‰€ä»¥æœ‰$p&lt;sn&lt;q$</li><li>åˆæœ‰pï¼Œqæ˜¯ç›¸é‚»çš„ç´ æ•°ï¼Œpçš„ä¸‹ä¸€ä¸ªç´ æ•°ä¸ºqï¼ŒåŒç†ä¹Ÿæœ‰snçš„ä¸‹ä¸€ä¸ªç´ æ•°ä¹Ÿåº”è¯¥æ˜¯qï¼Œ</li><li>ç„¶åç”±qæ±‚å‡ºpå³å¯</li></ul><p>è¿™é‡Œé™„ä¸Šä¸€ç¯‡æ–‡ç« ï¼š<a href="https://www.freebuf.com/articles/database/290623.html">æµ…æRSAå› å­å¤§å°ç›¸è¿‘æ—¶åˆ†è§£å› å­æ”»å‡»æ–¹æ³• - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = gmpy2.next_prime(p)<br><br>n = <span class="hljs-number">115637000420176820831322601039129424406844427046456738651883381559357542765613732363445112111006849040385859313572091386802534464534403117787314180179562651607533039692795522388596550968316951090748054495960090527479954143448774136390568881020918710834542819900918984139672802889774720153267841255456602500057</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">98161406745910866780822530171878255235776133393411573803496865047700715941955255328757920065032397556905095591171977170479344602512244671081108703687450560269408412671849929423399172588599903975793985819498354819305128607934552101433664794909855378636055525016664559476808490723554481335856183927702549281730</span><br><br>sn = isqrt(n)      <span class="hljs-comment">#æˆ–è€…sn = gmpy2.iroot(n,2)</span><br>q = next_prime(sn)<br>p = n // q<br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = invert(e, phi)<br><br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P5"><a href="#RSA1-P5" class="headerlink" title="[RSA1]P5"></a>[RSA1]P5</h2><h3 id="main-py-4"><a href="#main-py-4" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = gmpy2.next_prime(p - getPrime(<span class="hljs-number">256</span>))<br>n = p*q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 148841588941490812589697505975986386226158446072049530534135525236572105309550985274214825612079495930267744452266230141871521931612761645600600201983605957650711248808703757693378777706453580124982526368706977258199152469200838211055230241296139605912607613807871432800586045262879581100319519318390454452117</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 69038543593219231496623016705860610154255535760819426453485115089535439537440188692852514795648297200067103841434646958466720891016026061658602312900242658759575613625726750416539176437174502082858413122020981274672260498423684555063381678387696096811975800995242962853092582362805345713900308205654744774932</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt1-py"><a href="#decrypt1-py" class="headerlink" title="decrypt1.py"></a>decrypt1.py</h3><p><strong>å·²çŸ¥n,e,cï¼Œä¸”p,qç›¸å·®ä¸å¤§ï¼ˆç»å…¸æ¬¾ï¼‰ã€‚</strong></p><p>ç›´æ¥yafuåˆ†è§£ï¼š</p><p>ä½†æ˜¯ä¸èƒ½ç”¨[RSA1]P4é‡Œé¢çš„æ–¹æ³•ï¼Œå› ä¸ºæ ¹å·nçš„ä¸‹ä¸€ä¸ªç´ æ•°ä¸ä¸€å®šæ˜¯qå“¦ğŸ˜¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>P = <span class="hljs-number">12200065120379104459630695224710181907653841921369674962900093531339421658815375891425102591939094029941691738405035324548070063226677838530633694428729829</span><br>q = <span class="hljs-number">12200065120379104459630695224710181907653841921369674962900093531339421658815305905822146210878434959851438079877557401145694064756239882458467901042367473</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">69038543593219231496623016705860610154255535760819426453485115089535439537440188692852514795648297200067103841434646958466720891016026061658602312900242658759575613625726750416539176437174502082858413122020981274672260498423684555063381678387696096811975800995242962853092582362805345713900308205654744774932</span><br><br>n = p * q<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))   <br></code></pre></td></tr></table></figure><p>æ–‡ç«  - <a href="https://www.nssctf.cn/note/set/3025">RSA1]P5 pepperçš„WriteUp | NSSCTF</a></p><h3 id="decrypt2-py"><a href="#decrypt2-py" class="headerlink" title="decrypt2.py"></a>decrypt2.py</h3><p><strong>å·²çŸ¥n,e,cï¼Œä¸”p,qç›¸å·®ä¸å¤§ï¼ˆç»å…¸æ¬¾ï¼‰ã€‚</strong></p><p>è´¹é©¬åˆ†è§£ï¼š <a href="https://www.nssctf.cn/note/set/3025">RSA1]P5 pepperçš„WriteUp | NSSCTF</a></p><p>çœ‹æ‡‚äº†ï¼Œåªæœ‰ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆä»aä»æ ¹å·nå¼€å§‹åŠ </p><ul><li>å› ä¸ºbè¦ä»0ï¼Œaç­‰äºæ ¹å·næ—¶bæ‰ç­‰äº0ğŸ˜‹</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = gmpy2.next_prime(p - getPrime(<span class="hljs-number">256</span>))<br><br>n = <span class="hljs-number">148841588941490812589697505975986386226158446072049530534135525236572105309550985274214825612079495930267744452266230141871521931612761645600600201983605957650711248808703757693378777706453580124982526368706977258199152469200838211055230241296139605912607613807871432800586045262879581100319519318390454452117</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">69038543593219231496623016705860610154255535760819426453485115089535439537440188692852514795648297200067103841434646958466720891016026061658602312900242658759575613625726750416539176437174502082858413122020981274672260498423684555063381678387696096811975800995242962853092582362805345713900308205654744774932</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fermat_attack</span>(<span class="hljs-params">n</span>):<br>    a = isqrt(n)<br>    b2 = a*a - n<br>    b = isqrt(n)    <span class="hljs-comment">#è¿™é‡Œåªæ˜¯å¯¹bè¿›è¡Œä¸€ä¸ªåˆå§‹åŒ–ï¼Œb=1ï¼Œ2ï¼Œ3ï¼Œï¼Œï¼Œç­‰äºå‡ åº”è¯¥éƒ½è¡Œ</span><br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> b*b != b2:          <br>        a = a + <span class="hljs-number">1</span><br>        b2 = a*a - n<br>        b = isqrt(b2)<br>        count += <span class="hljs-number">1</span><br>    p = a+b<br>    q = a-b<br>    <span class="hljs-keyword">assert</span> n == p * q<br>    <span class="hljs-keyword">return</span> p, q<br><br><br>p, q = fermat_attack(n)<br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = invert(e, phi)<br><br><br>msg = <span class="hljs-built_in">pow</span>(c, d, n)<br>message = long_to_bytes(msg)<br><br><span class="hljs-built_in">print</span>(message)<br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P6"><a href="#RSA1-P6" class="headerlink" title="[RSA1]P6"></a>[RSA1]P6</h2><h3 id="main-py-5"><a href="#main-py-5" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p1 = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>p2 = getPrime(<span class="hljs-number">512</span>)<br><br>n1 = p1*q<br>n2 = p2*q<br><br>e = <span class="hljs-number">65537</span><br><br>m = bytes_to_long(flag)<br>c1 = <span class="hljs-built_in">pow</span>(m, e, n1)<br>c2 = <span class="hljs-built_in">pow</span>(m, e, n2)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n1 = <span class="hljs-subst">&#123;n1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n2 = <span class="hljs-subst">&#123;n2&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c1 = <span class="hljs-subst">&#123;c1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c2 = <span class="hljs-subst">&#123;c2&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n1 = 143348646254804947818644803938588739009782265465565896704788366218178523508874903492905378927641178487821742289009401873633609987818871281146199303052141439575438691652893995423962176259643151111739185844059243400387734688275416379337335777994990138009973618431459431410429980866760075387393812720247541406893</span><br><span class="hljs-string">n2 = 138110854441015362783564250048191029327770295545362614687087481715680856350219966472039006526758450117969049316234863489558254565946242898336924686721846675826468588471046162610143748100096038583426519355288325214365299329095841907207926280081868726568947436076663762493891291276498567791697978693639037765169</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c1 = 54957154834913405861345262613986460384513988240935244315981524013378872930144117440787175357956479768211180412158274730449811947349624843965933828130932856052315165316154486515277625404352272475136003785605985702495858150662789554694910771308456687676791434476722168247882078861234982509648037033827107552029</span><br><span class="hljs-string">c2 = 122221335585005390437769701090707585780333874638519916373585594040154234166935881089609641995190534396533473702495240511296379249872039728112248708182969185010334637138777948970821974238214641235158623707766980447918480715835847907220219601467702961667091318910582445444058108454023108157805147341928089334736</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-4"><a href="#decrypt-py-4" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥ï¼ˆe,n1,c1,n2,c1ï¼‰ï¼Œæ±‚m</strong></p><p><strong>ä¸¤ç»„æ•°ä¸­eç›¸åŒï¼Œn,cä¸åŒï¼Œn1å’Œn2çš„æœ€å¤§å…¬å› æ•°å³ä¸ºp,ä¹‹åå°±èƒ½æ±‚å‡ºqã€d,ç»§è€Œæ±‚å‡ºm</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>n1 = <span class="hljs-number">143348646254804947818644803938588739009782265465565896704788366218178523508874903492905378927641178487821742289009401873633609987818871281146199303052141439575438691652893995423962176259643151111739185844059243400387734688275416379337335777994990138009973618431459431410429980866760075387393812720247541406893</span><br>n2 = <span class="hljs-number">138110854441015362783564250048191029327770295545362614687087481715680856350219966472039006526758450117969049316234863489558254565946242898336924686721846675826468588471046162610143748100096038583426519355288325214365299329095841907207926280081868726568947436076663762493891291276498567791697978693639037765169</span><br>e = <span class="hljs-number">65537</span><br>c1 = <span class="hljs-number">54957154834913405861345262613986460384513988240935244315981524013378872930144117440787175357956479768211180412158274730449811947349624843965933828130932856052315165316154486515277625404352272475136003785605985702495858150662789554694910771308456687676791434476722168247882078861234982509648037033827107552029</span><br>c2 = <span class="hljs-number">122221335585005390437769701090707585780333874638519916373585594040154234166935881089609641995190534396533473702495240511296379249872039728112248708182969185010334637138777948970821974238214641235158623707766980447918480715835847907220219601467702961667091318910582445444058108454023108157805147341928089334736</span><br><br><span class="hljs-comment"># p1 = getPrime(512)</span><br><span class="hljs-comment"># q = getPrime(512)</span><br><span class="hljs-comment"># p2 = getPrime(512)            bydä½ å†™è§£ä»£ç çš„æ—¶å€™åŠ ä¸Šè¿™ä¸€æ®µå¹²ä»€ä¹ˆ</span><br><br><span class="hljs-comment"># n1 = p1*q</span><br><span class="hljs-comment"># n2 = p2*q</span><br><br>q = gcd(n1,n2)        <span class="hljs-comment"># æœ€å…³é”®çš„ä¸€å¥ï¼Œçœ‹å‡ºqæ˜¯n1å’Œn2çš„æœ€å¤§å…¬å› æ•°ï¼Œç„¶åæ±‚å‡ºqï¼Œåé¢å°±å¸¸è§„</span><br><span class="hljs-comment"># print(q)</span><br>p1 = n1 // q<br><br>phi = (q-<span class="hljs-number">1</span>)*(p1-<span class="hljs-number">1</span>)<br>d1 = invert(e, phi) <br><br>m1 = <span class="hljs-built_in">pow</span>(c1, d1, n1)<br><br><br><span class="hljs-comment"># m1=hex(m1).replace(&#x27;0x&#x27;,&#x27;&#x27;)</span><br><span class="hljs-comment"># flag = bytes.fromhex(m1)</span><br><span class="hljs-comment"># print(flag)</span><br><br><span class="hljs-built_in">print</span>(long_to_bytes(m1))<br><span class="hljs-comment"># ä½†æ˜¯æœ‰ä¸ªå°é—®é¢˜å•Šï¼Œä¸ºä»€ä¹ˆn1å’Œn2è§£å‡ºæ¥æ˜¯ä¸€æ ·çš„æğŸ¤’</span><br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P7"><a href="#RSA1-P7" class="headerlink" title="[RSA1]P7"></a>[RSA1]P7</h2><h3 id="main-py-6"><a href="#main-py-6" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span> + <span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">170</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>r = getPrime(<span class="hljs-number">512</span>)<br>n = p*q*r<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;r = <span class="hljs-subst">&#123;r&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 10666139331774428325755287635566473140804481321882464031499529816800186578792308674238646794969384836340484775213796013129603472328582005363876462361316357</span><br><span class="hljs-string">q = 8419311673449738061914489023962717718536471719688567807316495262754711350004888752049108347226115000749280146228195893953964759818878155006622123533942989</span><br><span class="hljs-string">r = 12875078327453384158245832541544758526474680184252540739652077682353277702054275525591573258723948221345537075374635382175740236093131628077747126356403959</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 424552463648937499189041230155623101311087334789253159440707211761796081289342164253743235182597460622581134089949035117444838205449163269030784233435435681797627188717450074808905561404960693227573181548281296514743775615606388692910356320667720308219275107443303501165027740512539959960217657836317351146520079753390346207659007421416917274795119021374032194294225350901136669304225010974617136606299060486198480556729770211945777266366417547752798441211059402</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-5"><a href="#decrypt-py-5" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥ï¼ˆeï¼Œpï¼Œqï¼Œrï¼‰ï¼Œæ±‚mï¼ˆç‰¹ä¾‹æ¬¾ï¼‰</strong></p><p>ç›¸å½“äºå¤šäº†ä¸€ä¸ªå‚æ•°rï¼Œè¿˜æ˜¯ä¸€æ ·ï¼ŒåŠ ä¸Šrå°±è¡Œäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">10666139331774428325755287635566473140804481321882464031499529816800186578792308674238646794969384836340484775213796013129603472328582005363876462361316357</span><br>q = <span class="hljs-number">8419311673449738061914489023962717718536471719688567807316495262754711350004888752049108347226115000749280146228195893953964759818878155006622123533942989</span><br>r = <span class="hljs-number">12875078327453384158245832541544758526474680184252540739652077682353277702054275525591573258723948221345537075374635382175740236093131628077747126356403959</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">424552463648937499189041230155623101311087334789253159440707211761796081289342164253743235182597460622581134089949035117444838205449163269030784233435435681797627188717450074808905561404960693227573181548281296514743775615606388692910356320667720308219275107443303501165027740512539959960217657836317351146520079753390346207659007421416917274795119021374032194294225350901136669304225010974617136606299060486198480556729770211945777266366417547752798441211059402</span><br><br>n = p * q * r<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)<br><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))  <br><br><span class="hljs-comment">#b&#x27;NSSCTF&#123;3th_number!&#125;11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111&#x27;</span><br><span class="hljs-comment"># ä¸è¿‡è‡³äºæœ¬é¢˜ä¸ºä½•è¦æ·»åŠ ä¸Šå¤§é‡çš„å­—ç¬¦1ä½œä¸ºå¡«å……å†…å®¹ï¼Œè¿™ä¸ªé—®é¢˜å¾…åˆ°P9æ—¶æˆ‘ä»¬ä¾¿ä¼šçŸ¥æ™“ã€‚</span><br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P8"><a href="#RSA1-P8" class="headerlink" title="[RSA1]P8"></a>[RSA1]P8</h2><h3 id="main-py-7"><a href="#main-py-7" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span> + <span class="hljs-string">b&#x27;1&#x27;</span>*<span class="hljs-number">100</span><br><br>p = getPrime(<span class="hljs-number">256</span>)<br>q = getPrime(<span class="hljs-number">256</span>)<br>n = (p**<span class="hljs-number">3</span>) * q<br>e = <span class="hljs-number">65537</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 80505091208742938705306670241621545375764148093711243653439069254008824979403</span><br><span class="hljs-string">q = 67599990875658931406915486208971556223245451500927259766683936131876689508521</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 7958690969908064264211283192959937430539613460471121984649054121171267262097603091410178042319139582772142226087020110084551158367679146616732446561228522673699836019156243452069036383047309578614662564794584927846163157472211089368697387945469398750955336949678910159585015004994620777231073804301249774041</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-6"><a href="#decrypt-py-6" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥ï¼ˆeï¼Œpï¼Œqï¼Œrï¼‰ï¼Œæ±‚mï¼ˆç»å…¸æ¬¾ï¼‰</strong></p><p>bydæ¬§æ‹‰å…¬å¼éƒ½ä¸çŸ¥é“æ˜¯å§ï¼š</p><p>å¯¹äºï¼š<br>$$<br>n &#x3D; p_{1}^{k_{1}}p_{2}^{k_{2}}p_{3}^{k_{3}}\cdots p_{r}^{k_{r}}<br>$$</p><p>æ¬§æ‹‰å‡½æ•°ç­‰äºï¼š</p><p>$$<br>\varphi (n) &#x3D; \prod_{i&#x3D;1}^{r} p_{i}^{k_{i}-1}(p_{i}-1)<br>$$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">80505091208742938705306670241621545375764148093711243653439069254008824979403</span><br>q = <span class="hljs-number">67599990875658931406915486208971556223245451500927259766683936131876689508521</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">7958690969908064264211283192959937430539613460471121984649054121171267262097603091410178042319139582772142226087020110084551158367679146616732446561228522673699836019156243452069036383047309578614662564794584927846163157472211089368697387945469398750955336949678910159585015004994620777231073804301249774041</span><br><br>n = p * p * p * q<br>phi = (p**<span class="hljs-number">2</span>)*(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = <span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))  <br><br></code></pre></td></tr></table></figure><hr><h2 id="RSA1-P9"><a href="#RSA1-P9" class="headerlink" title="[RSA1]P9"></a>[RSA1]P9</h2><h3 id="main-py-8"><a href="#main-py-8" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>e = <span class="hljs-number">65537</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    r = <span class="hljs-number">2</span>*getPrime(<span class="hljs-number">100</span>)*e+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> isPrime(r):<br>        <span class="hljs-keyword">break</span><br><br>n = p*q*r<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;r = <span class="hljs-subst">&#123;r&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 7478755670255767435237487693415479182290330775502792675052667363676831056436638619069277770540533350723045234676443621124912287506103439704868369839725279</span><br><span class="hljs-string">q = 9232828888049557325429111621080998490274442347556398052322580869768941301413255711626092627273543579067597113958627672298942570149816938335701615759283713</span><br><span class="hljs-string">r = 102909133680612532601801231903654039</span><br><span class="hljs-string">e = 65537</span><br><span class="hljs-string">c = 142893174944324070830219394465469685943669308818639857030565389839224452373848570577201378981080333784852764502832587008270072323948511579823852437852643609820245476634896477031076952735298279618952398460203032125853063235638358942643559551563899381032067185778629120272032518475352761100115057449043142848203976076694124978394099839339406197</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-7"><a href="#decrypt-py-7" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥ï¼ˆeï¼Œpï¼Œqï¼Œr)ï¼Œä¸”må·²çŸ¥å¾ˆçŸ­</strong></p><p>æ€»ç»“ï¼š</p><p>æ»¡è¶³ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œå¯ä»¥ä¸ä½¿ç”¨é¢˜ä¸­ç»™çš„n&#x3D;pqrè®¡ç®—å…¬å¼ï¼Œè‡ªå·±é‡æ–°è®¡ç®—nï¼Œå†è¿›ä¸€æ­¥è®¡ç®—å…¬ç§é’¥ï¼š</p><ol><li><p>æ˜æ–‡mæ¯”è¾ƒç®€çŸ­</p><ul><li>flag  &#x3D;  bâ€™NSSCTF{ $\cdots \cdots  $}â€™ + bâ€™1â€™ * 100 ä¸è¡Œ</li><li>flag  &#x3D;  bâ€™NSSCTF{ $\cdots \cdots$ }â€™ å¯ä»¥</li></ul></li><li><p>åˆ†æå‘ç°ä½¿ç”¨ç»™å®šçš„næ— æ³•è®¡ç®—dï¼ŒåŸå› å¯èƒ½æ˜¯d &#x3D; inverse(e, phi)ä¸­eã€phiä¸äº’ç´ </p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br><br>p = <span class="hljs-number">7478755670255767435237487693415479182290330775502792675052667363676831056436638619069277770540533350723045234676443621124912287506103439704868369839725279</span><br>q = <span class="hljs-number">9232828888049557325429111621080998490274442347556398052322580869768941301413255711626092627273543579067597113958627672298942570149816938335701615759283713</span><br>r = <span class="hljs-number">102909133680612532601801231903654039</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">142893174944324070830219394465469685943669308818639857030565389839224452373848570577201378981080333784852764502832587008270072323948511579823852437852643609820245476634896477031076952735298279618952398460203032125853063235638358942643559551563899381032067185778629120272032518475352761100115057449043142848203976076694124978394099839339406197</span><br><br>n = p * q    <span class="hljs-comment"># ç›¸å½“äºç›´æ¥æŠŠrç»™å¿½ç•¥æ‰äº†ï¼Œä½†åŸç†è¿˜æ²¡æ‡‚ï¼Œxennyå¸ˆå‚…çš„wpæœ‰ç‚¹æ²¡çœ‹æ‡‚</span><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))   <br></code></pre></td></tr></table></figure><p>Xennyå¸ˆå‚…çš„wpï¼š<a href="https://www.nssctf.cn/problem/sheet/7142">Cryptoç³»åˆ—â€”â€”RSAï¼ˆä¸€ï¼‰ | NSSCTF</a></p><hr><h2 id="RSA1-P10"><a href="#RSA1-P10" class="headerlink" title="[RSA1]P10"></a>[RSA1]P10</h2><h3 id="main-py-9"><a href="#main-py-9" class="headerlink" title="main_py"></a>main_py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span><br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br><br>e = <span class="hljs-number">65537</span>*<span class="hljs-number">2</span><br><br>n = p*q<br><br>m = bytes_to_long(flag)<br><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;q = <span class="hljs-subst">&#123;q&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;e = <span class="hljs-subst">&#123;e&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">p = 9927950299160071928293508814174740578824022211226572614475267385787727188317224760986347883270504573953862618573051241506246884352854313099453586586022059</span><br><span class="hljs-string">q = 9606476151905841036013578452822151891782938033700390347379468858357928877640534612459734825681004415976431665670102068256547092636766287603818164456689343</span><br><span class="hljs-string">e = 131074</span><br><span class="hljs-string">c = 68145285629092005589126591120307889109483909395989426479108244531402455690717006058397784318664114589567149811644664654952286387794458474073250495807456996723468838094551501146672038892183058042546944692051403972876692350946611736455784779361761930869993818138259781995078436790236277196516800834433299672560</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="decrypt-py-8"><a href="#decrypt-py-8" class="headerlink" title="decrypt.py"></a>decrypt.py</h3><p><strong>å·²çŸ¥(eï¼Œpï¼Œqï¼Œcï¼‰ï¼Œä½†æ˜¯eå’Œphiä¸äº’ç´ </strong></p><p>å› ä¸ºpâˆ’1æˆ–qâˆ’1éƒ½æ˜¯å¶æ•°ï¼Œeä¹Ÿæ˜¯å¶æ•°ï¼Œä»–ä»¬æ˜¾ç„¶ä¸äº’ç´ ã€‚</p><p><strong>å…³é”®ã®å…¬å¼</strong>ï¼š<br>$$<br>c\equiv m^{e}\equiv (m^{2})^{65537}  (mod \quad n)<br>$$<br>æŠŠ $m^{2}$çœ‹æˆä¸€ä¸ªæ•´ä½“å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">9927950299160071928293508814174740578824022211226572614475267385787727188317224760986347883270504573953862618573051241506246884352854313099453586586022059</span><br>q = <span class="hljs-number">9606476151905841036013578452822151891782938033700390347379468858357928877640534612459734825681004415976431665670102068256547092636766287603818164456689343</span><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">68145285629092005589126591120307889109483909395989426479108244531402455690717006058397784318664114589567149811644664654952286387794458474073250495807456996723468838094551501146672038892183058042546944692051403972876692350946611736455784779361761930869993818138259781995078436790236277196516800834433299672560</span><br><br><br>n = p*q<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, p*q)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(isqrt(m)))<br><br><br><span class="hljs-comment"># åé¢è¿™éƒ¨åˆ†ä¹Ÿèƒ½å†™å‡ºä¸‹é¢è¿™æ ·ï¼š</span><br><br><br>n = p * q    <br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><span class="hljs-comment"># print(gcd(e, phi))</span><br><br>d = invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br>a,b = gmpy2.iroot(m,<span class="hljs-number">2</span>) <br><br><span class="hljs-built_in">print</span>(long_to_bytes(a))   <br></code></pre></td></tr></table></figure><p>2023.09.10-2023.09.14</p>]]></content>
    
    
    <categories>
      
      <category>CTF-Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RSAå­¦ä¹ æ€»ç»“</title>
    <link href="/2023/09/12/RSA%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/"/>
    <url>/2023/09/12/RSA%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p><code>from Crypto.Util.number import *</code><br><code>from gmpy2 import *</code></p><ul><li>å¯¼å…¥ä¸¤ä¸ªç»å…¸çš„æ¨¡å—</li></ul><p><code>d = inverse(e, phi)</code></p><p><code>d = invert(e, phi)</code></p><ul><li><code>inverse</code>å‡½æ•°ï¼Œ<code>invert</code>å‡½æ•°ï¼Œå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°<code>(a,p)</code>ï¼Œä½œç”¨ä¾¿æ˜¯æ±‚è§£<code>a</code>åœ¨æ¨¡<code>p</code>æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œ</li><li>è¿™é‡Œæˆ‘ä»¬ä¾¿æ˜¯æ±‚è§£<code>e</code>åœ¨æ¨¡<code>phi</code>ä¸‹é¢çš„ä¹˜æ³•é€†å…ƒï¼Œç»“æœä¸º<code>d</code></li><li>å³æ»¡è¶³$ e* d â‰¡ 1(mod Ï†(n)) $</li><li>å³æ»¡è¶³$ (d * e) % phi &#x3D; 1 $ï¼Œ%çš„æ„æ€æ˜¯å–ä½™</li><li>è¿™ä¸ªè¯­å¥ä½¿ç”¨çš„æ˜¯ <code>Crypto.Util.number</code> æ¨¡å—ä¸­çš„ <code>inverse()</code> å‡½æ•°</li></ul><p><code>d = gmpy2.invert(e, phi)  </code></p><ul><li>è¯¥å‡½æ•°è®¡ç®—äº†ä¸€ä¸ªæ•´æ•° e çš„æ¨¡é€†ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ•´æ•° dï¼Œä½¿å¾—$ (d * e) % phi &#x3D; 1 $</li><li>è¿™ä¸ªè¯­å¥ä½¿ç”¨çš„æ˜¯å¤–éƒ¨åº“ <code>gmpy2</code> çš„ <code>invert()</code> å‡½æ•°æ¥è®¡ç®—ä¹˜æ³•é€†å…ƒï¼Œ<del>gmpy2å’ŒCryptoä¸­çš„æ•°å­¦å‡½æ•°ç›¸æ¯”ï¼šäºŒè€…é€Ÿåº¦ä¸æ˜¯ä¸€ä¸ªé‡çº§ã€‚</del></li></ul><p><code>d = pow(e,-1,phi)</code></p><ul><li>å½“ä¼ é€’ä¸‰ä¸ªå‚æ•°æ—¶ï¼Œ<code>pow(x, y, z)</code> ç”¨äºè®¡ç®— <code>x</code> çš„ <code>y</code> æ¬¡å¹‚æ¨¡ <code>z</code> çš„ç»“æœã€‚åœ¨è¿™é‡Œï¼Œ<code>e</code> æ˜¯åº•æ•°ï¼Œ<code>-1</code> æ˜¯æŒ‡æ•°ï¼Œ<code>phi</code> æ˜¯æ¨¡æ•°ã€‚é€šè¿‡å°†æŒ‡æ•°è®¾ç½®ä¸º <code>-1</code>ï¼Œ<code>pow(e, -1, phi)</code> è®¡ç®—äº† <code>e</code> çš„æ¨¡ <code>phi</code> çš„ä¹˜æ³•é€†å…ƒã€‚</li><li>è¿™ä¸ªè¯­å¥ä½¿ç”¨çš„æ˜¯å†…ç½®å‡½æ•° <code>pow()</code> æ¥æ‰§è¡ŒæŒ‡æ•°è¿ç®—å’Œæ¨¡è®¡ç®—ã€‚</li></ul><p><code>gmpy2.iroot(x, n)</code></p><ul><li>å…¶ä¸­ï¼Œ<code>x</code> æ˜¯å¾…è®¡ç®—æ ¹å·çš„æ•´æ•°ï¼Œ<code>n</code> æ˜¯æ ¹å·ç±»å‹çš„æ•´æ•°å€¼ã€‚<code>irrotï¼ˆc,eï¼‰</code>è¡¨ç¤º å¯¹cå¼€eæ¬¡æ ¹å·ï¼Œ</li><li>å¦‚æœ <code>x</code> çš„æ ¹å·ä¸ºæ•´æ•°ï¼Œå‡½æ•°å°†è¿”å›ä¸€ä¸ª<strong>å…ƒç»„ï¼ˆtupleï¼‰</strong>ï¼Œè¿”å›å€¼ä¸º<code>(mpz(2), False)</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¿”å›çš„ç»“æœï¼Œ<code>mpz</code>ä¸º<code>gmpy2</code>åŒ…ä¸­å¯¹æ•´æ•°çš„å°è£…ç±»ï¼Œçœ‹ä½œä¸€ä¸ªæ•´æ•°å³å¯ï¼›ç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨è¿™ä¸ªæ•°æ˜¯å¦èƒ½è¢«å®Œå…¨å¼€eæ¬¡æ–¹ï¼Œtrueè¡¨ç¤ºèƒ½ã€‚</li><li>ä¾‹å¦‚10å¼€3æ¬¡æ–¹å¹¶ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½†<code>gmpy2</code>åªä¼šè¿”å›å–æ•´åçš„æ•´æ•°å€¼ï¼Œæ•…é€šè¿‡ç¬¬äºŒé¡¹æˆ‘ä»¬èƒ½å¤ŸçŸ¥é“æ˜¯å¦ä¸ºå®Œå…¨kæ¬¡æ–¹æ•°ã€‚</li><li>ä¾‹å¦‚<code>iroot(9, 2)</code>è¿”å›<code>(mpz(3), True)</code>ä»£è¡¨9æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ã€‚</li><li>å¦‚æœæƒ³è·å¾—æ ¹å·çš„æ•´æ•°å€¼ï¼Œå¯ä»¥é€šè¿‡è®¿é—®å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ¥å®ç°ï¼Œä¾‹å¦‚ï¼š<ul><li><code>m1 = gmpy2.iroot(m, 2)[0]</code></li><li><code>print(long_to_bytes(m[0]))</code></li></ul></li><li>ä¹Ÿèƒ½ç›´æ¥èµ‹å€¼çš„æ—¶å€™å°±èµ‹ç»™ä¸¤ä¸ªå˜é‡ï¼Œè¿™é‡Œaå°±æ˜¯å–å¹³æ–¹æ ¹åçš„æ•´æ•°å€¼<ul><li><code>a, b = gmpy2.iroot(m,2)</code></li></ul></li></ul><p><code>.\yafu-x64.exe &quot;factor(@)&quot; -batchfile 1.txt</code></p><ul><li>åˆ†è§£1.txtä¸­çš„æ•´æ•°</li></ul><p><code>ciphey -t &quot;4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35&quot;</code></p><hr><hr><p>ç¬¬ä¸€ä¸ªRSAï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-img1694707420490.png" alt="1694707420490"></p><p>é‚£å°±äº†è§£ä¸€ä¸‹RSAæ˜¯ä»€ä¹ˆå§ï¼Œå˜»å˜»ğŸ˜</p><p>ä¸€ä¸ªç®€å•çš„ä»‹ç»è§†é¢‘<a href="https://www.bilibili.com/video/av73858330/?vd_source=39f0a6c7a4d98748bb31fcf1e1a3ab7f">RSA ç®—æ³•åŸºæœ¬åŸç†_å“”å“©å“”å“©_bilibili</a></p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p><ul><li><p>AæŠŠä¸€ä¸ªå…¬é’¥(e,N)ç»™Bï¼ŒBæŠŠæƒ³å‘ç»™Açš„ä¿¡æ¯ m ç”¨(e,N)åŠ å¯†æˆ c åå‘ç»™Aï¼ŒAæœ‰ä¸ªç§é’¥(d,N)ï¼Œç”¨ç§é’¥è§£å¯†å³å¯ï¼Œè¿™é‡Œçš„ d åªæœ‰AæŒæ¡ï¼Œåˆ«äººå¾ˆéš¾çŸ¥é“ï¼ˆæ¶‰åŠå¤§æ•´æ•°åˆ†è§£é—®é¢˜ï¼‰ï¼Œæ‰€ä»¥æ–¹æ¡ˆå®‰å…¨ã€‚</p></li><li><p>å°±æ˜¯ä¿è¯äº†ä¿¡æ¯åŠ å¯†æ˜¯å®¹æ˜“çš„ï¼Œè€Œåå‘è§£å¯†æ˜¯å›°éš¾çš„</p></li><li><p>è¿‡ç¨‹å†ç¨å¾®ç¨å¾®è¯¦ç»†ä¸€ç‚¹å°±æ˜¯ï¼š</p><ul><li>é€‰ä¸¤ä¸ªå¤§è´¨æ•°på’Œqï¼Œä¸”p!&#x3D;qï¼Œè®¡ç®—N&#x3D;p*qï¼ŒNå°±ç®—å‡ºæ¥äº†</li><li>ç„¶åè®¡ç®—Nçš„æ¬§æ‹‰å‡½æ•° Ï†(N)&#x3D;(p-1)(q-1)</li><li>ç„¶åä½ è‡ªå·±é€‰ä¸ªeï¼Œ 1&lt;e&lt;Ï†(N)ï¼Œä¸”ä¸Ï†(N)äº’è´¨ï¼Œ</li><li>ç”±eå’ŒÏ†(N)äº’è´¨ï¼Œ(e,Ï†(N))&#x3D;1ï¼Œå†ç”±è¾—è½¬ç›¸é™¤æ³•ï¼Œåˆ™ä¸€å®šæœ‰ed - Ï†(N)k &#x3D; 1</li><li>é‚£ä¹ˆç”±eå°±å¯ä»¥ç®—å‡ºdï¼Œå¦‚ä¸‹å›¾ï¼ˆä¸‹å›¾ä¸­çš„p1ï¼Œp2å°±æ˜¯pï¼Œqï¼‰</li><li><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230915000454756.png" alt="image-20230915000454756"></li><li>enmmmmï¼Œå°±æ˜¯è¿™æ ·ğŸŒ</li></ul></li></ul><p>ä¸‹é¢æ˜¯è§†é¢‘é‡Œé¢çš„ä¸€ä¸ªå°å®ä¾‹ï¼Œå¸®åŠ©ç†è§£</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230915001215482.png" alt="image-20230915001215482"></p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230915001234755.png" alt="image-20230915001234755"></p><p>è™½ç„¶æœ‰äº›åŸç†è¿˜ä¸å¤ªæ¸…æ¥šï¼Œä½†å­¦åˆ°ç°åœ¨è¿™é¢˜åŸºæœ¬å°±èƒ½è§£å†³äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2   <span class="hljs-comment">#ä¸€ä¸ªåº“ï¼Œå°±æ˜¯èƒ½ç®—å¾ˆå¤šæ•°å­¦è¿ç®—çš„ </span><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5  <span class="hljs-comment">#hashlib æ¨¡å—æ˜¯ Python ä¸­ç”¨äºè¿›è¡Œå“ˆå¸Œè®¡ç®—çš„æ ‡å‡†åº“æ¨¡å—ä¹‹ä¸€ã€‚è¿™é‡Œä½¿ç”¨äº† md5 å“ˆå¸Œç®—æ³•ï¼Œè¿™æ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œé€šå¸¸ç”¨äºç”Ÿæˆæ•°æ®çš„ MD5 å“ˆå¸Œå€¼ã€‚</span><br><br>p = <span class="hljs-number">1325465431</span><br>q = <span class="hljs-number">152317153</span><br>e = <span class="hljs-number">65537</span><br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = gmpy2.invert(e, phi)  <span class="hljs-comment">#éå¸¸çš„å…³é”®â¤ï¼Œè¯¥å‡½æ•°è®¡ç®—äº†ä¸€ä¸ªæ•´æ•° e çš„æ¨¡é€†ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ•´æ•° dï¼Œä½¿å¾— (d * e) % phi = 1 æˆç«‹ã€‚%è¡¨ç¤ºå–ä½™æ“ä½œ</span><br><br>flag = md5(<span class="hljs-built_in">str</span>(d).encode())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag is : NSSCTF&#123;%s&#125;&quot;</span>%flag.hexdigest())<br><br></code></pre></td></tr></table></figure><p>flag is : NSSCTF{08bb8fb628da85923e5734a75ac19ffe}</p><blockquote><p> \quad æ•°å­¦å…¬å¼é‡Œé¢çš„ç©ºæ ¼</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>CTF-Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
      <tag>RSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF-Cryptoï¼ˆ1~15ï¼‰</title>
    <link href="/2023/09/09/NSSCTF-Crypto%EF%BC%881~15%EF%BC%89/"/>
    <url>/2023/09/09/NSSCTF-Crypto%EF%BC%881~15%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>ã€Šä»0å¼€å§‹çš„å¯†ç å­¦ä¸–ç•Œç”Ÿæ´»ã€‹ğŸ˜‹æ…¢æ…¢å­¦å¯†ç æ–¹å‘</p><p>æœ‰ä¸¤ä¸ªæœ‰å„ç§åŠ è§£å¯†çš„ç½‘ç«™</p><p><a href="http://www.hiencode.com/">åœ¨çº¿å·¥å…·</a></p><p><a href="https://ctf.bugku.com/tools">Bugku CTF</a></p><h2 id="é¹¤åŸæ¯-2021-easy-crypto"><a href="#é¹¤åŸæ¯-2021-easy-crypto" class="headerlink" title="[é¹¤åŸæ¯ 2021]easy_crypto"></a>[é¹¤åŸæ¯ 2021]easy_crypto</h2><p>è§£å‹åæ–‡ä»¶å†…å®¹æ˜¯ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼ŒæŸ¥äº†ä¸€ä¸‹ç«Ÿç„¶æœ‰<strong>æ ¸å¿ƒä»·å€¼è§‚ç¼–ç </strong>ï¼Œæœ‰ç‚¹é€†å¤©ï¼Œé‚£å°±ç›´æ¥ç”¨å·¥å…·è§£ç å³å¯ã€‚</p><p>ä¸‹é¢è´´ä¸Šä¸¤ä¸ªç½‘ç«™</p><p><a href="http://www.hiencode.com/cvencode.html">æ ¸å¿ƒä»·å€¼è§‚ç¼–ç -åŠ è§£å¯†1</a></p><p><a href="https://ctf.bugku.com/tool/cvecode">æ ¸å¿ƒä»·å€¼è§‚ç¼–ç -åŠ è§£å¯†2</a></p><hr><h2 id="å¼ºç½‘æ‹Ÿæ€-2021-æ‹Ÿæ€ç­¾åˆ°é¢˜"><a href="#å¼ºç½‘æ‹Ÿæ€-2021-æ‹Ÿæ€ç­¾åˆ°é¢˜" class="headerlink" title="[å¼ºç½‘æ‹Ÿæ€ 2021]æ‹Ÿæ€ç­¾åˆ°é¢˜"></a>[å¼ºç½‘æ‹Ÿæ€ 2021]æ‹Ÿæ€ç­¾åˆ°é¢˜</h2><p>æ‰“å¼€txtæ–‡ä»¶ï¼Œå‘ç°çœ‹ä¸æ‡‚ï¼Œè¿™ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p><p><a href="https://freeimage.host/i/J95ihaR"><img src="https://iili.io/J95ihaR.md.png" alt="2309061"></a></p><p>GPTä¸€ä¸‹</p><p><a href="https://freeimage.host/i/J9YVHSj"><img src="https://iili.io/J9YVHSj.md.png" alt="2309062"></a></p><p>GPTå€’æ˜¯ä¸€çœ¼çœ‹å‡ºæ¥äº†ï¼Œbase64ç¼–ç ï¼Œç›´æ¥è§£ç å³å¯ï¼Œä»ç„¶ä¸Šé¢çš„ä¸¤ä¸ªç½‘ç«™ä»»æ„ä¸€ä¸ªå³å¯</p><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto8"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto8" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto8"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto8</h2><p>æ‰“å¼€txtååˆæ˜¯ä¸€æ®µä¹±ç ï¼š73E-30U1&amp;&gt;V-H965S95]I&lt;U]P;W&#x3D;E&lt;GT&#96;</p><p>æ ¹æ®é¢˜ç›®ä¸Šé¢çš„æ ‡ç­¾æç¤ºï¼Œæ¨æµ‹æ˜¯UUencodeåŠ å¯†</p><p>ç”¨å·¥å…·è§£å¯†å³å¯</p><p>NSSCTF{cheese_is_power}</p><blockquote><p><strong>æœ‰ä¸ªå°é—®é¢˜å“ˆï¼Œè¿™äº›ç¼–ç çš„å…·ä½“å®ç°æ–¹å¼æˆ‘ä»¬ä¸ç”¨å…·ä½“äº†è§£å—éš¾é“ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ï¼Œç›´æ¥ç”¨å·¥å…·å°±è¡Œäº†å—ï¼Ÿ</strong></p></blockquote><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto7"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto7" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto7"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto7</h2><p>æ‰“å¼€txtï¼ŒåŸæ–‡å¦‚ä¸‹</p><p><code>69f7906323b4f7d1e4e972acf4abfbfc,å¾—åˆ°çš„ç»“æœç”¨NSSCTF&#123;&#125;åŒ…è£¹ã€‚</code></p><p>æ ¹æ®æ ‡ç­¾ï¼Œå‘ç°æ˜¯MD5åŠ å¯†</p><p>ç›´æ¥è§£å¯†å³å¯ï¼Œ<a href="https://www.cmd5.com/">MD5è§£å¯†</a></p><p>NSSCTF{md5yyds}</p><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto6"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto6" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto6"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto6</h2><p>æ‰“å¼€txtï¼ŒåŸæ–‡å¦‚ä¸‹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">var=<span class="hljs-string">&quot;************************************&quot;</span><br>flag=<span class="hljs-string">&#x27;NSSCTF&#123;&#x27;</span> + base64<span class="hljs-selector-class">.b16encode</span>(base64<span class="hljs-selector-class">.b32encode</span>(base64<span class="hljs-selector-class">.b64encode</span>(<span class="hljs-selector-tag">var</span><span class="hljs-selector-class">.encode</span>()))) + <span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(flag)</span></span><br><br>å°æ˜ä¸å°å¿ƒæ³„éœ²äº†æºç ï¼Œè¾“å‡ºç»“æœä¸ºï¼š<span class="hljs-number">4</span>A5A4C564B36434E4B5241544B5432454E4E32465552324E47424758534D44594C4657564336534D4B5241584F574C4B4B463245365643424F35485649534C584A5A56454B4D4B5049354E47593D3D3Dï¼Œä½ èƒ½è¿˜åŸå‡ºvarçš„æ­£ç¡®ç»“æœå—ï¼Ÿ<br></code></pre></td></tr></table></figure><ul><li>å¯ä»¥çœ‹å‡ºåŠ å¯†æ˜¯å…ˆbase64ï¼Œå†base32ï¼Œå†base16</li><li>æ‰€ä»¥è§£å¯†æˆ‘ä»¬å°±å…ˆåè¿‡æ¥å³å¯ï¼Œ16 â†’ 32 â†’ 64ï¼Œç”¨ä¸Šé¢çš„è§£å¯†ç½‘ç«™</li><li>å¾—åˆ°5e110989-dc43-1bd3-00b4-9009206158fe</li><li>æ‰€ä»¥flagä¸ºNSSCTF{5e110989-dc43-1bd3-00b4-9009206158fe}</li></ul><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-ez-caesar"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-ez-caesar" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_caesar"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_caesar</h2><p>æ‰“å¼€åæ˜¯ä¸€ä¸ª.pyæ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">caesar</span>(<span class="hljs-params">plaintext</span>):<br>    str_list = <span class="hljs-built_in">list</span>(plaintext)<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(plaintext):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> str_list[i].isalpha():<br>            str_list[i] = str_list[i]<br>        <span class="hljs-keyword">else</span>:<br>            a = <span class="hljs-string">&quot;A&quot;</span> <span class="hljs-keyword">if</span> str_list[i].isupper() <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;a&quot;</span><br>            str_list[i] = <span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(str_list[i]) - <span class="hljs-built_in">ord</span>(a) + <span class="hljs-number">5</span>) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(a) <span class="hljs-keyword">or</span> <span class="hljs-number">5</span>)<br>        i = i + <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(str_list)<br><br>flag = <span class="hljs-string">&quot;*************************&quot;</span><br><span class="hljs-built_in">str</span> = caesar(flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>)<br><br><span class="hljs-comment">#str=&quot;U1hYSFlLe2R0em1mYWpwc3RiaGZqeGZ3fQ==&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™ï¼Œæœ‰ç‚¹çœ‹ä¸æ‡‚ï¼ŒGPTä¸€ä¸‹å§ï¼Œä¸‹é¢æ˜¯GPTçš„è§£é‡Š</p><blockquote><p>è¿™æ®µä»£ç é¦–å…ˆå¯¼å…¥äº†base64æ¨¡å—ï¼Œç„¶åå®šä¹‰äº†ä¸€ä¸ªåä¸ºcaesarçš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªæ˜æ–‡å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›åŠ å¯†åçš„å­—ç¬¦ä¸²ã€‚<br>åœ¨å‡½æ•°å†…éƒ¨ï¼Œé¦–å…ˆå°†æ˜æ–‡å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—ç¬¦åˆ—è¡¨str_listï¼Œç„¶åä½¿ç”¨whileå¾ªç¯éå†æ˜æ–‡å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ã€‚<br>åœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰å­—ç¬¦æ˜¯å¦ä¸ºå­—æ¯ã€‚å¦‚æœä¸æ˜¯å­—æ¯ï¼Œåˆ™å°†å­—ç¬¦ä¿æŒä¸å˜ã€‚å¦‚æœæ˜¯å­—æ¯ï¼Œåˆ™æ ¹æ®å­—æ¯çš„å¤§å°å†™ç¡®å®šå­—æ¯è¡¨çš„èµ·å§‹ä½ç½®ï¼ˆå¤§å†™å­—æ¯ä»â€™Aâ€™å¼€å§‹ï¼Œå°å†™å­—æ¯ä»â€™aâ€™å¼€å§‹ï¼‰ï¼Œç„¶åä½¿ç”¨å‡¯æ’’å¯†ç çš„è§„åˆ™å¯¹å­—æ¯è¿›è¡Œæ›¿æ¢ã€‚æ›¿æ¢çš„è§„åˆ™æ˜¯å°†å­—æ¯çš„Unicodeç å‡å»èµ·å§‹ä½ç½®çš„Unicodeç ï¼Œå†åŠ ä¸Šä¸€ä¸ªå›ºå®šçš„ä½ç§»é‡5ï¼Œç„¶åå¯¹26å–æ¨¡ï¼Œæœ€åå†åŠ ä¸Šèµ·å§‹ä½ç½®çš„Unicodeç æˆ–è€…5ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿æ›¿æ¢åçš„å­—ç¬¦ä»ç„¶æ˜¯ä¸€ä¸ªå­—æ¯ã€‚<br>å¾ªç¯ç»“æŸåï¼Œå°†å­—ç¬¦åˆ—è¡¨è½¬æ¢å›å­—ç¬¦ä¸²ï¼Œå¹¶å°†åŠ å¯†åçš„å­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ã€‚<br>æœ€åä¸€è¡Œçš„æ³¨é‡Šæ‰çš„ä»£ç æ˜¯ä¸€ä¸ªç»è¿‡base64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥åœ¨éœ€è¦æ—¶å°†å…¶è§£ç ã€‚</p></blockquote><p>é‚£æˆ‘å°±æ‡‚äº†ï¼Œå˜»å˜»</p><ul><li>å‡¯æ’’å¯†ç ï¼ˆCaesar cipherï¼‰ï¼ŒåŸæ¥å°±æ˜¯å‡¯æ’’å¯†ç </li><li>æœ€åä¸€è¡Œæ³¨é‡Šæ‰çš„æ˜¯base64ç¼–ç åçš„ç»“æœ</li><li>é‚£æˆ‘ä»¬å°±å…ˆbase64è§£ç ï¼Œå†å‡¯æ’’è§£ç åº”è¯¥å°±è¡Œ</li><li>æ³¨æ„å‡¯æ’’è§£ç è¿˜éœ€è¦ä¸€ä¸ªåç§»é‡ï¼Œè¿™é‡Œçš„åç§»é‡å°±æ˜¯5</li><li>æœ€åå¾—åˆ° NSSCTF{youhaveknowcaesar}</li></ul><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto10"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-crypto10" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto10"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]crypto10</h2><p>txtä¸­çš„å†…å®¹ä¸ºï¼š<code>AFFPGS&#123;pbatenghyngvbaf!!!&#125;,å»ºè®®ç›´æ¥ç§’äº†</code></p><p>è§‚å¯Ÿæ ‡ç­¾å¯ä»¥çœ‹å‡ºæ˜¯ä¸ªä»€ä¹ˆROTåŠ å¯†ï¼Œç›´æ¥æœå·¥å…·è§£å¯†å³å¯</p><p>NSSCTF{congratulations!!!}</p><hr><h2 id="é¹¤åŸæ¯-2021-A-CRYPTO"><a href="#é¹¤åŸæ¯-2021-A-CRYPTO" class="headerlink" title="[é¹¤åŸæ¯ 2021]A_CRYPTO"></a>[é¹¤åŸæ¯ 2021]A_CRYPTO</h2><p>é€†å¤©æ–‡æœ¬ï¼š4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35</p><p>ä»æ­¤çŸ¥é“äº†<strong>ciphey</strong>çš„å­˜åœ¨ï¼Œå‡†å¤‡é…ç½®å•Šå•Šå•Šå•Š</p><p><a href="https://blog.csdn.net/Dome_/article/details/120689591?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169401549316800211566878%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169401549316800211566878&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-120689591-null-null.142%5Ev93%5EchatgptT3_1&utm_term=ciphey&spm=1018.2226.3001.4187">å…¨è‡ªåŠ¨è§£å¯†è§£ç ç¥å™¨ â€” Ciphey</a></p><p><a href="https://blog.csdn.net/ntrybw/article/details/131516319?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169401549316800211566878%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169401549316800211566878&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-7-131516319-null-null.142%5Ev93%5EchatgptT3_1&utm_term=ciphey&spm=1018.2226.3001.4187">Windowså®‰è£…cipheyç¼–ç å·¥å…·ï¼Œç¼–ç å·¥å…·æˆ˜ç¥ï¼Œcryç®€å•é¢˜ç»å¯¹å…‹æ˜Ÿï¼</a></p><p>ä¸çŸ¥é“ä¸ºå•¥ï¼Œå°±å®‰è£…æˆåŠŸäº†ï¼Œä½†æ˜¯åªèƒ½åœ¨windowsä¸‹çš„cmdä¸­ä½¿ç”¨ï¼Œç­‰ä¼šè¿˜è¦åœ¨kalié‡Œé¢å†ä¸‹ä¸€ä¸ª<strong>ciphey</strong></p><p>è§£å¯†å‘½ä»¤ä¸ºï¼š</p><p><code>ciphey -t &quot;4O595954494Q32515046324757595N534R52415653334357474R4N575955544R4O5N4Q46434S4O59474253464Q5N444R4Q51334557524O5N4S424944473542554O595N44534O324R49565746515532464O49345649564O464R4R494543504N35&quot;</code></p><p><img src="https://iili.io/J9lb0js.png" alt="202309071.png"></p><p>æ‰€ä»¥flagä¸ºï¼šâ€NSSCTF{W0w_y0u_c4n_rea11y_enc0d1ng!}â€</p><blockquote><p>0<br>0<br>0<br>ä¸‹é¢çš„ä¸œè¥¿å¯ä»¥å¿½ç•¥ï¼Œ<br>bydé…ç¯å¢ƒé…äº†å°†è¿‘ä¸€ä¸Šåˆéƒ½æ²¡åœ¨kalié‡Œé¢é…å¥½ï¼Œä¸æ˜¯pythonç‰ˆæœ¬é—®é¢˜å°±æ˜¯ä»€ä¹ˆPATHè·¯å¾„é—®é¢˜ï¼Œåˆ°æœ€åä¹Ÿæ²¡è§£å†³ï¼Œè‰ï¼<br>è¿™é‡Œç”±äºç™¾åº¦ç½‘ç›˜ä¸‹è½½çš„å¤ªæ…¢ï¼Œä¸€é¡¿æœç´¢åå‘ç°äº†å…¶ä»–çš„æ–¹æ³•ï¼Œæ€ä¹ˆæ²¡æ—©ç‚¹å‘ç°å•ŠğŸ˜­<br><a href="https://greasyfork.org/zh-CN/scripts/463707-%E5%B0%B1%E6%98%AF%E5%8A%A0%E9%80%9F-%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E6%97%A0%E9%99%90%E9%80%9F%E6%89%B9%E9%87%8F%E4%B8%8B%E8%BD%BD-%E6%94%AF%E6%8C%81%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E8%BD%BD">ä¸å¤šè¯´å¥½å§ï¼Œè¦æ˜¯æœ‰æœ‰ç¼˜äººçœ‹åˆ°ç®—æ˜¯ä½ èµšäº†ğŸ¤­</a><br>ä¸‹é¢å°±æ˜¯kaliä¸­cipheyçš„é…ç½®<br><a href="http://old.kali.org/virtual-images/kali-2021.2/">http://old.kali.org/virtual-images/kali-2021.2/</a><br><a href="https://kali.download/">https://kali.download/</a></p></blockquote><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-pigpig"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-pigpig" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]pigpig"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]pigpig</h2><p>æ ¹æ®æç¤ºæ˜¯ä¸€ä¸ªä»€ä¹ˆçŒªåœˆå¯†ç </p><p><a href="http://www.hiencode.com/pigpen.html">åœ¨çº¿è§£å¯†å³å¯</a></p><p>NSSCTF{whenthepigwanttoeat}</p><p>ä»€ä¹ˆæ—¶å€™ğŸ–æƒ³åƒï¼ŸğŸ·</p><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-ez-rsa"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-ez-rsa" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_rsa"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]ez_rsa</h2><p>æ‰“å¼€txtå†…å®¹å¦‚ä¸‹ï¼Œæœäº†ä¸€ä¸‹ç¡®å®æ˜¯æœ€æœ€åŸºç¡€çš„RSAï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230908233108248.png" alt="image-20230908233108248"></p><p>é‚£å°±äº†è§£ä¸€ä¸‹RSAæ˜¯ä»€ä¹ˆå§ï¼Œå˜»å˜»ğŸ˜</p><p>ä¸€ä¸ªç®€å•çš„ä»‹ç»è§†é¢‘<a href="https://www.bilibili.com/video/av73858330/?vd_source=39f0a6c7a4d98748bb31fcf1e1a3ab7f">RSA ç®—æ³•åŸºæœ¬åŸç†_å“”å“©å“”å“©_bilibili</a></p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p><ul><li><p>AæŠŠä¸€ä¸ªå…¬é’¥(e,N)ç»™Bï¼ŒBæŠŠæƒ³å‘ç»™Açš„ä¿¡æ¯ m ç”¨(e,N)åŠ å¯†æˆ c åå‘ç»™Aï¼ŒAæœ‰ä¸ªç§é’¥(d,N)ï¼Œç”¨ç§é’¥è§£å¯†å³å¯ï¼Œè¿™é‡Œçš„ d åªæœ‰AæŒæ¡ï¼Œåˆ«äººå¾ˆéš¾çŸ¥é“ï¼ˆæ¶‰åŠå¤§æ•´æ•°åˆ†è§£é—®é¢˜ï¼‰ï¼Œæ‰€ä»¥æ–¹æ¡ˆå®‰å…¨ã€‚</p></li><li><p>å°±æ˜¯ä¿è¯äº†ä¿¡æ¯åŠ å¯†æ˜¯å®¹æ˜“çš„ï¼Œè€Œåå‘è§£å¯†æ˜¯å›°éš¾çš„</p></li><li><p>è¿‡ç¨‹å†ç¨å¾®ç¨å¾®è¯¦ç»†ä¸€ç‚¹å°±æ˜¯ï¼š</p><ul><li>é€‰ä¸¤ä¸ªå¤§è´¨æ•°på’Œqï¼Œä¸”p!&#x3D;qï¼Œè®¡ç®—N&#x3D;p*qï¼ŒNå°±ç®—å‡ºæ¥äº†</li><li>ç„¶åè®¡ç®—Nçš„æ¬§æ‹‰å‡½æ•° Ï†(N)&#x3D;(p-1)(q-1)</li><li>ç„¶åä½ è‡ªå·±é€‰ä¸ªeï¼Œ 1&lt;e&lt;Ï†(N)ï¼Œä¸”ä¸Ï†(N)äº’è´¨ï¼Œ</li><li>ç”±eå’ŒÏ†(N)äº’è´¨ï¼Œ(e,Ï†(N))&#x3D;1ï¼Œå†ç”±è¾—è½¬ç›¸é™¤æ³•ï¼Œåˆ™ä¸€å®šæœ‰ed - Ï†(N)k &#x3D; 1</li><li>é‚£ä¹ˆç”±eå°±å¯ä»¥ç®—å‡ºdï¼Œå¦‚ä¸‹å›¾ï¼ˆä¸‹å›¾ä¸­çš„p1ï¼Œp2å°±æ˜¯pï¼Œqï¼‰</li><li><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230908235228225.png" alt="image-20230908235228225"></li><li>enmmmmï¼Œå°±æ˜¯è¿™æ ·ğŸŒ</li></ul></li></ul><p>ä¸‹é¢æ˜¯è§†é¢‘é‡Œé¢çš„ä¸€ä¸ªå°å®ä¾‹ï¼Œå¸®åŠ©ç†è§£</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230908233527952.png" alt="image-20230908233527952"></p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230908234751944.png" alt="image-20230908234751944"></p><p>è™½ç„¶æœ‰äº›åŸç†è¿˜ä¸å¤ªæ¸…æ¥šï¼Œä½†å­¦åˆ°ç°åœ¨è¿™é¢˜åŸºæœ¬å°±èƒ½è§£å†³äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2   <span class="hljs-comment">#ä¸€ä¸ªåº“ï¼Œå°±æ˜¯èƒ½ç®—å¾ˆå¤šæ•°å­¦è¿ç®—çš„ </span><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5  <span class="hljs-comment">#hashlib æ¨¡å—æ˜¯ Python ä¸­ç”¨äºè¿›è¡Œå“ˆå¸Œè®¡ç®—çš„æ ‡å‡†åº“æ¨¡å—ä¹‹ä¸€ã€‚è¿™é‡Œä½¿ç”¨äº† md5 å“ˆå¸Œç®—æ³•ï¼Œè¿™æ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œé€šå¸¸ç”¨äºç”Ÿæˆæ•°æ®çš„ MD5 å“ˆå¸Œå€¼ã€‚</span><br><br>p = <span class="hljs-number">1325465431</span><br>q = <span class="hljs-number">152317153</span><br>e = <span class="hljs-number">65537</span><br><br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br><br>d = gmpy2.invert(e, phi)  <span class="hljs-comment">#éå¸¸çš„å…³é”®â¤ï¼Œè¯¥å‡½æ•°è®¡ç®—äº†ä¸€ä¸ªæ•´æ•° e çš„æ¨¡é€†ï¼Œä¹Ÿå°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ•´æ•° dï¼Œä½¿å¾— (d * e) % phi = 1 æˆç«‹ã€‚%è¡¨ç¤ºå–ä½™æ“ä½œ</span><br><br>flag = md5(<span class="hljs-built_in">str</span>(d).encode())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag is : NSSCTF&#123;%s&#125;&quot;</span>%flag.hexdigest())<br><br></code></pre></td></tr></table></figure><p>flag is : NSSCTF{08bb8fb628da85923e5734a75ac19ffe}</p><hr><h2 id="BJDCTF-2020-base"><a href="#BJDCTF-2020-base" class="headerlink" title="[BJDCTF 2020]base??"></a>[BJDCTF 2020]base??</h2><p>æ‰“å¼€åæ˜¯è¿™ä¸²ä¸œè¥¿</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230909003141021.png" alt="image-20230909003141021"></p><p>ç›´æ¥èµ›åšå¨å­è§£å†³äº†ğŸ˜‚ï¼Œç›¸å½“äºæ¢è¡¨æ“ä½œï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œå†™pythonä»£ç è¿˜æœ‰ç‚¹å¤æ‚ğŸ¤”ï¼Œç­‰ä¼šå†çœ‹ä¸€ä¸‹ï¼ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230909005020849.png" alt="image-20230909005020849"></p><hr><h2 id="SWPUCTF-2021-æ–°ç”Ÿèµ›-traditional"><a href="#SWPUCTF-2021-æ–°ç”Ÿèµ›-traditional" class="headerlink" title="[SWPUCTF 2021 æ–°ç”Ÿèµ›]traditional"></a>[SWPUCTF 2021 æ–°ç”Ÿèµ›]traditional</h2><p>æ‰“å¼€åæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œä¸æ‡‚ï¼Œæ˜å¤©å†çœ‹å§ï¼Œbydå·²ç»1ç‚¹åŠ›ï¼Œè¿˜æ²¡åˆ·ç‰™ğŸ˜­</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230909010611371.png" alt="image-20230909010611371"></p>]]></content>
    
    
    <categories>
      
      <category>CTF-Crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
      <tag>NSSCTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ±‚è§£1Â²+2Â²+3Â²+â€¦â€¦+nÂ²</title>
    <link href="/2023/09/05/%E6%B1%82%E8%A7%A31%C2%B2+2%C2%B2+3%C2%B2+%E2%80%A6%E2%80%A6+n%C2%B2/"/>
    <url>/2023/09/05/%E6%B1%82%E8%A7%A31%C2%B2+2%C2%B2+3%C2%B2+%E2%80%A6%E2%80%A6+n%C2%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ç§ç®€å•çš„æ–¹æ³•"><a href="#ä¸€ç§ç®€å•çš„æ–¹æ³•" class="headerlink" title="ä¸€ç§ç®€å•çš„æ–¹æ³•"></a>ä¸€ç§ç®€å•çš„æ–¹æ³•</h2><p>åœ¨åšæ•°æ®ç»“æ„ç¬¬ä¸€ç« çš„ä¹ é¢˜æ—¶é‡è§è¿™ä¸ªé—®é¢˜ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ„æ€ï¼Œå°±å†™äº†ä¸‹æ¥</p><p>è¿™ç§æ–¹æ³•æŠŠ1Â²+2Â²+3Â²+â€¦â€¦+nÂ²å†™æˆä¸‰ä¸ªå¼å­ï¼Œç›¸åŠ é™¤ä»¥3å¾—åˆ°ç»“æœï¼Œå¦‚ä¸‹ï¼š</p><p>1</p><p>2 2</p><p>3 3 3</p><p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</p><p>n n â€¦â€¦â€¦â€¦â€¦..n n  â‘ </p><hr><p>n</p><p>â€¦â€¦â€¦â€¦..n</p><p>3 â€¦â€¦â€¦â€¦â€¦â€¦.n</p><p>2 3 â€¦â€¦ â€¦â€¦â€¦..n</p><p>1 2 3â€¦â€¦â€¦â€¦â€¦â€¦..n   â‘¡</p><hr><p>n</p><p>n â€¦â€¦â€¦</p><p>n â€¦â€¦â€¦â€¦â€¦â€¦ 3</p><p>n â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦..3 2</p><p>n â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.3 2 1  â‘¢</p><p>è¿™ä¸‰ä¸ªå¼å­éƒ½è¡¨ç¤º1Â²+2Â²+3Â²+â€¦â€¦+nÂ²ï¼ŒæŠŠä»–ä»¬ç›¸åŠ </p><p>â‘ +â‘¡+â‘¢å¾—</p><p>2n+1</p><p>2n+1 2n+1</p><p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</p><p>2n+1 2n+1 2n+1â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦2n+1 2n+1 2n+1   â‘ +â‘¡+â‘¢</p><p>3 âˆ‘nÂ² &#x3D; n(n+1)(2n+1)&#x2F;2</p><p>æ•… 1Â²+2Â²+Â·Â·Â·Â·Â·Â·+nÂ² &#x3D; nï¼ˆn+1ï¼‰ï¼ˆ2n+1ï¼‰&#x2F;6</p>]]></content>
    
    
    <categories>
      
      <category>æ•°å­¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å„ç§è½¯ä»¶å®‰è£…ï¼Œç¯å¢ƒé…ç½®</title>
    <link href="/2023/09/03/%E5%90%84%E7%A7%8D%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%EF%BC%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <url>/2023/09/03/%E5%90%84%E7%A7%8D%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%EF%BC%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h3 id="åœ¨VScodeä¸­é…ç½®Pythonå¼€å‘ç¯å¢ƒ"><a href="#åœ¨VScodeä¸­é…ç½®Pythonå¼€å‘ç¯å¢ƒ" class="headerlink" title="åœ¨VScodeä¸­é…ç½®Pythonå¼€å‘ç¯å¢ƒ"></a>åœ¨VScodeä¸­é…ç½®Pythonå¼€å‘ç¯å¢ƒ</h3><p><a href="https://blog.csdn.net/weixin_43737995/article/details/125690015?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169362300616800182129289%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169362300616800182129289&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125690015-null-null.142%5Ev93%5EchatgptT3_1&utm_term=vscode%20python%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE&spm=1018.2226.3001.4187">åœ¨VScodeä¸­é…ç½®Pythonå¼€å‘ç¯å¢ƒ</a></p><h3 id="Gitå®‰è£…"><a href="#Gitå®‰è£…" class="headerlink" title="Gitå®‰è£…"></a>Gitå®‰è£…</h3><p><a href="https://blog.csdn.net/mukes/article/details/115693833?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169205886716800188579548%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169205886716800188579548&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-115693833-null-null.142%5Ev92%5EchatgptT0_1&utm_term=git%E5%AE%89%E8%A3%85&spm=1018.2226.3001.4187">Git è¯¦ç»†å®‰è£…æ•™ç¨‹</a></p><h3 id="JAVAå®‰è£…"><a href="#JAVAå®‰è£…" class="headerlink" title="JAVAå®‰è£…"></a>JAVAå®‰è£…</h3><p><a href="https://blog.csdn.net/qq_48988285/article/details/125593715?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169396267216800182147901%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169396267216800182147901&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-125593715-null-null.142%5Ev93%5EchatgptT3_1&utm_term=java%E5%AE%89%E8%A3%85&spm=1018.2226.3001.4187">è¶…è¯¦ç»†Javaå®‰è£…æ•™ç¨‹ï¼Œå°ç™½é€Ÿæ¥ï¼ï¼ï¼</a></p><h3 id="Dev-C-å®‰è£…"><a href="#Dev-C-å®‰è£…" class="headerlink" title="Dev C++å®‰è£…"></a>Dev C++å®‰è£…</h3><p><a href="https://blog.csdn.net/m0_54158068/article/details/124080083?ops_request_misc=%7B%22request_id%22:%22169519422116800213087590%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=169519422116800213087590&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-124080083-null-null.142%5Ev94%5EchatsearchT3_1&utm_term=devc++&spm=1018.2226.3001.4187">DevC++ è½¯ä»¶ä¸‹è½½åŠå®‰è£…æ•™ç¨‹ï¼ˆè¯¦ç»†ã€å…·ä½“ï¼‰_devc++ä¸‹è½½_ç­‰æ—¥å‡ºçœ‹å½©è™¹çš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hexoå»ºç«™è¿‡ç¨‹</title>
    <link href="/2023/08/16/hexo%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B/"/>
    <url>/2023/08/16/hexo%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<p>bç«™yydsï¼ï¼ï¼</p><p><a href="https://www.bilibili.com/video/BV1Eg41157tL/?spm_id_from=333.337.search-card.all.click&vd_source=445ce756d899a4cef51cfb6b148ba121">hexoåŠ GitHubæ­å»ºç½‘ç«™æ•™ç¨‹</a></p><p>è¯„è®ºåŒºçš„æ­å»ºæ„Ÿè°¢å¤§ä½¬çš„åšå®¢<a href="https://ltyzzzxxx.github.io/2022/10/05/Hexo%E4%BB%8E0%E5%88%B01%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E7%B3%BB%E5%88%9703%EF%BC%9A%E6%96%87%E7%AB%A0%E4%B8%8E%E8%AF%84%E8%AE%BA%E6%A8%A1%E5%9D%97/">å‘¨ä¸‰ä¸Coding</a></p><p>å›¾åºŠçš„æ­å»ºæš‚æ—¶æ„Ÿè°¢[æ­å»ºå…è´¹å›¾åºŠâ€”â€”github+picGo+jsdelivr_githubå›¾åºŠtokenè·å–_chunisçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/Godlichangwu/article/details/127331738?ops_request_misc=%7B%22request_id%22:%22169417712716800197059093%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=169417712716800197059093&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-127331738-null-null.142%5Ev93%5EchatgptT3_1&utm_term=Github%E4%BB%93%E5%BA%93">https://blog.csdn.net/Godlichangwu/article/details/127331738?ops_request_misc=%7B%22request%5Fid%22%3A%22169417712716800197059093%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=169417712716800197059093&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-127331738-null-null.142^v93^chatgptT3_1&amp;utm_term=Githubä»“åº“</a> %2B Picgo &amp;spm&#x3D;1018.2226.3001.4187)</p><hr><hr><p><strong>ä¸‹é¢æ˜¯é‡åˆ°çš„ä¸€äº›é—®é¢˜</strong></p><h2 id="hexo-d-æ€»æ˜¯æŠ¥é”™"><a href="#hexo-d-æ€»æ˜¯æŠ¥é”™" class="headerlink" title="hexo d æ€»æ˜¯æŠ¥é”™"></a><code>hexo d</code> æ€»æ˜¯æŠ¥é”™</h2><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">Error: </span>Spawn failed<br>è¿™é”™è¯¯çƒ¦æ­»äººï¼Œä¸€ç›´æŠ¥<br></code></pre></td></tr></table></figure><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ul><li>é‡æ–°é…ç½®ä¸€ä¸‹SSHï¼ŒæŠŠä¸‹é¢çš„<strong>write</strong>é‚£ä¸ªé€‰é¡¹ç»™å®ƒå‹¾ä¸Šï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</li><li>ä¸çŸ¥é“ä¸ºå•¥ï¼Œä¸‹é¢ç«Ÿç„¶è¿˜æœ‰ä¸ªé€‰é¡¹ï¼Œä¸å‹¾ä¸Šçš„è¯å°±æ˜¯read onlyï¼Œç„¶åå°±ä¼šä¸€ç›´æŠ¥é‚£ä¸ªé”™è¯¯ğŸ˜¡ğŸ˜¡</li></ul><h2 id="bash-hexo-command-not-found"><a href="#bash-hexo-command-not-found" class="headerlink" title="bash: hexo: command not found"></a><code>bash: hexo: command not found</code></h2><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>å°†<code>D:\blog\myblog\node_modules\.bin</code>,æ·»åŠ åˆ°Pathä¸­</p><h2 id="é”™è¯¯å¦‚ä¸‹"><a href="#é”™è¯¯å¦‚ä¸‹" class="headerlink" title="é”™è¯¯å¦‚ä¸‹"></a>é”™è¯¯å¦‚ä¸‹</h2><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs subunit">ssh: Could not resolve hostname github.com: Name or service not known<br>fatal: Could not read from remote repository.<br><br>Please make sure you have the correct access rights<br>and the repository exists.<br>FATAL Something&#x27;s wrong. Maybe you can find the solution here: https://hexo.io/d<br>ocs/troubleshooting.html<br><span class="hljs-keyword">Error: </span>Spawn failed<br>    at ChildProcess.&lt;anonymous&gt; (D:\blog\myblog\node_modules\hexo-util\lib\spawn<br>.js:51:21)<br>    at ChildProcess.emit (node:events:514:28)<br>    at cp.emit (D:\blog\myblog\node_modules\cross-spawn\lib\enoent.js:34:29)<br>    at ChildProcess._handle.onexit (node:internal/child_process:291:12)<br>    <br></code></pre></td></tr></table></figure><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼Œå¯èƒ½æ˜¯æˆ‘æ€»æ˜¯ç¿»å¢™çš„é—®é¢˜å§ï¼Œä¸å¤ªæ‡‚ï¼Œè‰ï¼Œä¸€ä¼šä¸€ä¸ªé”™è¯¯mdğŸ˜¡</p><h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p><a href="https://blog.csdn.net/li_001/article/details/70245006?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169400980416800225586698%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169400980416800225586698&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-70245006-null-null.142%5Ev93%5EchatgptT3_1&utm_term=ssh:%20Could%20not%20resolve%20hostname%20github.com:%20Name%20or%20service%20not%20known%20fatal:%20Could%20not%20read%20from%20remote%20repository.&spm=1018.2226.3001.4187">CSDNè§£å†³æ–¹æ¡ˆ</a></p><p>æ–¹æ¡ˆä¸€äº²æµ‹æœ‰æ•ˆï¼ŒCSDNyydsï¼ğŸ˜­</p>]]></content>
    
    
    <categories>
      
      <category>åšå®¢</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>åšå®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/08/14/hello-world/"/>
    <url>/2023/08/14/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    <categories>
      
      <category>åšå®¢</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ‹è¯•åšå®¢</title>
    <link href="/2023/08/03/%E6%B5%8B%E8%AF%95%E5%8D%9A%E5%AE%A2/"/>
    <url>/2023/08/03/%E6%B5%8B%E8%AF%95%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p><a href="https://freeimage.host/i/J9YVHSj"><img src="https://iili.io/J9YVHSj.md.png" alt="2309062"></a></p><p><img src="https://freeimage.host/i/J9YVHSj" alt="2309062"></p><p><img src="https://iili.io/J9YVHSj.md.png" alt="2309062"></p><p><img src="http://static.runoob.com/images/runoob-logo.png" alt="RUNOOB å›¾æ ‡" title="RUNOOB"></p><p><del>æ’’æ—¦å“ˆå¸‚é£å£æµªå°–</del></p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œçœ‹èƒ½ä¸èƒ½ç›´æ¥ä¼ å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230908210230931.png" alt="image-20230908210230931"></p><p>çœ‹æ¥ jsDelivr CDNç¡®å®è¢«å¢™äº†ï¼Œé‚£åªèƒ½è¯•ä¸€ä¸‹é˜¿é‡Œäº‘äº†ï¼Œæµ‹</p><p>å“¦ï¼Ÿï¼Ÿè¿™è¿‡äº†å‡ åˆ†é’Ÿï¼ˆ2023.09.08 21:07ï¼‰ï¼Œæ€ä¹ˆåˆè¡Œäº†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/viper2383/blogimages/blog-imgimage-20230908210813336.png" alt="image-20230908210813336"></p><p>è¡Œå§ï¼Œé‚£å…ˆç”¨ç€</p>]]></content>
    
    
    <categories>
      
      <category>åšå®¢</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åšå®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ±‡ç¼–è¯­è¨€å®éªŒ</title>
    <link href="/2023/05/27/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AE%9E%E9%AA%8C/"/>
    <url>/2023/05/27/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%AE%9E%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="loopåŒå±‚å¾ªç¯"><a href="#loopåŒå±‚å¾ªç¯" class="headerlink" title="loopåŒå±‚å¾ªç¯"></a>loopåŒå±‚å¾ªç¯</h2><hr><p><a href="https://freeimage.host/i/H655pWu"><img src="https://iili.io/H655pWu.md.png" alt="H655pWu.md.png"></a></p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">10</span><br><span class="hljs-symbol">        </span><br><span class="hljs-symbol">    s:</span>  <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br><span class="hljs-symbol">        </span><br><span class="hljs-symbol">     b:</span> <span class="hljs-keyword">add</span> <span class="hljs-built_in">dx</span>,<span class="hljs-built_in">cx</span><br>    <br>        <span class="hljs-keyword">loop</span> b<br><br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span>    <br>        <span class="hljs-keyword">loop</span> s  <br><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span> <br><br><br>code ends<br>end start<br><br><br></code></pre></td></tr></table></figure><ul><li>ä¸¤å±‚å¾ªç¯è§£å†³</li></ul><hr><h2 id="å®éªŒ4-bx-å’Œloopçš„ä½¿ç”¨"><a href="#å®éªŒ4-bx-å’Œloopçš„ä½¿ç”¨" class="headerlink" title="å®éªŒ4 [bx]å’Œloopçš„ä½¿ç”¨"></a>å®éªŒ4 [bx]å’Œloopçš„ä½¿ç”¨</h2><hr><p>1.ç¼–ç¨‹ï¼Œå‘å†…å­˜0:200-0:23Fä¾æ¬¡ä¼ é€æ•°æ®0-63ï¼ˆ3FH)ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code         <span class="hljs-comment">;å…«æ¡æŒ‡ä»¤çš„</span><br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0h</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">bx</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">64</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">s:</span><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">200h</span>],<span class="hljs-built_in">bx</span><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">bx</span><br><span class="hljs-keyword">loop</span> s<br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>code ends<br>end start<br><br><br><br><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code         <span class="hljs-comment">;ä¹æ¡æŒ‡ä»¤çš„ï¼Œä¹¦ä¸Šç°åœ¨è¿˜è§„å®šæŒ‡ä»¤æ•°</span><br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0020H</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">64</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">s:</span><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">bl</span><br>   <span class="hljs-keyword">inc</span> <span class="hljs-built_in">bx</span><br>   <span class="hljs-keyword">loop</span> s<br><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>code ends<br>end start<br><br><br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ5-ç¼–å†™ã€è°ƒè¯•å…·æœ‰å¤šä¸ªæ®µçš„ç¨‹åº"><a href="#å®éªŒ5-ç¼–å†™ã€è°ƒè¯•å…·æœ‰å¤šä¸ªæ®µçš„ç¨‹åº" class="headerlink" title="å®éªŒ5 ç¼–å†™ã€è°ƒè¯•å…·æœ‰å¤šä¸ªæ®µçš„ç¨‹åº"></a>å®éªŒ5 ç¼–å†™ã€è°ƒè¯•å…·æœ‰å¤šä¸ªæ®µçš„ç¨‹åº</h2><hr><p>1.ç¨‹ åºå¦‚ä¸‹ï¼Œç¼–å†™codeæ®µä¸­çš„ä»£ç ï¼Œå°†aæ®µå’Œbæ®µä¸­çš„æ•°æ®ä¾æ¬¡ç›¸åŠ ï¼Œå°†ç»“æœä¿å­˜åˆ°cæ®µä¸­ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>a <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><br>a ends<br>b <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><br>b ends<br>c <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">db</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>c ends<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span><br>?<br>code ends<br>end start<br><br><br>è¡¥å……åçš„ä»£ç å¦‚ä¸‹ï¼š<br><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>a <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><br>a ends<br>b <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><br>b ends<br>c <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">db</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>c ends<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,a<br>   <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br>   <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">8</span><br>   <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span><br><span class="hljs-symbol">   </span><br><span class="hljs-symbol">s:</span> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,<span class="hljs-number">0</span><br>   <span class="hljs-keyword">add</span> <span class="hljs-built_in">dl</span>,[<span class="hljs-built_in">si</span>]<br>   <span class="hljs-keyword">add</span> <span class="hljs-built_in">dl</span>,[<span class="hljs-number">16</span>+<span class="hljs-built_in">si</span>]<br>   <span class="hljs-keyword">mov</span> [<span class="hljs-number">32</span>+<span class="hljs-built_in">si</span>],<span class="hljs-built_in">dl</span><br>   <span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br>   <span class="hljs-keyword">loop</span> s<br>   <br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>code ends<br>end start<br></code></pre></td></tr></table></figure><p>2.ç¨‹åº å¦‚ä¸‹ï¼Œç¼–å†™codeæ®µä»£ç ï¼Œç”¨pushæŒ‡ä»¤å°†aæ®µä¸­çš„å‰8ä¸ªå­—å‹æ•°æ®ï¼Œé€†åºå­˜å‚¨åˆ°bæ®µä¸­ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code <br>a <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">dw</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0ah</span>,<span class="hljs-number">0bh</span>,<span class="hljs-number">0ch</span>,<span class="hljs-number">0dh</span>,<span class="hljs-number">0eh</span>,<span class="hljs-number">0fh</span>,<span class="hljs-number">0ffh</span><br>a ends<br>b <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">dw</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>b ends<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span><br>?<br>code ends<br>end start<br><br><br>è¡¥å……åçš„ä»£ç å¦‚ä¸‹ï¼š<br><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>a <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">dw</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0ah</span>,<span class="hljs-number">0bh</span>,<span class="hljs-number">0ch</span>,<span class="hljs-number">0dh</span>,<span class="hljs-number">0eh</span>,<span class="hljs-number">0fh</span>,<span class="hljs-number">0ffh</span><br>a ends<br><br>b <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">dw</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>b ends<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,a<br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br>        <br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,b<br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ss</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">sp</span>,<span class="hljs-number">16</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">8</span><br><span class="hljs-symbol">    s:</span>  <span class="hljs-keyword">push</span> [<span class="hljs-built_in">bx</span>]<br>        <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2</span><br>        <span class="hljs-keyword">loop</span> s <br><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>    <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>code ends<br>end start<br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ6-å®è·µè¯¾ç¨‹ä¸­çš„ç¨‹åº"><a href="#å®éªŒ6-å®è·µè¯¾ç¨‹ä¸­çš„ç¨‹åº" class="headerlink" title="å®éªŒ6 å®è·µè¯¾ç¨‹ä¸­çš„ç¨‹åº"></a>å®éªŒ6 å®è·µè¯¾ç¨‹ä¸­çš„ç¨‹åº</h2><hr><p>å°†ä¸‹é¢çš„ç¨‹åºè¡¥å……å®Œæ•´ï¼Œå®ç°å°† datasg æ®µä¸­çš„æ¯ä¸ªå•è¯çš„å‰ 4 ä¸ªå­—æ¯æ”¹ä¸ºå¤§å†™å­—æ¯ã€‚ã€è¦æ±‚ï¼šä»…èƒ½ä¿®æ”¹ codesg segment çš„ä»£ç ã€‘</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:codesg, <span class="hljs-built_in">ss</span>:stacksg, <span class="hljs-built_in">ds</span>:datasg<br><br>stacksg <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">dw</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>stacksg ends<br><br>datasg <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;1. display &#x27;</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;2. brows &#x27;</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;3. replace &#x27;</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;4. modify &#x27;</span><br>datasg ends<br><br>codesg <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><br>codesg ends<br>end start<br><br><br><br>ä¿®æ”¹åçš„ä»£ç ï¼š<br><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:codesg, <span class="hljs-built_in">ss</span>:stacksg, <span class="hljs-built_in">ds</span>:datasg<br><br>stacksg <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">dw</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>stacksg ends<br><br>datasg <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;1. display      &#x27;</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;2. brows        &#x27;</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;3. replace      &#x27;</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;4. modify       &#x27;</span><br>datasg ends<br><br>codesg <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,stacksg<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ss</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">sp</span>,<span class="hljs-number">16</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,datasg<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">4</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">       s0:</span>  <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">4</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">       s1:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,[<span class="hljs-built_in">bx</span>+<span class="hljs-number">3</span>+<span class="hljs-built_in">si</span>]<br>            <span class="hljs-keyword">and</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">11011111b</span><br>            <span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">3</span>+<span class="hljs-built_in">si</span>],<span class="hljs-built_in">al</span><br><br>            <span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br>            <span class="hljs-keyword">loop</span> s1<br><br>            <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">16</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">loop</span> s0 <br><br><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>codesg ends<br><br>end start<br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ7-å¯»å€æ–¹å¼åœ¨ç»“æ„åŒ–æ•°æ®è®¿é—®ä¸­çš„åº”ç”¨"><a href="#å®éªŒ7-å¯»å€æ–¹å¼åœ¨ç»“æ„åŒ–æ•°æ®è®¿é—®ä¸­çš„åº”ç”¨" class="headerlink" title="å®éªŒ7 å¯»å€æ–¹å¼åœ¨ç»“æ„åŒ–æ•°æ®è®¿é—®ä¸­çš„åº”ç”¨"></a>å®éªŒ7 å¯»å€æ–¹å¼åœ¨ç»“æ„åŒ–æ•°æ®è®¿é—®ä¸­çš„åº”ç”¨</h2><hr><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:codesg<br><br>data <span class="hljs-meta">segment</span><br>        <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;1975&#x27;</span>,<span class="hljs-string">&#x27;1976&#x27;</span>,<span class="hljs-string">&#x27;1977&#x27;</span>,<span class="hljs-string">&#x27;1978&#x27;</span>,<span class="hljs-string">&#x27;1979&#x27;</span>,<span class="hljs-string">&#x27;1980&#x27;</span>,<span class="hljs-string">&#x27;1981&#x27;</span>,<span class="hljs-string">&#x27;1982&#x27;</span>,<span class="hljs-string">&#x27;1983&#x27;</span><br>        <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;1984&#x27;</span>,<span class="hljs-string">&#x27;1985&#x27;</span>,<span class="hljs-string">&#x27;1986&#x27;</span>,<span class="hljs-string">&#x27;1987&#x27;</span>,<span class="hljs-string">&#x27;1988&#x27;</span>,<span class="hljs-string">&#x27;1989&#x27;</span>,<span class="hljs-string">&#x27;1990&#x27;</span>,<span class="hljs-string">&#x27;1991&#x27;</span>,<span class="hljs-string">&#x27;1992&#x27;</span><br>        <span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;1993&#x27;</span>,<span class="hljs-string">&#x27;1994&#x27;</span>,<span class="hljs-string">&#x27;1995&#x27;</span><br>        <span class="hljs-comment">;ä»¥ä¸Šæ˜¯è¡¨ç¤º21å¹´çš„21ä¸ªå­—ç¬¦ä¸²</span><br>        <span class="hljs-built_in">dd</span> <span class="hljs-number">16</span>,<span class="hljs-number">22</span>,<span class="hljs-number">382</span>,<span class="hljs-number">1356</span>,<span class="hljs-number">2390</span>,<span class="hljs-number">8000</span>,<span class="hljs-number">16000</span>,<span class="hljs-number">24486</span>,<span class="hljs-number">50065</span>,<span class="hljs-number">97479</span>,<span class="hljs-number">140417</span>,<span class="hljs-number">197514</span><br>        <span class="hljs-built_in">dd</span> <span class="hljs-number">345980</span>,<span class="hljs-number">590827</span>,<span class="hljs-number">803530</span>,<span class="hljs-number">1183000</span>,<span class="hljs-number">1843000</span>,<span class="hljs-number">2759000</span>,<span class="hljs-number">3753000</span>,<span class="hljs-number">4649000</span>,<span class="hljs-number">5937000</span><br>        <span class="hljs-comment">;ä»¥ä¸Šæ˜¯è¡¨ç¤º21å¹´å…¬å¸æ€»æ”¶çš„21ä¸ªdwordå‹æ•°æ®</span><br>        <span class="hljs-built_in">dw</span> <span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">13</span>,<span class="hljs-number">28</span>,<span class="hljs-number">38</span>,<span class="hljs-number">130</span>,<span class="hljs-number">220</span>,<span class="hljs-number">476</span>,<span class="hljs-number">778</span>,<span class="hljs-number">1001</span>,<span class="hljs-number">1442</span>,<span class="hljs-number">2258</span>,<span class="hljs-number">2793</span>,<span class="hljs-number">4037</span>,<span class="hljs-number">5635</span>,<span class="hljs-number">8226</span><br>        <span class="hljs-built_in">dw</span> <span class="hljs-number">11542</span>,<span class="hljs-number">14430</span>,<span class="hljs-number">15257</span>,<span class="hljs-number">17800</span><br>        <span class="hljs-comment">;ä»¥ä¸Šæ˜¯è¡¨ç¤º21å¹´å…¬å¸é›‡å‘˜äººæ•°çš„21ä¸ªwordå‹æ•°æ®</span><br>data ends<br><br><br>table <span class="hljs-meta">segment</span><br>    <span class="hljs-built_in">db</span> <span class="hljs-number">21</span> dup (<span class="hljs-string">&#x27;year summ ne ?? &#x27;</span>)<br>table ends<br><br><br>codesg <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,data<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,table<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span>       <span class="hljs-comment">;åˆå§‹åŒ–å¹´ä»½å’Œæ”¶å…¥çš„å…·ä½“ä½ç½®</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">0</span>   <span class="hljs-comment">;åˆå§‹åŒ–é›‡å‘˜æ•°å’Œäººå‡æ”¶å…¥çš„å…·ä½“ä½ç½®</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">21</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">s:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">es</span>:[<span class="hljs-built_in">si</span>]           <span class="hljs-comment">;å¹´ä»½å’Œæ”¶å…¥çš„ä½16bitï¼Œå ä¸¤ä¸ªå­—èŠ‚</span><br><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">0h</span>],<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">es</span>:[<span class="hljs-built_in">si</span>+<span class="hljs-number">54h</span>] <span class="hljs-comment">;åŠ 54hæ˜¯å› ä¸º21*4=84=54h</span><br><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">5h</span>],<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">2</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">es</span>:[<span class="hljs-built_in">si</span>]           <span class="hljs-comment">;å¹´ä»½å’Œæ”¶å…¥çš„é«˜16bitï¼Œå ä¸¤ä¸ªå­—èŠ‚</span><br><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">2h</span>],<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">es</span>:[<span class="hljs-built_in">si</span>+<span class="hljs-number">54h</span>]<br><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">7h</span>],<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">2</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">es</span>:[<span class="hljs-built_in">di</span>+<span class="hljs-number">0a8h</span>]      <span class="hljs-comment">;é›‡å‘˜æ•°ï¼Œå ä¸¤ä¸ªå­—èŠ‚ï¼ŒåŠ 0a8hæ˜¯å› ä¸º84*2=168=a8h</span><br><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">0ah</span>],<span class="hljs-built_in">ax</span>          <br><span class="hljs-keyword">add</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">2</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,[<span class="hljs-built_in">bx</span>+<span class="hljs-number">5h</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,[<span class="hljs-built_in">bx</span>+<span class="hljs-number">7h</span>]<br><span class="hljs-keyword">div</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">0ah</span>]   <span class="hljs-comment">;é™¤æ³•ç®—äººå‡æ”¶å…¥</span><br><span class="hljs-keyword">mov</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">0dh</span>],<span class="hljs-built_in">ax</span><br><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">16</span><br><span class="hljs-keyword">loop</span> s<br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>codesg ends<br><br><br>end start<br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ9-æ ¹æ®ææ–™ç¼–ç¨‹"><a href="#å®éªŒ9-æ ¹æ®ææ–™ç¼–ç¨‹" class="headerlink" title="å®éªŒ9 æ ¹æ®ææ–™ç¼–ç¨‹"></a>å®éªŒ9 æ ¹æ®ææ–™ç¼–ç¨‹</h2><hr><p>1.å°†ä½ çš„å§“åå’Œå­¦å·åœ¨å±å¹•ä¸Šä¸­é—´æ˜¾ç¤ºå‡ºæ¥ã€‚å­—ç¬¦å±æ€§è¦æ±‚å¦‚ä¸‹ï¼š å­¦å·å°¾å·ä¸º 1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9 çš„ä¸ºé»‘åº•ç»¿è‰²ï¼›å­¦å·å°¾å·ä¸º 0ï¼Œ2ï¼Œ4ï¼Œ6ï¼Œ8 çš„ä¸ºé»‘åº•çº¢è‰²ã€‚</p><ul><li><p>BLï¼ˆé—ªçƒï¼‰    R G Bï¼ˆèƒŒæ™¯ï¼‰   I ï¼ˆé«˜äº®ï¼‰    R G B ï¼ˆå‰æ™¯ï¼‰</p></li><li><p>80x25å½©è‰²å­—ç¬¦æ¨¡å¼æ˜¾ç¤ºç¼“å†²åŒº(ä»¥ä¸‹ç®€ç§°ä¸ºæ˜¾ç¤ºç¼“å†²åŒº)çš„ç»“æ„:</p><ul><li>å†…å­˜åœ°å€ç©ºé—´ä¸­ï¼ŒB8000H~BFFFFH å…±32KBçš„ç©ºé—´ï¼Œä¸º80X25 å½©è‰²å­—ç¬¦æ¨¡å¼çš„æ˜¾ç¤ºç¼“å†²åŒºã€‚å‘è¿™ä¸ªåœ°å€ç©ºé—´å†™å…¥æ•°æ®ï¼Œå†™å…¥çš„å†…å®¹å°†ç«‹å³å‡ºç°åœ¨æ˜¾ç¤ºå™¨ä¸Šã€‚</li><li>åœ¨ 80x25 å½©è‰²å­—ç¬¦æ¨¡å¼ä¸‹ï¼Œæ˜¾ç¤ºå™¨å¯ä»¥æ˜¾ç¤º 25 è¡Œï¼Œæ¯è¡Œ80ä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦å¯ä»¥æœ‰256 ç§å±æ€§(èƒŒæ™¯è‰²ã€å‰æ™¯è‰²ã€é—ªã€é«˜äº®ç­‰åˆä¿¡æ¯)ã€‚</li><li>è¿™æ ·ï¼Œä¸€ä¸ªå­—ç¬¦åœ¨æ˜¾ç¤ºç¼“å†²åŒºä¸­å°±è¦å ä¸¤ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«å­˜æ”¾å­—ç¬¦çš„ ASCIIç å’Œå±æ€§ã€‚</li><li>80x25æ¨¡å¼ä¸‹ï¼Œä¸€å±çš„å†…å®¹åœ¨æ˜¾ç¤ºç¼“å†²åŒºä¸­å…±å 4000ä¸ªå­—èŠ‚ã€‚</li><li>æ˜¾ç¤ºç¼“å†²åŒºåˆ†ä¸º 8é¡µï¼Œæ¯é¡µ 4KB(4000B)ï¼Œæ˜¾ç¤ºå™¨å¯ä»¥æ˜¾ç¤ºä»»æ„ä¸€é¡µçš„å†…å®¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ˜¾ç¤ºç¬¬0é¡µçš„å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´é€šå¸¸æƒ…å†µä¸‹ï¼ŒB8000H~B8F9FH ä¸­çš„4000ä¸ªå­—èŠ‚çš„å†…å®¹å°†å‡ºç°åœ¨æ˜¾ç¤ºå™¨ä¸Šã€‚</li></ul></li><li><p>åœ¨ä¸€é¡µæ˜¾ç¤ºç¼“å†²åŒºä¸­:</p><ul><li>åç§»000~09Få¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬1è¡Œ(80ä¸ªå­—ç¬¦å 160ä¸ªå­—èŠ‚);</li><li>åç§»0A0~13Få¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬2è¡Œ;</li><li>åç§»140~1DFå¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬3è¡Œ;</li><li>ä¾æ­¤ç±»æ¨ï¼Œå¯çŸ¥ï¼Œåç§»FOO~F9F å¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬25 è¡Œã€‚</li></ul></li><li><p>åœ¨ä¸€è¡Œä¸­ï¼Œ<strong>ä¸€ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´(ä¸€ä¸ªå­—)ï¼Œä½ä½å­—èŠ‚å­˜å‚¨å­—ç¬¦çš„ ASCIIç ï¼Œé«˜ä½å­—èŠ‚å­˜å‚¨å­—ç¬¦çš„å±æ€§ã€‚ä¸€è¡Œå…±æœ‰ 80ä¸ªå­—ç¬¦ï¼Œå 160ä¸ªå­—èŠ‚</strong>ã€‚å³åœ¨ä¸€è¡Œä¸­:</p><ul><li>00~01å•å…ƒå¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬ 1åˆ—:</li><li>02~03å•å…ƒå¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬2åˆ—</li><li>04~05å•å…ƒå¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬3 åˆ—</li><li>ä¾æ­¤ç±»æ¨ï¼Œå¯çŸ¥ï¼Œ9E~9F å•å…ƒå¯¹åº”æ˜¾ç¤ºå™¨ä¸Šçš„ç¬¬ 80 åˆ—</li></ul></li></ul><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>data <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;ID: 2021100001, Name: Lu Shuaichao&#x27;</span><br>data ends<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span> <br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,data<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0B800H</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span>                <span class="hljs-comment">;es æ§åˆ¶æ‰“å°åˆ°å±å¹•ä¸Š</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bp</span>,<span class="hljs-number">070eh</span>    <br><br><span class="hljs-comment">;bp æ§åˆ¶æ‰“å°åœ¨å±å¹•ä¸Šå…·ä½“çš„ä½ç½®ã€‚æ˜¾ç¤ºå™¨ä¸­é—´çš„ä½ç½®ä¸ºç¬¬ 12 è¡Œï¼ˆä¸€å…±25è¡Œå˜›ï¼‰ï¼Œå¯¹åº”çš„åç§»ä¸º06e0hï¼ˆ11*160ï¼‰ã€‚</span><br><span class="hljs-comment">;è¦æ‰“å°çš„å†…å®¹å…± 34 ä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦å ä¸¤å­—èŠ‚ï¼Œæ¯è¡Œå  160ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¦ä»ä¸è¡Œé¦–ä½ç½®åç§»ä¸º 46ï¼ˆ002ehï¼‰çš„ä½ç½®å†™å…¥ï¼Œè¿™ä¸ªä½ç½®åˆšå¥½ä¸ºä¸­é—´çš„ä½ç½®ã€‚</span><br><span class="hljs-comment">;06e0h + 002eh æœ€ç»ˆå¯å¾—å‡ºåº”ä»åç§»ä¸º 070eh çš„ä½ç½®å¼€å§‹å†™å…¥ã€‚</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">dl</span>,<span class="hljs-number">00000100b</span>          <span class="hljs-comment">;dl å¯„å­˜å™¨å­˜æ”¾é¢œè‰²å±æ€§</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">34</span>                <span class="hljs-comment">;ä¸€æ¬¡æ‰“å°å¾ªç¯æ¬¡æ•°</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">s2:</span> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,[<span class="hljs-built_in">bx</span>]<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bp</span>],<span class="hljs-built_in">al</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bp</span>+<span class="hljs-number">1</span>],<span class="hljs-built_in">dl</span>          <span class="hljs-comment">;æ¯æ¬¡å‘æ˜¾å­˜ä¸­å†™å…¥ä¸€ä¸ªå­—ç¬¦ï¼ˆä¸¤ä¸ªå­—èŠ‚ï¼‰</span><br><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">bx</span>                   <span class="hljs-comment">;ä¸‹ä¸€ä¸ªå­—ç¬¦</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">bp</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">loop</span> s2<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">s0:</span> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><br>code ends<br>end start<br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ10-ç¼–å†™å­ç¨‹åº"><a href="#å®éªŒ10-ç¼–å†™å­ç¨‹åº" class="headerlink" title="å®éªŒ10 ç¼–å†™å­ç¨‹åº"></a>å®éªŒ10 ç¼–å†™å­ç¨‹åº</h2><hr><p>1.æ˜¾ç¤ºå­—ç¬¦ä¸²</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>data <span class="hljs-meta">segment</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;Welcome to masm!&#x27;</span>,<span class="hljs-number">0</span><br>data ends<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-number">dh</span>,<span class="hljs-number">8</span>           <span class="hljs-comment">;æŒ‡å®šè¡Œå·</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">dl</span>,<span class="hljs-number">3</span>           <span class="hljs-comment">;æŒ‡å®šåˆ—å·</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">2</span>   <span class="hljs-comment">;æŒ‡å®šé¢œè‰²</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,data<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">call</span> show_str<br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">show_str:</span><span class="hljs-keyword">push</span> <span class="hljs-built_in">ax</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">dx</span><br><span class="hljs-keyword">push</span> <span class="hljs-built_in">si</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0B800H</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span>          <span class="hljs-comment">;è®¾ç½®esä¸ºæ˜¾ç¤ºåŒºæ®µåœ°å€</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">00A0H</span>       <span class="hljs-comment">;æ¯è¡Œ80ä¸ªå­—ç¬¦ï¼Œä¸€å…±å 160ä¸ªå­—èŠ‚</span><br><span class="hljs-keyword">mul</span> <span class="hljs-number">dh</span>             <span class="hljs-comment">;è®¾ç½®å­—ç¬¦æ˜¾ç¤ºåœ¨å“ªè¡Œ</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">dh</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">dx</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">dx</span>          <span class="hljs-comment">;åŠ ä¸¤æ¬¡æ˜¯å› ä¸ºä¸€ä¸ªå­—ç¬¦å ä¸¤ä¸ªå­—èŠ‚ï¼Œ</span><br> <span class="hljs-comment">;æ¯”å¦‚å±å¹•ä¸Šçš„ä¸€ä¸ªå­—æ¯aï¼Œå®ƒå°±å ä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªå­—èŠ‚æ˜¯asciiç ï¼Œä¸€ä¸ªå­—èŠ‚æ˜¯å±æ€§</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-built_in">ax</span>          <span class="hljs-comment">;bxæ˜¯æ˜¾ç¤ºåŒºçš„åç§»åœ°å€</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">cl</span>         <span class="hljs-comment">;é¢œè‰²å±æ€§å­˜å…¥al</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">a:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-built_in">ds</span>:[<span class="hljs-built_in">si</span>]     <span class="hljs-comment">;ds:[si]æ˜¯å½“å‰æŒ‡å‘çš„å­—ç¬¦</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">ch</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">jcxz</span> ok           <span class="hljs-comment">;è¯»åˆ°0å°±é€€å‡ºå¾ªç¯</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">cl</span>     <span class="hljs-comment">;ç¬¬ä¸€ä¸ªæ˜¯å­—æ¯</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>+<span class="hljs-number">1</span>],<span class="hljs-built_in">al</span>    <span class="hljs-comment">;ç¬¬äºŒä¸ªæ˜¯å±æ€§</span><br><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">jmp</span> short a<br><span class="hljs-symbol"></span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">ok:</span> <span class="hljs-keyword">pop</span> <span class="hljs-built_in">si</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">dx</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br><span class="hljs-keyword">pop</span> <span class="hljs-built_in">ax</span><br><span class="hljs-keyword">ret</span><br><br><br>code ends<br>end start<br><br><br></code></pre></td></tr></table></figure><p>2.æ•°å€¼æ˜¾ç¤ºï¼ˆåŠ ä¸Šåˆ¤æ–­æº¢å‡ºåçš„ä»£ç æ²¡çœ‹æ‡‚ï¼‰</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code,<span class="hljs-built_in">ds</span>:data,<span class="hljs-built_in">ss</span>:stack<br>data <span class="hljs-meta">segment</span><br>    <span class="hljs-built_in">db</span> <span class="hljs-number">10</span> dup(<span class="hljs-number">0</span>)<br>data ends<br> <br>stack <span class="hljs-meta">segment</span><br>    <span class="hljs-built_in">dw</span> <span class="hljs-number">16</span> dup(<span class="hljs-number">0</span>)    <span class="hljs-comment">;32å­—èŠ‚</span><br>stack ends<br> <br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,data    <span class="hljs-comment">;è®¾ç½®dsæ®µåœ°å€</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">bx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,stack    <span class="hljs-comment">;è®¾ç½®æ ˆé¡¶</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ss</span>,<span class="hljs-built_in">bx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">sp</span>,<span class="hljs-number">20H</span><br> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">12666</span>     <span class="hljs-comment">;è¦æ˜¾ç¤ºçš„æ•°æ®</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span>         <span class="hljs-comment">;ds:siæŒ‡å‘å­—ç¬¦ä¸²é¦–åœ°å€</span><br>    <span class="hljs-keyword">call</span> dtoc        <span class="hljs-comment">;å°†æ•°æ®è½¬ä¸ºåè¿›åˆ¶å­—ç¬¦</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-number">dh</span>,<span class="hljs-number">8</span>    <span class="hljs-comment">;åœ¨å±å¹•ç¬¬å‡ è¡Œå¼€å§‹æ˜¾ç¤º</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dl</span>,<span class="hljs-number">3</span>    <span class="hljs-comment">;åœ¨å±å¹•ç¬¬å‡ åˆ—å¼€å§‹æ˜¾ç¤º</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">2</span>    <span class="hljs-comment">;æ˜¾ç¤ºçš„å­—ç¬¦çš„é¢œè‰²</span><br>    <span class="hljs-keyword">call</span> show_str<br> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00H</span>    <span class="hljs-comment">;ç¨‹åºè¿”å›</span><br>    <span class="hljs-keyword">int</span> <span class="hljs-number">21H</span><br><span class="hljs-symbol"> </span><br><span class="hljs-symbol"> </span><br><span class="hljs-symbol">dtoc:</span>    <span class="hljs-comment">;åŠŸèƒ½ï¼šå°†ç»™å®šçš„wordå‹æ•°æ®è½¬ä¸ºåè¿›åˆ¶å­—ç¬¦å½¢å¼ï¼Œå­˜å…¥dataæ®µï¼Œé¦–åœ°å€ds:si</span><br>            <span class="hljs-comment">;å‚æ•°ï¼šax æŒ‡å®šçš„wordæ•°æ® </span><br>            <span class="hljs-comment">;è¿”å›ï¼šds:siæŒ‡å‘dataæ®µå­—ç¬¦ä¸²é¦–åœ°å€</span><br>    <br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span><span class="hljs-comment">;    ;å°†å­ç¨‹åºç”¨åˆ°çš„å¯„å­˜å™¨å‹å…¥æ ˆ</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><span class="hljs-comment">;    </span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">dx</span><span class="hljs-comment">;</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">si</span><span class="hljs-comment">;</span><br> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">000aH</span>    <span class="hljs-comment">;bl = é™¤æ•°ï¼Œbh = ä¸€å…±é™¤äº†å‡ æ¬¡</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,<span class="hljs-number">0</span>    <span class="hljs-comment">;å³å°†è¿›è¡Œé™¤æ³•ï¼Œdxæ˜¯é«˜16ä½ï¼Œä½16ä½åœ¨axä¸­</span><br><span class="hljs-symbol">pushyushu:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-built_in">bl</span>    <span class="hljs-comment">;cx = é™¤æ•°</span><br>    <span class="hljs-keyword">call</span> divdw    <span class="hljs-comment">;è°ƒç”¨ä¸ä¼šæº¢å‡ºçš„é™¤æ³•å‡½æ•°ï¼Œç»“æœçš„å•†çš„é«˜16ä½ï¼Œåœ¨dxä¸­ï¼Œ</span><br>                    <span class="hljs-comment">;ä½16ä½åœ¨axä¸­ï¼Œä½™æ•°åœ¨cxä¸­ï¼Œä½™æ•°ä¸€å®š&lt;10</span><br> <br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span>        <span class="hljs-comment">;cx=ä½™æ•°ï¼Œè¿™ä¸ªä½™æ•°åœ¨æ˜¾ç¤ºçš„æ—¶å€™è¦å€’åºæ˜¾ç¤ºï¼Œå› æ­¤å…ˆå‹å…¥æ ˆ</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-number">bh</span>         <span class="hljs-comment">;è®°å½•å°†ä½™æ•°å‹å…¥æ ˆçš„æ¬¡æ•°</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-built_in">ax</span>      <span class="hljs-comment">;cx = ax = ç»“æœçš„å•†çš„ä½16ä½</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">cx</span>,<span class="hljs-built_in">dx</span>      <span class="hljs-comment">;dxæ˜¯ç»“æœçš„å•†çš„é«˜16ä½ï¼Œaxå’Œdxä¸€å®šéƒ½æ˜¯éè´Ÿæ•°</span><br>    <span class="hljs-keyword">jcxz</span> popyushu        <span class="hljs-comment">;è‹¥cx=0ï¼Œåˆ™è¯´æ˜é™¤æ³•è®¡ç®—å·²ç»å®Œæ¯•ï¼Œè·³è½¬ä¸‹ä¸€æ­¥æ‰§è¡Œ</span><br>    <span class="hljs-keyword">jmp</span> short pushyushu<br><span class="hljs-symbol"> </span><br><span class="hljs-symbol">popyushu:</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-number">ch</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">bh</span>    <span class="hljs-comment">;ch=0ï¼Œæ‰€ä»¥cx = å°†ä½™æ•°å‹å…¥æ ˆçš„æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥çš„å¾ªç¯æ¬¡æ•°</span><br><span class="hljs-symbol">s1:</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ax</span><span class="hljs-comment">;            ;ä»æ ˆä¸­popå‡ºä¸€ä¸ªä½™æ•°</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">30H</span>         <span class="hljs-comment">;ä»æ•°å­—è½¬ä¸ºå¯¹åº”çš„æ•°å­—å­—ç¬¦</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>:[<span class="hljs-built_in">si</span>],<span class="hljs-built_in">al</span>     <span class="hljs-comment">;ç”¨alå°±å¤Ÿäº†</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br>    <span class="hljs-keyword">loop</span> s1<br>    <br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">si</span>    <span class="hljs-comment">;å­ç¨‹åºç»“æŸï¼Œå°†å¯„å­˜å™¨çš„å€¼popå‡ºæ¥</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">dx</span><span class="hljs-comment">;    </span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><span class="hljs-comment">;</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><span class="hljs-comment">;</span><br>    <br>    <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"> </span><br><span class="hljs-symbol">divdw:</span>      <span class="hljs-comment">;åŠŸèƒ½ï¼šè®¡ç®—wordå‹è¢«é™¤æ•°ä¸byteå‹é™¤æ•°çš„é™¤æ³•</span><br>            <span class="hljs-comment">;å‚æ•°ï¼š  ax=è¢«é™¤æ•°ä½16ä½ï¼Œdx=è¢«é™¤æ•°é«˜16ä½ï¼Œcx = é™¤æ•°</span><br>            <span class="hljs-comment">;è¿”å›ï¼š  ax=å•†çš„ä½16ä½ï¼Œdx=å•†çš„é«˜16ä½ï¼Œcx = ä½™æ•°</span><br> <br>    <span class="hljs-comment">;è®¡ç®—å…¬å¼ï¼š X/N = int( H/N ) * 65536 + [rem( H/N) * 65536 + L]/N  </span><br>    <span class="hljs-comment">;å…¶ä¸­Xä¸ºè¢«é™¤æ•°ï¼ŒNä¸ºé™¤æ•°ï¼ŒHä¸ºè¢«é™¤æ•°çš„é«˜16ä½ï¼ŒLä¸ºè¢«é™¤æ•°çš„ä½16ä½ï¼Œ</span><br>    <span class="hljs-comment">;int()è¡¨ç¤ºç»“æœçš„å•†ï¼Œrem()è¡¨ç¤ºç»“æœçš„ä½™æ•°ã€‚</span><br> <br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span>      <span class="hljs-comment">;bxæ˜¯é¢å¤–ç”¨åˆ°çš„å¯„å­˜å™¨ï¼Œè¦å‹å…¥æ ˆ</span><br> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-built_in">ax</span>    <span class="hljs-comment">;bx=L</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">dx</span>    <span class="hljs-comment">;ax=H</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,<span class="hljs-number">0</span>     <span class="hljs-comment">;dx=0</span><br>    <span class="hljs-keyword">div</span> <span class="hljs-built_in">cx</span>        <span class="hljs-comment">;è®¡ç®—H/Nï¼Œç»“æœçš„å•†å³int(H/N)ä¿å­˜åœ¨axï¼Œä½™æ•°å³rem(H/N)ä¿å­˜åœ¨dx</span><br> <br>                    <span class="hljs-comment">;æ¥ä¸‹æ¥è¦è®¡ç®—int(H/N)*65536ï¼Œæ€è€ƒä¸€ä¸‹ï¼Œ65536å°±æ˜¯0001 0000 Hï¼Œ</span><br>                    <span class="hljs-comment">;å› æ­¤è®¡ç®—ç»“æœå°±æ˜¯ï¼Œé«˜16ä½=int(H/N)ï¼Œä½16ä½ä¸º0000Hã€‚</span><br> <br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">ax</span>         <span class="hljs-comment">;å°†int(H/N)*65536ç»“æœçš„é«˜16ä½ï¼Œå³int(H/N)ï¼Œå‹å…¥æ ˆ</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">ax</span>         <span class="hljs-comment">;å°†int(H/N)*65536ç»“æœçš„ä½16ä½ï¼Œå³0000Hï¼Œå‹å…¥æ ˆ</span><br> <br>                    <span class="hljs-comment">;æ¥ä¸‹æ¥è¦è®¡ç®— rem(H/N)*65536 ï¼ŒåŒç†å¯å¾—ï¼Œ</span><br>                    <span class="hljs-comment">;è®¡ç®—ç»“æœä¸º é«˜16ä½=  rem(H/N)*65536 ï¼Œå³æ­¤æ—¶dxçš„å€¼ï¼Œ</span><br>                    <span class="hljs-comment">;ä½16ä½ä¸º 0000Hã€‚</span><br> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">bx</span>     <span class="hljs-comment">;ax = bx = L ï¼Œå³ [rem(H/N)*65536 + L]çš„ä½16ä½</span><br>    <span class="hljs-keyword">div</span> <span class="hljs-built_in">cx</span>        <span class="hljs-comment">;è®¡ç®— [rem( H/N) * 65536 + L]/N ï¼Œç»“æœçš„å•†ä¿å­˜åœ¨axï¼Œä½™æ•°ä¿å­˜åœ¨dx</span><br> <br>                    <span class="hljs-comment">;æ¥ä¸‹æ¥è¦å°†ä¸¤é¡¹æ±‚å’Œã€‚  å·¦è¾¹é¡¹çš„é«˜ã€ä½16ä½éƒ½åœ¨æ ˆä¸­ï¼Œ</span><br>                    <span class="hljs-comment">;å…¶ä¸­é«˜16ä½å°±æ˜¯æœ€ç»ˆç»“æœçš„é«˜16ä½ï¼Œä½16ä½æ˜¯0000Hã€‚</span><br>                    <span class="hljs-comment">;å³è¾¹é¡¹çš„å•†ä¸º16ä½ï¼Œåœ¨axä¸­ï¼Œä¹Ÿå°±æ˜¯æœ€ç»ˆç»“æœçš„ä½16ä½ï¼Œ</span><br>                    <span class="hljs-comment">;ä½™æ•°åœ¨dxä¸­ï¼Œä¹Ÿå°±æ˜¯æœ€ç»ˆç»“æœçš„ä½™æ•°ã€‚</span><br> <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-built_in">dx</span>     <span class="hljs-comment">;cx = æœ€ç»ˆç»“æœçš„ä½™æ•°</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span>        <span class="hljs-comment">;cx = int(H/N)*65536ç»“æœçš„ä½16ä½ï¼Œå³0000Hã€‚</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">dx</span>        <span class="hljs-comment">;bx = int(H/N)*65536ç»“æœçš„é«˜16ä½ï¼Œå³æœ€ç»ˆç»“æœçš„é«˜16ä½</span><br> <br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span>    <span class="hljs-comment">;è¿˜åŸbxçš„å€¼</span><br> <br>    <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"> </span><br><span class="hljs-symbol">    </span><br><span class="hljs-symbol">show_str:</span><br>                <span class="hljs-comment">;åŠŸèƒ½ï¼šå°†dataæ®µä¸­é¦–åœ°å€ä¸ºds:siçš„å­—ç¬¦ï¼Œä»¥æŒ‡å®šé¢œè‰²æ˜¾ç¤ºåœ¨å±å¹•æŒ‡å®šä½ç½®</span><br>                <span class="hljs-comment">;å‚æ•°ï¼šdh è¡Œå·ï¼Œ dl åˆ—å· ï¼Œcl é¢œè‰²</span><br>                <span class="hljs-comment">;è¿”å›ï¼šæ— </span><br> <br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">dx</span>        <span class="hljs-comment">;å°†å­ç¨‹åºç”¨åˆ°çš„å¯„å­˜å™¨å‹å…¥æ ˆ</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">si</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">ax</span><br>    <span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0B800H</span>    <span class="hljs-comment">;è®¾ç½®esä¸ºæ˜¾ç¤ºåŒºæ®µåœ°å€</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br>    <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">00A0H</span>    <span class="hljs-comment">;è®¾ç½®é¦–å­—ç¬¦æ˜¾ç¤ºçš„åœ°å€</span><br>    <span class="hljs-keyword">mul</span> <span class="hljs-number">dh</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-number">dh</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">dx</span> <br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">dx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-built_in">ax</span>    <span class="hljs-comment">;bxæ˜¯æ˜¾ç¤ºåŒºçš„åç§»åœ°å€</span><br>        <br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">cl</span>    <span class="hljs-comment">;ç”¨alå­˜å‚¨å±æ€§å­—èŠ‚</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-number">ch</span>,<span class="hljs-number">0</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span><br><span class="hljs-symbol">    </span><br><span class="hljs-symbol">    s:</span>                <span class="hljs-comment">;å¾ªç¯è¯»å–å­—ç¬¦å¹¶æ˜¾ç¤º</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-built_in">ds</span>:[<span class="hljs-built_in">si</span>]<br>    <span class="hljs-keyword">jcxz</span> ok            <span class="hljs-comment">;è‹¥è¯»åˆ°0ï¼Œå°±é€€å‡ºå¾ªç¯</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">cl</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">bx</span><br>    <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">al</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">bx</span><br>    <span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br>    <span class="hljs-keyword">jmp</span> short s<br><span class="hljs-symbol"> </span><br><span class="hljs-symbol">    ok:</span>        <span class="hljs-comment">;å°†å¯„å­˜å™¨çš„å€¼popå‡ºæ¥</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ax</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">si</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">dx</span><br>    <br>    <span class="hljs-keyword">ret</span>    <span class="hljs-comment">;è¿”å›</span><br> <br> <br>code ends<br>end start<br> <br><br><br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ12-ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº"><a href="#å®éªŒ12-ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº" class="headerlink" title="å®éªŒ12 ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº"></a>å®éªŒ12 ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº</h2><hr><p>1.ç¼–å†™ 0 å·ä¸­æ–­çš„å¤„ç†ç¨‹åºå¹¶å°†å…¶å®‰è£…åœ¨ 0:200 å¤„ï¼Œä½¿å¾—åœ¨é™¤æ³•æº¢å‡ºå‘ç”Ÿæ—¶ï¼Œå±å¹•ä¸­é—´è‡ªåŠ¨æ˜¾ç¤ºå­—ç¬¦ä¸²â€œdivide overflow!â€,ç„¶åè¿”å›åˆ° DOSã€‚å®‰è£…å®Œä¸­æ–­å¤„ç†ç¨‹åºåï¼Œç¼–å†™é’ˆå¯¹è¯¥ä¸­æ–­å¤„ç†ç¨‹åºçš„æµ‹è¯•ç¨‹åºï¼Œå¹¶è¿è¡Œæµ‹è¯•ç¨‹åºï¼Œæ£€æŸ¥æ˜¯å¦æ­£ç¡®è§¦å‘ä¸­æ–­å¤„ç†ç¨‹åºã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">cs</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,offset do0                <span class="hljs-comment">;è®¾ç½®ds:siæŒ‡å‘æºåœ°å€</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">200h</span>                      <span class="hljs-comment">;è®¾ç½®es:diæŒ‡å‘ç›®çš„åœ°å€</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,offset do0end-offset do0  <span class="hljs-comment">;cxä¸ºä¼ è¾“é•¿åº¦</span><br><span class="hljs-keyword">cld</span>                              <span class="hljs-comment">;ä¼ è¾“æ–¹å‘ä¸ºæ­£</span><br><span class="hljs-keyword">rep</span> <span class="hljs-keyword">movsb</span>                        <span class="hljs-comment">;ç”¨movsbæŒ‡ä»¤ï¼Œå°†do0çš„ä»£ç é€å…¥0:200å¤„</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">0</span>],<span class="hljs-number">200h</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">2</span>],<span class="hljs-number">0h</span>     <span class="hljs-comment">;è®¾ç½®ä¸­æ–­å‘é‡</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">   do0:</span><span class="hljs-keyword">jmp</span> short do0start       <span class="hljs-comment">;EB10 å ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸‹é¢æ˜¯202hï¼Œä¸æ˜¯200h</span><br><span class="hljs-built_in">db</span> <span class="hljs-string">&quot;divide overflow!&quot;</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol"> do0start:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">cs</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">202h</span>      <span class="hljs-comment">;è®¾ç½®ds:siæŒ‡å‘å­—ç¬¦ä¸²</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0b800h</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">12</span>*<span class="hljs-number">160</span>+<span class="hljs-number">33</span>*<span class="hljs-number">2</span>    <span class="hljs-comment">;è®¾ç½®es:diæŒ‡å‘æ˜¾å­˜ç©ºé—´çš„ä¸­é—´ä½ç½®</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">16</span>             <span class="hljs-comment">;cxä¸ºå­—ç¬¦ä¸²é•¿åº¦</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">s:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">ds</span>:[<span class="hljs-built_in">si</span>]<br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">di</span>],<span class="hljs-built_in">al</span><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">di</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">di</span>],<span class="hljs-number">2H</span>  <br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">di</span><br><br><span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br><span class="hljs-keyword">loop</span> s<br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">do0end:</span><span class="hljs-keyword">nop</span><br><br>   <br>code ends<br>end start<br><br><br>æµ‹è¯•ç¨‹åºï¼š<br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">1000h</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">bh</span>,<span class="hljs-number">1h</span><br><span class="hljs-keyword">div</span> <span class="hljs-number">bh</span><br><br><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><br><br>code ends<br>end start<br><br><br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ13-ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº"><a href="#å®éªŒ13-ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº" class="headerlink" title="å®éªŒ13 ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº"></a>å®éªŒ13 ç¼–å†™0å·ä¸­æ–­çš„å¤„ç†ç¨‹åº</h2><hr><p>ç¼–å†™å¹¶å®‰è£… int 7ch ä¸­æ–­ä¾‹ç¨‹ï¼ŒåŠŸèƒ½ä¸ºä»¥â€œå¹´&#x2F;æœˆ&#x2F;æ—¥ æ—¶:åˆ†:ç§’â€çš„æ ¼å¼ï¼Œåœ¨å±å¹•ä¸­é—´æ˜¾ç¤ºå½“å‰çš„æ—¥æœŸã€æ—¶é—´ã€‚ä¸­æ–­ä¾‹ç¨‹å®‰è£…åœ¨ 0:200 å¤„ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">cs</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,offset a           <span class="hljs-comment">;è®¾ç½®ds:siæŒ‡å‘æºåœ°å€</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">200h</span>               <span class="hljs-comment">;è®¾ç½®es:diæŒ‡å‘ç›®çš„åœ°å€</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,offset aend-offset a      <span class="hljs-comment">;cxä¸ºä¼ è¾“é•¿åº¦</span><br>        <span class="hljs-keyword">cld</span>                               <span class="hljs-comment">;ä¼ è¾“æ–¹å‘ä¸ºæ­£</span><br>        <span class="hljs-keyword">rep</span> <span class="hljs-keyword">movsb</span>                        <span class="hljs-comment">;ç”¨movsbæŒ‡ä»¤ï¼Œå°†açš„ä»£ç é€å…¥0:200å¤„</span><br>  <br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">7ch</span>*<span class="hljs-number">4</span>],<span class="hljs-number">200h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">7ch</span>*<span class="hljs-number">4</span>+<span class="hljs-number">2</span>],<span class="hljs-number">0</span>    <span class="hljs-comment">;è®¾ç½®ä¸­æ–­å‘é‡</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol">        </span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">   a:</span>   <span class="hljs-keyword">jmp</span> short astart<br>   <span class="hljs-built_in">db</span> <span class="hljs-string">&quot;9/8/7 4:2:0&quot;</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">astart:</span> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">cs</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">202h</span>     <span class="hljs-comment">;ds:siæŒ‡å‘æ•°æ®æ®µ</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0b800h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">160</span>*<span class="hljs-number">12</span>+<span class="hljs-number">30</span>*<span class="hljs-number">2</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">0</span>              <span class="hljs-comment">;es:diæŒ‡å‘æ˜¾ç¤ºç¼“å†²åŒº</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">11</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">   s:</span>   <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-built_in">ds</span>:[<span class="hljs-built_in">si</span>]<br>        <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">48</span><br>    <span class="hljs-keyword">jb</span> no      <br>    <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">57</span><br>    <span class="hljs-keyword">ja</span> no  <span class="hljs-comment">;ASCIIç å€¼å°äº48æˆ–å¤§äº57åˆ™è½¬ç§»è‡³no,å³ä¸æ˜¯æ•°å­—å°±ç›´æ¥æ˜¾ç¤º</span><br><br>    <span class="hljs-keyword">call</span> yes          <span class="hljs-comment">;æ˜¯æ•°å­—å°±è½¬ç§»åˆ°yeså¤„æ‰§è¡Œ</span><br>    <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>    <span class="hljs-keyword">loop</span> s<br><br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>  <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">   no:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>+<span class="hljs-built_in">di</span>],<span class="hljs-built_in">cl</span><br>    <span class="hljs-keyword">add</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">2</span><br>        <span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br><br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>        <span class="hljs-keyword">sub</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">jmp</span> <span class="hljs-built_in">far</span> <span class="hljs-built_in">ptr</span> s    <span class="hljs-comment">;æ®µé—´è½¬ç§»è‡³så¤„</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">   yes:</span> <span class="hljs-keyword">sub</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">48</span> <span class="hljs-comment">;å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">cl</span><br>        <span class="hljs-keyword">out</span> <span class="hljs-number">70h</span>,<span class="hljs-built_in">al</span><br>        <span class="hljs-keyword">in</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">71h</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-number">ah</span>,<span class="hljs-built_in">al</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">4</span><br>        <span class="hljs-keyword">shr</span> <span class="hljs-number">ah</span>,<span class="hljs-built_in">cl</span><br>        <span class="hljs-keyword">and</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">00001111b</span><br><br>        <span class="hljs-keyword">add</span> <span class="hljs-number">ah</span>,<span class="hljs-number">30h</span><br>        <span class="hljs-keyword">add</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">30h</span><br><br>        <br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>+<span class="hljs-built_in">di</span>],<span class="hljs-number">ah</span>     <br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>+<span class="hljs-built_in">di</span>+<span class="hljs-number">2</span>],<span class="hljs-built_in">al</span>     <br>        <span class="hljs-keyword">add</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">4</span><br>        <span class="hljs-keyword">inc</span> <span class="hljs-built_in">si</span><br><br>        <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">      aend:</span> <span class="hljs-keyword">nop</span><br><br>code ends<br>end start<br><br><br>æµ‹è¯•ç¨‹åºï¼š<br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">7ch</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br>code ends<br>end start<br><br><span class="hljs-comment">;é—®é¢˜ï¼šåˆšå¼€å§‹æ²¡æ³¨æ„åˆ° db ä¸­ï¼Œå³æ•°æ®æ®µä¸­çš„æ•°å­—æ˜¯ ascii ç ã€‚</span><br><span class="hljs-comment">;è§£å†³åŠæ³•ï¼šsub cl,48 ;å°†å­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ15-å®‰è£…æ–°çš„-int9-ä¸­æ–­ä¾‹ç¨‹"><a href="#å®éªŒ15-å®‰è£…æ–°çš„-int9-ä¸­æ–­ä¾‹ç¨‹" class="headerlink" title="å®éªŒ15 å®‰è£…æ–°çš„ int9 ä¸­æ–­ä¾‹ç¨‹"></a>å®éªŒ15 å®‰è£…æ–°çš„ int9 ä¸­æ–­ä¾‹ç¨‹</h2><hr><p>å®‰è£…ä¸€ä¸ªæ–°çš„ int 9 ä¸­æ–­ä¾‹ç¨‹ï¼ŒåŠŸèƒ½ï¼šåœ¨ DOS ä¸‹ï¼ŒæŒ‰ä¸‹â€œAâ€é”®åï¼Œå¦‚æœæ¾å¼€ï¼Œåˆ™æ˜¾ç¤ºæ»¡å±å¹•çš„â€œAâ€ï¼ˆå­—ç¬¦æ˜¾ç¤ºå±æ€§ä¸ºè“åº•é«˜äº®çº¢è‰²ï¼‰ï¼Œå…¶ä»–é”®ç…§å¸¸å¤„ç†ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><br><span class="hljs-comment">;(æœ‰ç‚¹8æ‡‚)</span><br><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>stack <span class="hljs-meta">segment</span><br>  <span class="hljs-built_in">db</span> <span class="hljs-number">128</span> dup (<span class="hljs-number">0</span>)<br>stack ends<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,stack<br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ss</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">sp</span>,<span class="hljs-number">128</span><br><br>        <span class="hljs-keyword">push</span> <span class="hljs-built_in">cs</span><br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ds</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,offset int9<br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">204h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,offset int9end-offset int9     <span class="hljs-comment">;cxä¸ºä¼ è¾“é•¿åº¦</span><br>        <span class="hljs-keyword">cld</span>                                   <span class="hljs-comment">;è®¾ç½®ä¼ è¾“æ–¹å‘ä¸ºæ­£</span><br>        <span class="hljs-keyword">rep</span> <span class="hljs-keyword">movsb</span><br><br>        <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">9</span>*<span class="hljs-number">4</span>]<br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">200h</span>]<br>        <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">9</span>*<span class="hljs-number">4</span>+<span class="hljs-number">2</span>]<br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">202h</span>]             <span class="hljs-comment">;å°†åŸint 9ä¸­æ–­ä¾‹ç¨‹çš„å…¥å£åœ°å€ä¿å­˜åœ¨0:200å•å…ƒå¤„</span><br><br>        <span class="hljs-keyword">cli</span>                            <span class="hljs-comment">;è®¾ç½®IF=0ï¼Œä¸å“åº”å¯å±è”½ä¸­æ–­</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">9</span>*<span class="hljs-number">4</span>],<span class="hljs-number">204h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">9</span>*<span class="hljs-number">4</span>+<span class="hljs-number">2</span>],<span class="hljs-number">0</span>      <span class="hljs-comment">;å°†æ–°çš„int 9ä¸­æ–­ä¾‹ç¨‹å®‰è£…åœ¨0:204å¤„</span><br>        <span class="hljs-keyword">sti</span>                            <span class="hljs-comment">;è®¾ç½®IF=1ï¼Œå“åº”å¯å±è”½ä¸­æ–­</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">int9:</span>   <span class="hljs-keyword">push</span> <span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span><br>        <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>        <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span><br><br>        <span class="hljs-keyword">in</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">60h</span>                     <span class="hljs-comment">;ä»ç«¯å£60hè¯»å‡ºé”®ç›˜çš„è¾“å…¥</span><br><br>        <span class="hljs-keyword">pushf</span><br>        <span class="hljs-keyword">call</span> <span class="hljs-built_in">dword</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">cs</span>:[<span class="hljs-number">200h</span>]      <span class="hljs-comment">;è°ƒç”¨BIOSçš„int 9ä¸­æ–­ä¾‹ç¨‹</span><br><br>        <span class="hljs-keyword">cmp</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">9eh</span><br>        <span class="hljs-keyword">jne</span> int9ret<br>    <br>        <span class="hljs-keyword">mov</span> <span class="hljs-number">ah</span>,<span class="hljs-string">&#x27;A&#x27;</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">1ch</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0b800h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">bx</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">2000</span><br><span class="hljs-symbol">    s:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-number">ah</span> <br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>+<span class="hljs-number">1</span>],<span class="hljs-built_in">al</span><br>        <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2</span><br>        <span class="hljs-keyword">loop</span> s<br><span class="hljs-symbol"></span><br><span class="hljs-symbol">int9ret:</span><span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span><br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br>        <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">iret</span>  <span class="hljs-comment">;å‰é¢æ²¡callå°±é™©å…ˆå†™iret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">int9end:</span><span class="hljs-keyword">nop</span><br><br>code ends<br>end start<br><br></code></pre></td></tr></table></figure><hr><h2 id="å®éªŒ16-ç¼–å†™åŒ…å«å¤šä¸ªåŠŸèƒ½å­ç¨‹åºçš„ä¸­æ–­ä¾‹ç¨‹"><a href="#å®éªŒ16-ç¼–å†™åŒ…å«å¤šä¸ªåŠŸèƒ½å­ç¨‹åºçš„ä¸­æ–­ä¾‹ç¨‹" class="headerlink" title="å®éªŒ16 ç¼–å†™åŒ…å«å¤šä¸ªåŠŸèƒ½å­ç¨‹åºçš„ä¸­æ–­ä¾‹ç¨‹"></a>å®éªŒ16 ç¼–å†™åŒ…å«å¤šä¸ªåŠŸèƒ½å­ç¨‹åºçš„ä¸­æ–­ä¾‹ç¨‹</h2><hr><ul><li>å®‰è£…ä¸€ä¸ªæ–°çš„ int 7ch ä¸­æ–­ä¾‹ç¨‹ï¼Œä¸ºæ˜¾ç¤ºè¾“å‡ºæä¾›å¦‚ä¸‹åŠŸèƒ½å­ç¨‹åºã€‚<ul><li>ï¼ˆ1ï¼‰æ¸…å±ï¼›</li><li>ï¼ˆ2ï¼‰è®¾ç½®å‰æ™¯è‰²ï¼›</li><li>ï¼ˆ3ï¼‰è®¾ç½®èƒŒæ™¯è‰²ï¼›</li><li>ï¼ˆ4ï¼‰å‘ä¸Šæ»šåŠ¨ä¸€è¡Œã€‚</li></ul></li><li>å…¥å£å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š<ul><li>ï¼ˆ1ï¼‰ ç”¨ ah å¯„å­˜å™¨ä¼ é€’åŠŸèƒ½å·ï¼š0 è¡¨ç¤ºæ¸…å±ï¼›1 è¡¨ç¤ºè®¾ç½®å‰æ™¯è‰²ï¼›2 è¡¨ç¤ºè®¾ç½®èƒŒæ™¯è‰²ï¼›3 è¡¨ç¤ºå‘ä¸Šæ»šåŠ¨ä¸€è¡Œï¼›</li><li>ï¼ˆ2ï¼‰ å¯¹äº 1ã€2 å·åŠŸèƒ½ï¼Œç”¨ al ä¼ é€’é¢œè‰²å€¼ï¼Œ(al)âˆˆ {0,1,2,3,4,5,6,7}ã€‚</li></ul></li></ul><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-built_in">cs</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,offset int7c           <span class="hljs-comment">;è®¾ç½®ds:siæŒ‡å‘æºåœ°å€</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">200h</span>               <span class="hljs-comment">;è®¾ç½®es:diæŒ‡å‘ç›®çš„åœ°å€</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,offset int7cend-offset int7c            <span class="hljs-comment">;cxä¸ºä¼ è¾“é•¿åº¦</span><br>        <span class="hljs-keyword">cld</span>                                            <span class="hljs-comment">;ä¼ è¾“æ–¹å‘ä¸ºæ­£</span><br>        <span class="hljs-keyword">rep</span> <span class="hljs-keyword">movsb</span>                                      <span class="hljs-comment">;ç”¨movsbæŒ‡ä»¤ï¼Œå°†açš„ä»£ç é€å…¥0:200å¤„</span><br>    <br>        <span class="hljs-keyword">cli</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">07ch</span>*<span class="hljs-number">4</span>],<span class="hljs-number">200h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-number">07ch</span>*<span class="hljs-number">4</span>+<span class="hljs-number">2</span>],<span class="hljs-number">0</span>    <span class="hljs-comment">;è®¾ç½®ä¸­æ–­å‘é‡</span><br>        <span class="hljs-keyword">sti</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><span class="hljs-symbol">        </span><br><span class="hljs-symbol">int7c:</span>  <span class="hljs-keyword">jmp</span> short setscreen<br><br><span class="hljs-comment">; è¿™é‡Œè¦æ³¨æ„ï¼Œåœ¨å®‰è£…ç¨‹åºä¸­çš„sub1æ˜¯ä¸€ä¸²æ•°æ®ï¼Œåœ¨ä¸­æ–­ä¾‹ç¨‹å®‰è£…åœ¨0:200hä¸­æ—¶ å¦‚æœä»ç„¶æŒ‰ç…§ç¬¬åå…­ç« é‚£æ ·è®¾ç½®ï¼Œæ˜¯æ— æ³•æˆåŠŸè°ƒç”¨å­ç¨‹åºçš„ï¼Œ</span><br><span class="hljs-comment">; å› ä¸ºä¸»ç¨‹åºè¿è¡Œå®Œæ¯•ä»¥å,ä¸»ç¨‹åºæ‰€å çš„å†…å­˜å¯èƒ½ä¼šè¢«å…¶ä»–å†…å®¹è¦†ç›–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå­ç¨‹åºå®‰è£…åœ¨ä¸­æ–­ä¾‹ç¨‹ä¹‹åçš„å†…å­˜ä¸­</span><br><span class="hljs-comment">; å½“ç„¶è¿™æ ·ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸­æ–­ä¾‹ç¨‹å¹¶æ²¡æœ‰å®‰è£…åœ¨0:200å¤„ï¼Œåˆ™tableä¸­çš„å€¼ä¹Ÿè¦ç›¸åº”æ”¹åŠ¨</span><br><span class="hljs-comment">; è‡³äºä¸ºä»€ä¹ˆå­ç¨‹åºä¸­çš„sub1s,sub2sä»¥åŠloopæŒ‡ä»¤è¿˜èƒ½æ­£å¸¸å·¥ä½œï¼Œæ˜¯å› ä¸ºè¿™æ˜¯åŸºäºä½ç§»çš„è·³è½¬</span><br><span class="hljs-comment">; å³åœ¨ä¸»ç¨‹åºä¸­ï¼Œç›¸åº”çš„loop/jmpæŒ‡ä»¤å·²ç»ç¼–è¯‘ä¸ºå›é€€/å‰è¿›xxå­—èŠ‚çš„æŒ‡ä»¤ï¼Œå› æ­¤ä¸ä¼šå—ä½ç½®ç§»åŠ¨çš„å½±å“</span><br><br>  table<span class="hljs-built_in">dw</span> sub1-int7c+<span class="hljs-number">200h</span>,sub2-int7c+<span class="hljs-number">200h</span>,sub3-int7c+<span class="hljs-number">200h</span>,sub4-int7c+<span class="hljs-number">200h</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol"> setscreen:</span><span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span><br>  <br>  <span class="hljs-keyword">cmp</span> <span class="hljs-number">ah</span>,<span class="hljs-number">3</span><span class="hljs-comment">; åˆ¤æ–­åŠŸèƒ½å·æ˜¯å¦å¤§äº3</span><br>  <span class="hljs-keyword">ja</span> sret<br>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bl</span>,<span class="hljs-number">ah</span><br>  <span class="hljs-keyword">mov</span> <span class="hljs-number">bh</span>,<span class="hljs-number">0</span><br>  <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-built_in">bx</span><span class="hljs-comment">; æ ¹æ®ahæä¾›çš„åŠŸèƒ½å·æ‰¾åˆ°å¯¹åº”å­ç¨‹åºåœ¨tableä¸­çš„åç§»</span><br>  <br>  <span class="hljs-keyword">push</span> <span class="hljs-built_in">cs</span><br>  <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ds</span><br>  <span class="hljs-keyword">call</span> <span class="hljs-built_in">word</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-built_in">bx</span>+<span class="hljs-number">200h</span>+<span class="hljs-number">2</span>]<span class="hljs-comment">; è°ƒç”¨</span><br><span class="hljs-symbol">  </span><br><span class="hljs-symbol">  sret:</span>   <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br>  <span class="hljs-keyword">iret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">    sub1:</span>   <span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span>                 <span class="hljs-comment">;1å·å­ç¨‹åº,æ¸…å±</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0b800h</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">bx</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">2000</span><br><span class="hljs-symbol">    sub1s:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2</span><br>            <span class="hljs-keyword">loop</span> sub1s<br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br>            <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">    sub2:</span><span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span>              <span class="hljs-comment">;2å·å­ç¨‹åº,è®¾ç½®å‰æ™¯è‰²</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0b800h</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">bx</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">1</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">2000</span><br><span class="hljs-symbol">    sub2s:</span>  <span class="hljs-keyword">and</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-number">11111000b</span><br>            <span class="hljs-keyword">or</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">al</span><br>            <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2</span><br>            <span class="hljs-keyword">loop</span> sub2s<br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br>            <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">    sub3:</span>   <span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span>                <span class="hljs-comment">;3å·å­ç¨‹åº,è®¾ç½®èƒŒæ™¯è‰²</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cl</span>,<span class="hljs-number">4</span><br>            <span class="hljs-keyword">shl</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">cl</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0b800h</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">bx</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">1</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">2000</span><br><span class="hljs-symbol">    sub3s:</span>  <span class="hljs-keyword">and</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-number">10001111b</span><br>            <span class="hljs-keyword">or</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">al</span><br>            <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2</span><br>            <span class="hljs-keyword">loop</span> sub3s<br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">bx</span><br>            <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">    sub4:</span>   <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span>            <span class="hljs-comment">;4å·å­ç¨‹åº,å‘ä¸Šæ»šåŠ¨ä¸€è¡Œ</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">si</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">di</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">push</span> <span class="hljs-built_in">ds</span><br><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0b800h</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">si</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">si</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">160</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">di</span>,<span class="hljs-number">0</span><br>            <span class="hljs-keyword">cld</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">24</span><br><span class="hljs-symbol">    sub4s:</span>  <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">160</span><br>            <span class="hljs-keyword">rep</span> <span class="hljs-keyword">movsb</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">loop</span> sub4s<br><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">80</span><br>            <span class="hljs-keyword">mov</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">0</span><br><span class="hljs-symbol">    sub4s1:</span> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">byte</span> <span class="hljs-built_in">ptr</span> [<span class="hljs-number">160</span>*<span class="hljs-number">24</span>+<span class="hljs-built_in">si</span>],<span class="hljs-string">&#x27; &#x27;</span><br>            <span class="hljs-keyword">add</span> <span class="hljs-built_in">si</span>,<span class="hljs-number">2</span><br>            <span class="hljs-keyword">loop</span> sub4s1<br>            <br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ds</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">es</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">di</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">si</span><br>            <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br>            <span class="hljs-keyword">ret</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">int7cend:</span>  <span class="hljs-keyword">nop</span><br><br>code ends<br>end start<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ±‡ç¼–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ±‡ç¼–è¯­è¨€æ£€æµ‹ç‚¹</title>
    <link href="/2023/05/27/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E6%A3%80%E6%B5%8B%E7%82%B9/"/>
    <url>/2023/05/27/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E6%A3%80%E6%B5%8B%E7%82%B9/</url>
    
    <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€ç« -åŸºç¡€çŸ¥è¯†"><a href="#ç¬¬ä¸€ç« -åŸºç¡€çŸ¥è¯†" class="headerlink" title="ç¬¬ä¸€ç«  åŸºç¡€çŸ¥è¯†"></a>ç¬¬ä¸€ç«  åŸºç¡€çŸ¥è¯†</h2><h3 id="æ£€æµ‹ç‚¹-1-1"><a href="#æ£€æµ‹ç‚¹-1-1" class="headerlink" title="æ£€æµ‹ç‚¹ 1.1"></a>æ£€æµ‹ç‚¹ 1.1</h3><p><a href="https://freeimage.host/i/HrT21vs"><img src="https://iili.io/HrT21vs.md.png" alt="HrT21vs.md.png"></a></p><p>ï¼ˆ1ï¼‰<strong>13</strong></p><ul><li>å¯»å€èƒ½åŠ›ï¼šä¸€ä¸ªCPUæœ‰Næ ¹åœ°å€çº¿ï¼Œåˆ™è¿™ä¸ªCPUçš„åœ°å€æ€»çº¿çš„å®½åº¦ä¸ºNï¼Œæœ€å¤šå¯ä»¥å¯»æ‰¾2çš„Næ¬¡æ–¹ä¸ªå†…å­˜å•å…ƒã€‚</li><li>åœ°å€æ€»çº¿çš„å®½åº¦å†³å®šäº†CPU çš„å¯»å€èƒ½åŠ›ã€‚</li><li>\( 2^{N} &#x3D; 8KB &#x3D; 8*1024B &#x3D; 2^{13}B \)ï¼ŒNä¸ºåœ°å€æ€»çº¿å®½åº¦ï¼ŒN&#x3D;13</li></ul><p>ï¼ˆ2ï¼‰<strong>1024ï¼Œ0ï¼Œ1023</strong></p><ul><li>ä¸€ä¸ªå­˜å‚¨å•å…ƒå ä¸€ä¸ªå­—èŠ‚ï¼ˆå³1Bï¼‰ï¼Œæ•…1KBçš„å­˜å‚¨å™¨æœ‰1024ä¸ªå­˜å‚¨å•å…ƒï¼Œå­˜å‚¨å•å…ƒç¼–å·ä»0~1023ã€‚</li></ul><p>ï¼ˆ3ï¼‰<strong>8192ï¼Œ1024</strong></p><ul><li>1åƒå­—èŠ‚ï¼ˆKBï¼‰&#x3D; 1024å­—èŠ‚ï¼ˆBï¼‰</li><li>1å­—èŠ‚ï¼ˆByteï¼‰&#x3D; 8æ¯”ç‰¹ï¼ˆbitï¼‰</li></ul><p> ï¼ˆ4ï¼‰<strong>\( 2^{30}ï¼Œ 2^{20}ï¼Œ 2^{10}\)</strong></p><p> ï¼ˆ5ï¼‰<strong>64KBï¼Œ1MBï¼Œ16MBï¼Œ4GB</strong></p><ul><li>8080CPUåœ°å€æ€»çº¿å®½åº¦ä¸º16ï¼Œå¯»å€èƒ½åŠ›ä¸º\(2^{16} &#x3D; 2^6KB &#x3D; 64KB\)</li><li>å…¶ä½™åŒç†</li></ul><p>ï¼ˆ6ï¼‰<strong>1ï¼Œ1ï¼Œ2ï¼Œ2ï¼Œ4</strong></p><ul><li>8æ ¹æ•°æ®æ€»çº¿ä¸€æ¬¡å¯ä¼ é€ä¸€ä¸ª8ä½äºŒè¿›åˆ¶æ•°æ®ï¼ˆå³ä¸€ä¸ªå­—èŠ‚ï¼‰</li></ul><p>ï¼ˆ7ï¼‰<strong>512ï¼Œ256</strong></p><ul><li>8086CPUæ•°æ®æ€»çº¿16æ ¹ï¼Œä¸€æ¬¡å¯è¯»2ä¸ªå­—èŠ‚ ,1024&#x2F;2&#x3D;512</li></ul><p>ï¼ˆ8ï¼‰<strong>äºŒè¿›åˆ¶</strong></p><h2 id="ç¬¬äºŒç« -å¯„å­˜å™¨"><a href="#ç¬¬äºŒç« -å¯„å­˜å™¨" class="headerlink" title="ç¬¬äºŒç«  å¯„å­˜å™¨"></a>ç¬¬äºŒç«  å¯„å­˜å™¨</h2><h3 id="æ£€æµ‹ç‚¹-2-1"><a href="#æ£€æµ‹ç‚¹-2-1" class="headerlink" title="æ£€æµ‹ç‚¹ 2.1"></a>æ£€æµ‹ç‚¹ 2.1</h3><p><a href="https://freeimage.host/i/H4naDZb"><img src="https://iili.io/H4naDZb.md.png" alt="H4naDZb.md.png"></a></p><p>  (1)  æœ‰ç‚¹ç®€å•ï¼Œæ³¨æ„æº¢å‡ºå³å¯ï¼Œå¦‚ï¼šC5H+93H&#x3D;158Hï¼Œè€Œalåªæœ‰8ä½ï¼Œæ‰€ä»¥al&#x3D;58Hï¼Œä»è€ŒAX&#x3D;0058H</p><p>  (2)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mov</span> ax,<span class="hljs-number">2</span>     ;<span class="hljs-number">2</span>çš„<span class="hljs-number">1</span>æ¬¡æ–¹ = <span class="hljs-number">2</span><br><span class="hljs-attribute">add</span> ax,ax    ;<span class="hljs-number">2</span>çš„<span class="hljs-number">2</span>æ¬¡æ–¹ = <span class="hljs-number">2</span> + <span class="hljs-number">2</span> = <span class="hljs-number">4</span><br><span class="hljs-attribute">add</span> ax,ax    ;<span class="hljs-number">2</span>çš„<span class="hljs-number">3</span>æ¬¡æ–¹ = <span class="hljs-number">4</span> + <span class="hljs-number">4</span> = <span class="hljs-number">8</span><br><span class="hljs-attribute">add</span> ax,ax    ;<span class="hljs-number">2</span>çš„<span class="hljs-number">4</span>æ¬¡æ–¹ = <span class="hljs-number">8</span> + <span class="hljs-number">8</span> = <span class="hljs-number">16</span><br></code></pre></td></tr></table></figure><h3 id="æ£€æµ‹ç‚¹-2-2"><a href="#æ£€æµ‹ç‚¹-2-2" class="headerlink" title="æ£€æµ‹ç‚¹ 2.2"></a>æ£€æµ‹ç‚¹ 2.2</h3><p><a href="https://freeimage.host/i/H4pjm0v"><img src="https://iili.io/H4pjm0v.md.png" alt="H4pjm0v.md.png"></a></p><p>ï¼ˆ1ï¼‰<strong>00010Håˆ°1000FH</strong></p><ul><li>åŸºç¡€åœ°å€ï¼ˆæ®µåœ°å€*16ï¼‰+ åç§»åœ°å€ &#x3D; ç‰©ç†åœ°å€</li><li>åç§»åœ°å€16ä½ï¼Œå˜åŒ–èŒƒå›´ä¸º0~FFFFHï¼Œä»…ç”¨åç§»åœ°å€æœ€å¤šå¯å¯»å€64KB</li><li>ç»™å®šæ®µåœ°å€ä¸º0001Hï¼Œå¯»å€èŒƒå›´ä¸ºï¼ˆ0001HÃ—16ï¼‰+ 0åˆ°ï¼ˆ0001HÃ—16ï¼‰+FFFFHï¼Œå³å¯»å€èŒƒå›´ä¸º0010Håˆ°1000FH</li></ul><p>ï¼ˆ2ï¼‰<strong>æœ€å°ä¸º 1001H ï¼Œæœ€å¤§ä¸º 2000H</strong></p><ul><li>æ®µåœ°å€<em>16+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€ï¼Œå³SA</em>16+EA&#x3D;20000Hï¼›åç§»åœ°å€16ä½ï¼Œå˜åŒ–èŒƒå›´ä¸º0~FFFFHï¼› </li><li>å½“åç§»åœ°å€å–æœ€å¤§å€¼FFFFHæ—¶ï¼Œæ®µåœ°å€æœ€å°ï¼ŒSA&#x3D;(20000H-FFFFH)&#x2F;16&#x3D;1001Hï¼ˆ<strong>å–ä¸Šç•Œ</strong>ï¼‰</li><li>å½“åç§»åœ°å€å–æœ€å°å€¼0Hæ—¶ï¼Œæ®µåœ°å€æœ€å¤§ï¼ŒSA&#x3D;(20000H-0H)&#x2F;16&#x3D;2000Hã€‚</li></ul><p> æ€è€ƒï¼šå½“æ®µåœ°å€ç»™å®šä¸ºå°äº1001Hæˆ–å¤§äº2000Hæ—¶ï¼ŒCPUæ— è®ºæ€ä¹ˆå˜åŒ–åç§»åœ°å€éƒ½æ— æ³•å¯»åˆ°20000Hå•å…ƒã€‚</p><h3 id="æ£€æµ‹ç‚¹-2-3"><a href="#æ£€æµ‹ç‚¹-2-3" class="headerlink" title="æ£€æµ‹ç‚¹ 2.3"></a>æ£€æµ‹ç‚¹ 2.3</h3><p> <a href="https://freeimage.host/i/H4pvW0u"><img src="https://iili.io/H4pvW0u.md.png" alt="H4pvW0u.md.png"></a></p><ul><li><p>ä¸€å…±ä¿®æ”¹äº†4æ¬¡ã€‚</p></li><li><p>è¯»å– mov ax,bx æŒ‡ä»¤åï¼Œç¬¬ä¸€æ¬¡ä¿®æ”¹IP</p></li><li><p>è¯»å– sub ax,ax æŒ‡ä»¤åï¼Œç¬¬äºŒæ¬¡ä¿®æ”¹IP</p></li><li><p>è¯»å– jmp ax æŒ‡ä»¤åï¼Œç¬¬ä¸‰æ¬¡ä¿®æ”¹IP</p></li><li><p>æ‰§è¡Œ jmp ax æŒ‡ä»¤æ—¶ï¼Œç¬¬å››æ¬¡ä¿®æ”¹IPï¼Œæœ€åIP&#x3D;ax&#x3D;0</p><p><strong>ç•¥äº†ï¼Œæœ‰æ—¶é—´å†è¡¥ï¼Œæœ€è¿‘æœŸæœ«å¤ä¹ æ—¶é—´å¤ªç´§äº†</strong></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ±‡ç¼–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ±‡ç¼–è¯­è¨€çŸ¥è¯†ç‚¹å¤ä¹ </title>
    <link href="/2023/05/27/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E7%9F%A5%E8%AF%86%E7%82%B9%E5%A4%8D%E4%B9%A0/"/>
    <url>/2023/05/27/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E7%9F%A5%E8%AF%86%E7%82%B9%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p><a href="https://freeimage.host/i/H4BEW1R"><img src="https://iili.io/H4BEW1R.md.jpg" alt="H4BEW1R.md.jpg"></a></p><h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><ul><li><p><strong>ä½¿ç”¨debug Ã—Ã—.exeè°ƒè¯•æ—¶ï¼Œé¦–æ¬¡è¿›å…¥è°ƒè¯•ç•Œé¢æ—¶ï¼Œå¯„å­˜å™¨CXä¸­å­˜æ”¾çš„æ˜¯å¯æ‰§è¡Œæ–‡ä»¶é•¿åº¦ã€‚</strong></p></li><li><p>inc bx ç­‰ä»·äºadd bx,1</p></li><li><p>XORæ“ä½œæ˜¯ä¸€ç§é€»è¾‘è¿ç®—ç¬¦ï¼Œç”¨äºæ‰§è¡Œå¼‚æˆ–æ“ä½œï¼Œè‹±æ–‡å…¨ç§°æ˜¯ exclusive orã€‚XOR æ“ä½œçš„ç»“æœæ˜¯ä¸¤ä¸ªäºŒè¿›åˆ¶ä½ç›¸åŒåˆ™ç»“æœä¸º 0ï¼Œå¦åˆ™ç»“æœä¸º 1ã€‚ä¾‹å¦‚ XOR AX, AX å¯ä»¥å°† AX å¯„å­˜å™¨ä¸­çš„å€¼æ¸…é›¶ã€‚</p></li><li><p>åœ¨æ±‡ç¼–æºç¨‹åºä¸­ï¼Œæ•°æ®ä¸èƒ½ä»¥å­—æ¯å¼€å¤´</p></li><li><p>é‡åˆ°loopæŒ‡ä»¤æ—¶ï¼Œä½¿ç”¨På‘½ä»¤æ¥æ‰§è¡Œã€‚Debugå°±ä¼šè‡ªåŠ¨é‡å¤æ‰§è¡Œå¾ªç¯ä¸­çš„æŒ‡ä»¤ï¼Œç›´åˆ°(cx)&#x3D;0ä¸ºæ­¢</p></li><li><p>DOSBOXä¸­ï¼Œint 21 åé¢è¦ç”¨ p æŒ‡ä»¤æ¥ç»“æŸã€‚</p></li><li><p>dw 0123h,0456h,0789h,0abch,0defh,0fedh,0cbah,0987h</p><ul><li><strong>â€œdwâ€</strong>çš„å«ä¹‰æ˜¯å®šä¹‰å­—å‹æ•°æ®ã€‚dwå³â€œdefine wordâ€ã€‚</li><li>åœ¨è¿™é‡Œï¼Œä½¿ç”¨dwå®šä¹‰äº†8ä¸ªå­—å‹æ•°æ®ï¼ˆæ•°æ®ä¹‹é—´ä»¥é€—å·åˆ†éš”ï¼‰ï¼Œå®ƒä»¬æ‰€å çš„å†…å­˜ç©ºé—´çš„å¤§å°ä¸º16ä¸ªå­—èŠ‚</li></ul></li><li><p>db å­—èŠ‚å‹ï¼ŒddåŒå­—å‹</p></li><li><p>é€šè¿‡<strong>DS&#x3D;0B2D</strong>ï¼Œå¯ä»¥çŸ¥é“ç¨‹åºä»<strong>0B3D:0000</strong>å¼€å§‹å­˜æ”¾</p></li><li><p>NOT å®ç°æŒ‰ä½å–åï¼Œä¾‹å¦‚(AL)&#x3D;00010010Bï¼Œåˆ™ NOT AL ä½¿å¾—ï¼ˆALï¼‰&#x3D;11101101Bã€‚XOR ä¸ºå¼‚æˆ–è¿ç®—ã€‚</p></li><li><p><strong>var dd 252 dup(10)</strong></p><ul><li>var dd 252 dup(10) æ˜¯ä¸€ç§ä¼ªæŒ‡ä»¤ï¼Œç”¨äºåœ¨æ±‡ç¼–è¯­è¨€ä¸­å®šä¹‰ä¸€ä¸ªåä¸º var çš„å˜é‡ï¼Œå¹¶åˆå§‹åŒ–å®ƒä¸ºé‡å¤å‡ºç°çš„å€¼ã€‚</li><li>æ ¹æ®è¿™ä¸ªä¼ªæŒ‡ä»¤çš„è¯­æ³•ï¼Œ252 æ˜¯è¦é‡å¤çš„æ¬¡æ•°ï¼Œdup(10) è¡¨ç¤ºè¦é‡å¤çš„å€¼ä¸º 10ã€‚å› æ­¤ï¼Œè¯¥æŒ‡ä»¤çš„ä½œç”¨æ˜¯å°†å€¼ä¸º 10 çš„åŒå­—å‹æ•°æ®é‡å¤ 252 æ¬¡ï¼Œç„¶åå­˜å‚¨åˆ°åä¸º var çš„å˜é‡ä¸­ã€‚</li></ul></li><li><p>VAR3 DB â€˜HOW ARE YOU?â€™,â€™$â€™ï¼Œï¼Œï¼ŒVAR3 &#x3D; 13 å­—èŠ‚ (12 + 1)</p></li><li><p>VAR2 DW 5DUP(?),0ï¼Œï¼Œï¼Œï¼Œï¼ŒVAR2 &#x3D; 12 å­—èŠ‚ (5 * 2 + 2)</p></li><li><p>æ®µåœ°å€ï¼ˆSAï¼‰Segment Address å’Œ åç§»åœ°å€ï¼ˆEAï¼‰Effective Address</p></li><li><p>è¦ç”¨å…«ä½äºŒè¿›åˆ¶è¡¨ç¤º -9 çš„è¡¥ç ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œè®¡ç®—ï¼š</p><ul><li>å°† -9 çš„<strong>ç»å¯¹å€¼</strong>è½¬æ¢ä¸ºäºŒè¿›åˆ¶ã€‚9 çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º 00001001ã€‚</li><li>è·å– 9 çš„åç ã€‚å³å°†äºŒè¿›åˆ¶æ•°çš„æ¯ä¸€ä½å–åï¼Œå¾—åˆ° 11110110ã€‚</li><li>å°†åç åŠ  1 å¾—åˆ°è¡¥ç ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ11110110 + 1 &#x3D; 11110111ã€‚</li><li>å› æ­¤ï¼Œ-9 åœ¨å…«ä½äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºä¸­ä¸º 11110111ã€‚åå…­è¿›åˆ¶ä¸ºF7</li></ul></li><li><p>dec bx      ;decæŒ‡ä»¤å’ŒincæŒ‡ä»¤çš„åŠŸèƒ½ç›¸åï¼Œdec bx è¿›è¡Œæ“ä½œä¸ºï¼š(bx) &#x3D; (bx) - 1</p></li><li><p><strong>mulæ˜¯ä¹˜æ³•æŒ‡ä»¤</strong>ï¼Œä½¿ç”¨ mul åšä¹˜æ³•çš„æ—¶å€™ï¼š</p><ul><li>ç›¸ä¹˜çš„ä¸¤ä¸ªæ•°ï¼šè¦ä¹ˆéƒ½æ˜¯8ä½ï¼Œè¦ä¹ˆéƒ½æ˜¯16ä½ã€‚<ul><li>8 ä½ï¼šä¸€ä¸ªé»˜è®¤æ”¾åœ¨ ALä¸­ ï¼Œå¦ä¸€ä¸ªæ”¾åœ¨ 8ä½å¯„å­˜å™¨æˆ–å†…å­˜å­—èŠ‚å•å…ƒä¸­ï¼›</li><li>16 ä½ï¼š ä¸€ä¸ªé»˜è®¤æ”¾åœ¨AXä¸­ï¼Œå¦ä¸€ä¸ªæ”¾åœ¨16 ä½å¯„å­˜å™¨æˆ–å†…å­˜å­—å•å…ƒä¸­ã€‚</li></ul></li><li>ç»“æœ<ul><li>8ä½ï¼šAXä¸­ï¼›</li><li>16ä½ï¼šDXï¼ˆé«˜ä½ï¼‰å’ŒAXï¼ˆä½ä½ï¼‰ä¸­ã€‚</li></ul></li><li>æ ¼å¼å¦‚ä¸‹ï¼š<ul><li>mul reg</li><li>mul å†…å­˜å•å…ƒ</li></ul></li><li>æ¯”å¦‚ï¼šmul byte ptr ds:[0]<ul><li>å«ä¹‰ä¸ºï¼š (ax)&#x3D;(al) * ((ds) * 16+0)</li></ul></li><li>mul word ptr [bx+si+8]<ul><li>å«ä¹‰ä¸ºï¼š </li><li>(ax)&#x3D;(ax) * ((ds) * 16+(bx)+(si)+8)ç»“æœçš„ä½16ä½ï¼›</li><li>(dx)&#x3D;(ax) * ((ds) * 16+(bx)+(si)+8)ç»“æœçš„é«˜16ä½ï¼›</li></ul></li></ul></li><li><p>å°å†™å­—æ¯çš„ASCIIç èŒƒå›´61H-7AH </p></li><li><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼š ä»<strong>0000:0200è‡³0000:02FF</strong>çš„256ä¸ªå­—èŠ‚çš„ç©ºé—´æ‰€å¯¹åº”çš„ä¸­æ–­å‘é‡è¡¨é¡¹éƒ½æ˜¯ç©ºçš„ï¼Œæ“ä½œç³»ç»Ÿå’Œå…¶ä»–åº”ç”¨ç¨‹åºéƒ½ä¸å ç”¨</p></li><li><p>(IP) &#x3D; 5ï¼Œè¯´æ˜ ss:sp &#x3D; 5ï¼Œ</p></li></ul><h2 id="ç¬¬1ç« -åŸºç¡€çŸ¥è¯†"><a href="#ç¬¬1ç« -åŸºç¡€çŸ¥è¯†" class="headerlink" title="ç¬¬1ç«  åŸºç¡€çŸ¥è¯†"></a>ç¬¬1ç«  åŸºç¡€çŸ¥è¯†</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>æ¯ä¸€ç§å¾®å¤„ç†å™¨ï¼Œç”±äºç¡¬ä»¶è®¾è®¡å’Œå†…éƒ¨ç»“æ„çš„ä¸åŒï¼Œå°±éœ€è¦ç”¨ä¸åŒçš„ç”µå¹³è„‰å†²æ¥æ§åˆ¶ï¼Œä½¿å®ƒå·¥ä½œã€‚æ‰€ä»¥æ¯ä¸€ç§å¾®å¤„ç†å™¨éƒ½æœ‰è‡ªå·±çš„æœºå™¨æŒ‡ä»¤é›†ï¼Œä¹Ÿå°±æ˜¯æœºå™¨è¯­è¨€ã€‚</p></li><li><p>æ±‡ç¼–è¯­è¨€çš„ä¸»ä½“æ˜¯æ±‡ç¼–æŒ‡ä»¤ã€‚</p></li><li><p>æ±‡ç¼–æŒ‡ä»¤å’Œæœºå™¨æŒ‡ä»¤çš„å·®åˆ«åœ¨äºæŒ‡ä»¤çš„è¡¨ç¤ºæ–¹æ³•ä¸Šï¼Œæ±‡ç¼–æŒ‡ä»¤æ˜¯æœºå™¨æŒ‡ä»¤ä¾¿äºè®°å¿†çš„ä¹¦å†™æ ¼å¼ã€‚æ±‡ç¼–æŒ‡ä»¤æ˜¯æœºå™¨æŒ‡ä»¤çš„åŠ©è®°ç¬¦ã€‚</p></li><li><p>æ±‡ç¼–è¯­è¨€ç”±ä»¥ä¸‹3ç±»æŒ‡ä»¤ç»„æˆï¼š</p><ol><li>æ±‡ç¼–æŒ‡ä»¤ï¼šæœºå™¨ç çš„åŠ©è®°ç¬¦ï¼Œæœ‰å¯¹åº”çš„æœºå™¨ç ã€‚</li><li>ä¼ªæŒ‡ä»¤ï¼šç”±ç¼–è¯‘å™¨æ‰§è¡Œï¼Œæ²¡æœ‰å¯¹åº”çš„æœºå™¨ç ï¼Œè®¡ç®—æœºå¹¶ä¸æ‰§è¡Œã€‚</li><li>å…¶ä»–ç¬¦å·ï¼šå¦‚+ã€-ã€*ã€&#x2F;ç­‰ï¼Œç”±ç¼–è¯‘å™¨è¯†åˆ«ï¼Œæ²¡æœ‰å¯¹åº”çš„æœºå™¨ç ã€‚</li></ol></li><li><p>CPUè¦æƒ³è¿›è¡Œæ•°æ®çš„è¯»å†™ï¼Œå¿…é¡»å’Œå¤–éƒ¨å™¨ä»¶ï¼ˆæ ‡å‡†çš„è¯´æ³•æ˜¯èŠ¯ç‰‡ï¼‰è¿›è¡Œä¸‰ç±»ä¿¡æ¯çš„äº¤äº’ï¼š</p><ol><li>å­˜å‚¨å•å…ƒçš„åœ°å€ï¼ˆåœ°å€ä¿¡æ¯ï¼‰ï¼›</li><li>å™¨ä»¶çš„é€‰æ‹©ï¼Œè¯»æˆ–å†™å‘½ä»¤ï¼ˆæ§åˆ¶ä¿¡æ¯ï¼‰ï¼›</li><li>è¯»æˆ–å†™çš„æ•°æ®ï¼ˆæ•°æ®ä¿¡æ¯ï¼‰ã€‚</li></ol></li><li><p>CPUæ˜¯é€šè¿‡<strong>åœ°å€æ€»çº¿</strong>æ¥æŒ‡å®šå­˜å‚¨å™¨å•å…ƒçš„ã€‚åœ°å€æ€»çº¿ä¸Šèƒ½ä¼ é€å¤šå°‘ä¸ªä¸åŒçš„ä¿¡æ¯ï¼ŒCPUå°±å¯ä»¥å¯¹å¤šå°‘ä¸ªå­˜å‚¨å•å…ƒè¿›è¡Œå¯»å€ã€‚</p></li><li><p>CPUä¸å†…å­˜æˆ–å…¶å®ƒå™¨ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€æ˜¯é€šè¿‡<strong>æ•°æ®æ€»çº¿</strong>æ¥è¿›è¡Œçš„ã€‚æ•°æ®æ€»çº¿çš„å®½åº¦å†³å®šäº†CPUå’Œå¤–ç•Œçš„æ•°æ®ä¼ é€é€Ÿåº¦ã€‚</p></li><li><p>8088CPUæ•°æ®æ€»çº¿å®½åº¦ä¸º8ï¼Œ<strong>8086CPU</strong>æ•°æ®æ€»çº¿å®½åº¦ä¸º16ã€‚</p></li><li><p><strong>æ§åˆ¶æ€»çº¿</strong>ï¼šæœ‰å¤šå°‘æ ¹æ§åˆ¶æ€»çº¿ï¼Œå°±æ„å‘³ç€CPUæä¾›äº†å¯¹å¤–éƒ¨å™¨ä»¶çš„å¤šå°‘ç§æ§åˆ¶ã€‚æ‰€ä»¥ï¼Œæ§åˆ¶æ€»çº¿çš„å®½åº¦å†³å®šäº†CPUå¯¹å¤–éƒ¨å™¨ä»¶çš„æ§åˆ¶èƒ½åŠ›ã€‚</p></li></ol><ul><li><input checked="" disabled="" type="checkbox"> å‰é¢æ‰€è®²çš„å†…å­˜è¯»æˆ–å†™å‘½ä»¤æ˜¯ç”±å‡ æ ¹æ§åˆ¶çº¿ç»¼åˆå‘å‡ºçš„ï¼šå…¶ä¸­æœ‰ä¸€æ ¹åä¸ºè¯»ä¿¡å·è¾“å‡ºæ§åˆ¶çº¿è´Ÿè´£ç”±CPU å‘å¤–ä¼ é€è¯»ä¿¡å·ï¼ŒCPU å‘è¯¥æ§åˆ¶çº¿ä¸Šè¾“å‡º<strong>ä½ç”µå¹³</strong>è¡¨ç¤ºå°†è¦è¯»å–æ•°æ®ï¼›</li></ul><ol start="10"><li><p>bï¼šbitï¼ŒBï¼šByte </p></li><li><p>1B &#x3D; 8bï¼Œ1KB &#x3D; 1024Bï¼Œ1MB &#x3D; 1024KBï¼Œ1GB &#x3D; 1024MB </p></li><li><p>å°†å„ç±»å­˜å‚¨å™¨çœ‹ä½œä¸€ä¸ªé€»è¾‘å­˜å‚¨å™¨ï¼šï® æ‰€æœ‰çš„ç‰©ç†å­˜å‚¨å™¨è¢«çœ‹ä½œä¸€ä¸ªç”±è‹¥å¹²å­˜å‚¨å•å…ƒç»„æˆçš„é€»è¾‘å­˜å‚¨å™¨ï¼›æ¯ä¸ªç‰©ç†å­˜å‚¨å™¨åœ¨è¿™ä¸ªé€»è¾‘å­˜å‚¨å™¨ä¸­å æœ‰ä¸€ä¸ªåœ°å€æ®µï¼Œå³ä¸€æ®µåœ°å€ç©ºé—´ï¼› CPUåœ¨è¿™æ®µåœ°å€ç©ºé—´ä¸­è¯»å†™æ•°æ®ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ç›¸å¯¹åº”çš„ç‰©ç†å­˜å‚¨å™¨ä¸­è¯»å†™æ•°æ®ã€‚</p></li><li><p>8086PCæœºçš„å†…å­˜åœ°å€ç©ºé—´åˆ†é…ï¼š<a href="https://freeimage.host/cn"><img src="https://iili.io/H4BhK0b.png" alt="H4BhK0b.png"></a></p></li><li><p>å›¾ 1.9 å‘Šè¯‰æˆ‘ä»¬ï¼Œä»åœ°å€ 0 ~ 9FFFF çš„å†…å­˜å•å…ƒä¸­è¯»å–æ•°æ®ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨è¯»å–ä¸»éšæœºå­˜å‚¨å™¨ä¸­çš„æ•°æ®ï¼›å‘åœ°å€ A0000 ~ BFFFF çš„å†…å­˜å•å…ƒä¸­å†™æ•°æ®ï¼Œå°±æ˜¯å‘æ˜¾å­˜ä¸­å†™å…¥æ•°æ®,è¿™äº›æ•°æ®ä¼šè¢«æ˜¾ç¤ºå¡è¾“å‡ºåˆ°æ˜¾ç¤ºå™¨ä¸Šï¼›æˆ‘ä»¬å‘åœ°å€ CO00O ~ FFFFF çš„å†…å­˜å•å…ƒä¸­å†™å…¥æ•°æ®çš„æ“ä½œæ˜¯<em>æ— æ•ˆçš„</em>ï¼Œå› ä¸ºè¿™ç­‰äºæ”¹å†™åªè¯»å­˜å‚¨å™¨ä¸­çš„å†…å®¹ã€‚</p></li><li><p>å†…å­˜åœ°å€ç©ºé—´ï¼šæœ€ç»ˆè¿è¡Œç¨‹åºçš„æ˜¯CPUï¼Œæˆ‘ä»¬ç”¨æ±‡ç¼–ç¼–ç¨‹çš„æ—¶å€™ï¼Œå¿…é¡»è¦ä»CPUè§’åº¦è€ƒè™‘é—®é¢˜ã€‚  å¯¹CPUæ¥è®²ï¼Œç³»ç»Ÿä¸­çš„æ‰€æœ‰å­˜å‚¨å™¨ä¸­çš„å­˜å‚¨å•å…ƒéƒ½å¤„äºä¸€ä¸ªç»Ÿä¸€çš„é€»è¾‘å­˜å‚¨å™¨ä¸­ï¼Œå®ƒçš„å®¹é‡å—CPUå¯»å€èƒ½åŠ›çš„é™åˆ¶ã€‚è¿™ä¸ªé€»è¾‘å­˜å‚¨å™¨å³æ˜¯æˆ‘ä»¬æ‰€è¯´çš„<em>å†…å­˜åœ°å€ç©ºé—´</em>ã€‚ğŸ˜­</p></li></ol><h2 id="ç¬¬2ç« -å¯„å­˜å™¨"><a href="#ç¬¬2ç« -å¯„å­˜å™¨" class="headerlink" title="ç¬¬2ç«  å¯„å­˜å™¨"></a>ç¬¬2ç«  å¯„å­˜å™¨</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-1"><a href="#åŸºç¡€æ¦‚å¿µ-1" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>8086CPUæœ‰14ä¸ªå¯„å­˜å™¨ï¼Œå®ƒä»¬çš„åç§°ä¸ºï¼šAXã€BXã€CXã€DXã€SIã€DIã€SPã€BPã€IPã€CSã€SSã€DSã€ESã€PSWã€‚</p><blockquote><p>AXï¼šaccumulator registerï¼Œç´¯åŠ å™¨å¯„å­˜å™¨</p><p>BXï¼š base registerï¼ŒåŸºæ•°å¯„å­˜å™¨</p><p>CXï¼š count registerï¼Œè®¡æ•°å¯„å­˜å™¨ </p><p>DXï¼šdata registerï¼Œé€šç”¨æ•°æ®å¯„å­˜å™¨</p><p>SIï¼šsource indexï¼Œæºå˜å€å¯„å­˜å™¨</p><p>DIï¼šdestination indexï¼Œç›®çš„å˜å€å¯„å­˜å™¨</p><p>SPï¼šstack pointerï¼Œå †æ ˆæŒ‡é’ˆå¯„å­˜å™¨</p><p>BPï¼šbase pointerï¼ŒåŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼ŒæŒ‡ç¤ºå †æ ˆæ®µä¸­ä¸€ä¸ªæ•°æ®åŒºçš„åŸºå€ä½ç½®ï¼Œé€šå¸¸ä¸SSé…å¯¹</p><p>IPï¼šinstruction pointerï¼Œç æ®µåœ°å€æŒ‡é’ˆå¯„å­˜å™¨</p><p>CSï¼šcode segmentï¼Œä»£ç æ®µå¯„å­˜å™¨</p><p>SSï¼šstack segmentï¼Œå †æ ˆæ®µ~ï¼Œå­˜æ”¾å½“å‰å †æ ˆæ®µçš„æ®µåœ°å€ï¼Œä¸€èˆ¬å’ŒSPè¿ç”¨</p><p>DSï¼šdata segmentï¼Œæ•°æ®æ®µ~ï¼Œå­˜æ”¾å½“å‰æ•°æ®æ®µçš„æ®µåœ°å€</p><p>ESï¼šextra segmentï¼Œé™„åŠ æ®µ~</p><p>PSWï¼šprogram state wordï¼Œæ ‡å¿—~</p></blockquote></li><li><p>8086CPUæ‰€æœ‰çš„å¯„å­˜å™¨éƒ½æ˜¯16ä½çš„ï¼Œå¯ä»¥å­˜æ”¾ä¸¤ä¸ªå­—èŠ‚ã€‚</p></li><li><p>AXã€BXã€CXã€DX é€šå¸¸ç”¨æ¥å­˜æ”¾ä¸€èˆ¬æ€§æ•°æ®ï¼Œè¢«ç§°ä¸ºé€šç”¨å¯„å­˜å™¨ã€‚</p></li><li><p>ä¸€ä¸ª16ä½å¯„å­˜å™¨æ‰€èƒ½å­˜å‚¨çš„æ•°æ®çš„æœ€å¤§å€¼ä¸ºå¤šå°‘ï¼Ÿ<br>  ç­”æ¡ˆï¼š2^16-1&#x3D;65535ã€‚</p></li><li><p>æ±‡ç¼–æŒ‡ä»¤ä¸åŒºåˆ†å¤§å°å†™ã€‚</p></li><li><p>8086æœ‰20ä½åœ°å€æ€»çº¿ï¼Œå¯ä¼ é€20ä½åœ°å€ï¼Œå¯»å€èƒ½åŠ›ä¸º1Mã€‚</p></li><li><p>åœ°å€åŠ æ³•å™¨å¦‚ä½•å®Œæˆæ®µåœ°å€Ã—16çš„è¿ç®—ï¼Ÿå°±æ˜¯å°†ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜æ”¾çš„æ®µåœ°å€å·¦ç§»4ä½ã€‚</p></li><li><p>â€œæ®µåœ°å€Ã—16+åç§»åœ°å€&#x3D;ç‰©ç†åœ°å€â€çš„æœ¬è´¨å«ä¹‰æ˜¯ï¼š CPU åœ¨è®¿é—®å†…å­˜æ—¶ï¼Œç”¨ä¸€ä¸ªåŸºç¡€åœ°å€(æ®µåœ°å€x16)å’Œä¸€ä¸ªç›¸å¯¹äºåŸºç¡€åœ°å€çš„åç§»åœ°å€ç›¸åŠ ï¼Œç»™å‡ºå†…å­˜å•å…ƒçš„ç‰©ç†åœ°å€ã€‚</p></li><li><p>æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼šæ®µåœ°å€âœ–16 å¿…ç„¶æ˜¯ 16 çš„å€æ•°ï¼Œæ‰€ä»¥ä¸€ä¸ªæ®µçš„èµ·å§‹åœ°å€ä¹Ÿä¸€å®šæ˜¯ 16 çš„å€æ•°ï¼›åç§»åœ°å€ä¸º 16 ä½ï¼Œ16 ä½åœ°å€çš„å¯»å€èƒ½åŠ›ä¸º 64KBï¼Œæ‰€ä»¥<em>ä¸€ä¸ªæ®µçš„é•¿åº¦æœ€å¤§ä¸º 64KB</em>ã€‚</p></li><li><p>CSå’ŒIPæ˜¯8086CPUä¸­æœ€å…³é”®çš„å¯„å­˜å™¨ï¼Œå®ƒä»¬æŒ‡ç¤ºäº†CPUå½“å‰è¦è¯»å–æŒ‡ä»¤çš„åœ°å€ã€‚</p></li><li><p>8086PCå·¥ä½œè¿‡ç¨‹çš„ç®€è¦æè¿°</p><ol><li>ä»CS:IPæŒ‡å‘å†…å­˜å•å…ƒè¯»å–æŒ‡ä»¤ï¼Œè¯»å–çš„æŒ‡ä»¤è¿›å…¥æŒ‡ä»¤ç¼“å†²å™¨ï¼›</li><li>IP &#x3D; IP + æ‰€è¯»å–æŒ‡ä»¤çš„é•¿åº¦ï¼Œä»è€ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼›</li><li>æ‰§è¡ŒæŒ‡ä»¤ã€‚ è½¬åˆ°æ­¥éª¤ ï¼ˆ1ï¼‰ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚</li></ol></li><li><p><strong>movæŒ‡ä»¤ä¸èƒ½ç”¨äºè®¾ç½®CSã€IPçš„å€¼ï¼Œ8086CPUæ²¡æœ‰æä¾›è¿™æ ·çš„åŠŸèƒ½ã€‚</strong></p></li></ol><h2 id="ç¬¬3ç« -å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰"><a href="#ç¬¬3ç« -å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰" class="headerlink" title="ç¬¬3ç«  å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰"></a>ç¬¬3ç«  å¯„å­˜å™¨ï¼ˆå†…å­˜è®¿é—®ï¼‰</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-2"><a href="#åŸºç¡€æ¦‚å¿µ-2" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li>8086CPUä¸æ”¯æŒå°†æ•°æ®ç›´æ¥é€å…¥æ®µå¯„å­˜å™¨çš„æ“ä½œï¼Œdsæ˜¯ä¸€ä¸ªæ®µå¯„å­˜å™¨ã€‚ï¼ˆç¡¬ä»¶è®¾è®¡çš„é—®é¢˜ï¼‰</li></ol><ul><li>mov ds,1000H æ˜¯éæ³•çš„ã€‚</li><li>æ•°æ® â†’ ä¸€èˆ¬çš„å¯„å­˜å™¨ â†’ æ®µå¯„å­˜å™¨</li></ul><ol start="2"><li><p><strong>å­—åœ¨å†…å­˜ä¸­å­˜å‚¨æ—¶ ï¼Œè¦ç”¨ä¸¤ä¸ªåœ°å€è¿ç»­çš„å†…å­˜å•å…ƒæ¥å­˜æ”¾ï¼Œå­—çš„ä½ä½å­—èŠ‚å­˜æ”¾åœ¨ä½åœ°å€å•å…ƒä¸­ï¼Œé«˜ä½å­—èŠ‚å­˜æ”¾å†é«˜åœ°å€å•å…ƒä¸­ã€‚</strong></p></li><li><p>åˆæ³•æ ¼å¼ï¼š</p></li></ol><ul><li>mov å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨&#x2F;å†…å­˜å•å…ƒ&#x2F;æ®µå¯„å­˜å™¨&#x2F;ç«‹å³æ•°</li><li>mov å†…å­˜å•å…ƒï¼Œå¯„å­˜å™¨&#x2F;æ®µå¯„å­˜å™¨&#x2F;ç«‹å³æ•°</li><li>mov æ®µå¯„å­˜å™¨ï¼Œå¯„å­˜å™¨&#x2F;å†…å­˜å•å…ƒ<br>~æ³¨æ„ï¼š</li><li>movæŒ‡ä»¤ä¸­çš„ç›®çš„æ“ä½œæ•°ä¸èƒ½æ˜¯ç«‹å³æ•°ã€IPå’ŒCSå¯„å­˜å™¨ï¼›</li><li>movæŒ‡ä»¤ä¸­ä¸å…è®¸åœ¨ä¸¤ä¸ªå­˜å‚¨å•å…ƒä¹‹é—´ç›´æ¥ä¼ é€æ•°æ®ï¼›</li><li>movæŒ‡ä»¤ä¸­ä¸å…è®¸åœ¨ä¸¤ä¸ªæ®µå¯„å­˜å™¨ä¹‹é—´ç›´æ¥ä¼ é€æ•°æ®ï¼›</li><li>movæŒ‡ä»¤ä¸­ç«‹å³æ•°ä¸èƒ½ç›´æ¥ä¼ é€ç»™æ®µå¯„å­˜å™¨ï¼ˆCSã€DSã€SSã€ESï¼‰ã€‚</li></ul><ol start="4"><li>æ ˆï¼š</li></ol><ul><li><p>8086CPUæä¾›äº†æ ˆæ“ä½œæœºåˆ¶ï¼Œæ–¹æ¡ˆå¦‚ä¸‹ï¼šåœ¨SSï¼ŒSPä¸­å­˜æ”¾æ ˆé¡¶çš„æ®µåœ°å€å’Œåç§»åœ°å€ï¼›æä¾›å…¥æ ˆå’Œå‡ºæ ˆæŒ‡ä»¤ï¼Œä»–ä»¬æ ¹æ®SS:SPæŒ‡ç¤ºçš„åœ°å€ï¼ŒæŒ‰ç…§æ ˆçš„æ–¹å¼è®¿é—®å†…å­˜å•å…ƒã€‚</p></li><li><p><strong>pushæŒ‡ä»¤çš„æ‰§è¡Œæ­¥éª¤</strong>ï¼š</p><ol><li>SP&#x3D;SP-2ï¼›</li><li>å‘SS:SPæŒ‡å‘çš„å­—å•å…ƒä¸­é€å…¥æ•°æ®ã€‚</li></ol></li><li><p><strong>popæŒ‡ä»¤çš„æ‰§è¡Œæ­¥éª¤</strong>ï¼š</p><ol><li>ä»SS:SPæŒ‡å‘çš„å­—å•å…ƒä¸­è¯»å–æ•°æ®ï¼›</li><li>SP&#x3D;SP+2ã€‚</li></ol></li><li><p>ä»»æ„æ—¶åˆ»ï¼ŒSS:SPæŒ‡å‘æ ˆé¡¶å…ƒç´ ã€‚</p></li><li><p>8086CPUåªè®°å½•æ ˆé¡¶ï¼Œæ ˆç©ºé—´çš„å¤§å°æˆ‘ä»¬è¦è‡ªå·±ç®¡ç†ã€‚</p></li><li><p>ç”¨æ ˆæ¥æš‚å­˜ä»¥åéœ€è¦æ¢å¤çš„å¯„å­˜å™¨çš„å†…å®¹æ—¶ ï¼Œå¯„å­˜å™¨å‡ºæ ˆçš„é¡ºåºè¦å’Œ å…¥æ ˆçš„é¡ºåºç›¸åã€‚</p></li><li><p>pushã€popå®è´¨ä¸Šæ˜¯ä¸€ç§å†…å­˜ä¼ é€æŒ‡ä»¤ï¼Œæ³¨æ„å®ƒä»¬çš„çµæ´»åº”ç”¨ã€‚</p></li></ul><ol start="5"><li><p>ä¸€ä¸ªæ ˆæ®µçš„å®¹é‡æœ€å¤§ä¸º64KBã€‚</p></li><li><p>å¦‚æœæˆ‘ä»¬å°†10000H~1FFFFHè¿™æ®µç©ºé—´å½“ä½œæ ˆæ®µï¼Œåˆå§‹çŠ¶æ€æ˜¯ç©ºçš„ï¼Œæ­¤æ—¶ï¼ŒSS&#x3D;1000Hï¼ŒSP&#x3D;ï¼Ÿã€ã€ã€ç­”æ¡ˆï¼š0ï¼Œï¼ˆSPåŸæ¥ä¸ºFFFEHï¼ŒåŠ 2åSP&#x3D;0ï¼Œæ‰€ä»¥ï¼Œå½“æ ˆä¸ºç©ºçš„æ—¶å€™ï¼ŒSS&#x3D;1000Hï¼ŒSP&#x3D;0ã€‚ï¼‰</p></li><li><p><strong>æˆ‘ä»¬å¯ä»¥å°†ä¸€æ®µå†…å­˜å®šä¹‰ä¸ºä¸€ä¸ªæ®µï¼Œç”¨ä¸€ä¸ªæ®µåœ°å€æŒ‡ç¤ºæ®µï¼Œç”¨åç§»åœ°å€è®¿é—®æ®µå†…çš„å•å…ƒã€‚è¿™å®Œå…¨æ˜¯æˆ‘ä»¬è‡ªå·±çš„å®‰æ’ã€‚</strong></p><ul><li>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ®µå­˜æ”¾æ•°æ®ï¼Œå°†å®ƒå®šä¹‰ä¸ºâ€œæ•°æ®æ®µâ€</li><li>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ®µå­˜æ”¾ä»£ç ï¼Œå°†å®ƒå®šä¹‰ä¸ºâ€œä»£ç æ®µâ€</li><li>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ®µå½“ä½œæ ˆï¼Œå°†å®ƒå®šä¹‰ä¸ºâ€œæ ˆæ®µâ€</li></ul><p> æˆ‘ä»¬å¯ä»¥è¿™æ ·å®‰æ’ï¼Œä½†è‹¥è¦è®©CPUæŒ‰ç…§æˆ‘ä»¬çš„å®‰æ’æ¥è®¿é—®è¿™äº›æ®µï¼Œå°±è¦ï¼š</p><ul><li>å¯¹äºæ•°æ®æ®µï¼Œå°†å®ƒçš„æ®µåœ°å€æ”¾åœ¨ DSä¸­ï¼Œç”¨movã€addã€subç­‰è®¿é—®å†…å­˜å•å…ƒçš„æŒ‡ä»¤æ—¶ï¼ŒCPUå°±å°†æˆ‘ä»¬å®šä¹‰çš„æ•°æ®æ®µä¸­çš„å†…å®¹å½“ä½œæ•°æ®æ¥è®¿é—®ï¼›</li><li>å¯¹äºä»£ç æ®µï¼Œå°†å®ƒçš„æ®µåœ°å€æ”¾åœ¨ CSä¸­ï¼Œå°†æ®µä¸­ç¬¬ä¸€æ¡æŒ‡ä»¤çš„åç§»åœ°å€æ”¾åœ¨IPä¸­ï¼Œè¿™æ ·CPUå°±å°†æ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„ä»£ç æ®µä¸­çš„æŒ‡ä»¤ï¼›</li><li>å¯¹äºæ ˆæ®µï¼Œå°†å®ƒçš„æ®µåœ°å€æ”¾åœ¨SSä¸­ï¼Œå°†æ ˆé¡¶å•å…ƒçš„åç§»åœ°ç½®æ”¾åœ¨ SP ä¸­ï¼Œè¿™æ ·CPUåœ¨éœ€è¦è¿›è¡Œæ ˆæ“ä½œçš„æ—¶å€™ï¼Œæ¯”å¦‚æ‰§è¡Œ pushã€pop æŒ‡ä»¤ç­‰ï¼Œå°±å°†æˆ‘ä»¬å®šä¹‰çš„æ ˆæ®µå½“ä½œæ ˆç©ºé—´æ¥ç”¨ã€‚</li><li>å¯è§ï¼Œä¸ç®¡æˆ‘ä»¬å¦‚ä½•å®‰æ’ ï¼ŒCPU å°†å†…å­˜ä¸­çš„æŸæ®µå†…å­˜å½“ä½œä»£ç  ï¼Œæ˜¯å› ä¸ºCS:IPæŒ‡å‘äº†é‚£é‡Œï¼›CPUå°†æŸæ®µå†…å­˜å½“ä½œæ ˆ ï¼Œæ˜¯å› ä¸º SS:SP æŒ‡å‘äº†é‚£é‡Œã€‚</li></ul></li></ol><h2 id="ç¬¬4ç« -ç¬¬ä¸€ä¸ªç¨‹åº"><a href="#ç¬¬4ç« -ç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="ç¬¬4ç«  ç¬¬ä¸€ä¸ªç¨‹åº"></a>ç¬¬4ç«  ç¬¬ä¸€ä¸ªç¨‹åº</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-3"><a href="#åŸºç¡€æ¦‚å¿µ-3" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>DOSç³»ç»Ÿä¸­.EXEæ–‡ä»¶ä¸­çš„ç¨‹åºçš„åŠ è½½è¿‡ç¨‹ï¼š<br><a href="https://freeimage.host/i/H6suidv"><img src="https://iili.io/H6suidv.md.png" alt="H6suidv.md.png"></a></p></li><li><p>ç¨‹åºåŠ è½½åï¼Œdsä¸­å­˜æ”¾ç€ç¨‹åºæ‰€åœ¨å†…å­˜åŒºçš„æ®µåœ°å€ï¼Œè¿™ä¸ªå†…å­˜åŒºçš„åç§»åœ°å€ä¸º 0 ï¼Œåˆ™<strong>ç¨‹åºæ‰€åœ¨çš„å†…å­˜åŒºçš„åœ°å€ä¸ºï¼šds:0</strong>ï¼›è¿™ä¸ªå†…å­˜åŒºçš„å‰256 ä¸ªå­—èŠ‚ä¸­å­˜æ”¾çš„æ˜¯PSPï¼Œdosç”¨æ¥å’Œç¨‹åºè¿›è¡Œé€šä¿¡ã€‚ ä» 256å­—èŠ‚å¤„å‘åçš„ç©ºé—´å­˜æ”¾çš„æ˜¯ç¨‹åºã€‚</p></li><li><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä»dsä¸­å¯ä»¥å¾—åˆ°PSPçš„æ®µåœ°å€SAï¼ŒPSPçš„åç§»åœ°å€ä¸º 0ï¼Œåˆ™ç‰©ç†åœ°å€ä¸ºSAÃ—16+0ã€‚å› ä¸ºPSPå 256ï¼ˆ100Hï¼‰å­—èŠ‚ï¼Œæ‰€ä»¥<strong>ç¨‹åºçš„ç‰©ç†åœ°å€</strong>æ˜¯ï¼š<em>SAÃ—16+0+256&#x3D; SAÃ—16+16Ã—16&#x3D;ï¼ˆSA+16ï¼‰Ã—16+0</em>å¯ç”¨æ®µåœ°å€å’Œåç§»åœ°å€è¡¨ç¤ºä¸ºï¼š<strong>SA+10:0</strong>ã€‚</p><ul><li>å¦‚ï¼šDS&#x3D;129Eï¼Œåˆ™PSPçš„çš„åœ°å€ä¸º129E:0ï¼Œç¨‹åºçš„åœ°å€ä¸º12AE:0ã€‚</li></ul></li><li><p>ä¸€ä¸ªæºç¨‹åºä»å†™å‡ºåˆ°æ‰§è¡Œçš„è¿‡ç¨‹ï¼š<strong>ç¼–å†™ã€ç¼–è¯‘ã€è¿æ¥ã€æ‰§è¡Œ</strong>ï¼ˆä½¿ç”¨æ±‡ç¼–è¯­è¨€ç¼–è¯‘ç¨‹åºå¯¹æºç¨‹åºæ–‡ä»¶ä¸­çš„æºç¨‹åºè¿›è¡Œç¼–è¯‘ï¼Œäº§ç”Ÿç›®æ ‡æ–‡ä»¶ï¼›å†ç”¨è¿æ¥ç¨‹åºå¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡Œè¿æ¥ï¼Œç”Ÿæˆå¯åœ¨æ“ä½œç³»ç»Ÿä¸­ç›´æ¥è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ï¼‰</p></li><li><p>è¯´æ˜<strong>ä¼ªæŒ‡ä»¤å’Œæ±‡ç¼–æŒ‡ä»¤çš„åŒºåˆ«</strong>ï¼šæ±‡ç¼–æŒ‡ä»¤æ˜¯æœ‰å¯¹åº”çš„æœºå™¨ç çš„æŒ‡ä»¤ï¼Œå¯ä»¥è¢«ç¼–è¯‘ä¸ºæœºå™¨æŒ‡ä»¤ï¼Œæœ€ç»ˆä¸ºCPUæ‰€æ‰§è¡Œã€‚è€Œä¼ªæŒ‡ä»¤æ²¡æœ‰å¯¹åº”çš„æœºå™¨æŒ‡ä»¤ï¼Œæœ€ç»ˆä¸è¢«CPUæ‰€æ‰§è¡Œï¼Œæ˜¯ç”±ç¼–è¯‘å™¨æ¥æ‰§è¡Œçš„ã€‚</p></li><li><p>è¯´æ˜æ±‡ç¼–è¯­è¨€ç¨‹åºä¸­<strong>æ ‡å·çš„ä½œç”¨</strong>ï¼šæ±‡ç¼–æºç¨‹åºä¸­ä¸€ä¸ªæ ‡å·æŒ‡ä»£äº†ä¸€ä¸ªåœ°å€ï¼Œæ¯”å¦‚codesgåœ¨segmentçš„å‰é¢ï¼Œä½œä¸€ä¸ªæ®µçš„åç§°ï¼Œè¿™ä¸ªæ®µçš„åç§°æœ€ç»ˆå°†è¢«ç¼–è¯‘ã€è¿æ¥ç¨‹åºå¤„ç†ä¸ºä¸€ä¸ªæ®µçš„æ®µåœ°å€ã€‚</p></li></ol><h2 id="ç¬¬5ç« -bx-å’ŒloopæŒ‡ä»¤"><a href="#ç¬¬5ç« -bx-å’ŒloopæŒ‡ä»¤" class="headerlink" title="ç¬¬5ç«  [bx]å’ŒloopæŒ‡ä»¤"></a>ç¬¬5ç«  [bx]å’ŒloopæŒ‡ä»¤</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-4"><a href="#åŸºç¡€æ¦‚å¿µ-4" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>æè¿°æ€§ç¬¦å·â€œ()â€ï¼Œä¾‹å¦‚ï¼šå¯¹äºpush axçš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ¥æè¿°ï¼š</p><ul><li>(sp) &#x3D; (sp)-2 </li><li>((ss) * 16ï¼‹(sp))&#x3D;(ax)</li></ul></li><li><p>(2000:0)ã€((ds):1000H)ç­‰æ˜¯é”™è¯¯çš„ç”¨æ³•</p></li><li><p>(ax)ã€(ds)ã€(al)ã€(2000H)ã€((ds) * 16+(bx))ç­‰æ˜¯æ­£ç¡®çš„ç”¨æ³•</p></li><li><p>æŒ‡ä»¤çš„æ ¼å¼æ˜¯ï¼šloop æ ‡å·ï¼ŒCPU æ‰§è¡ŒloopæŒ‡ä»¤çš„æ—¶å€™ï¼Œè¦è¿›è¡Œä¸¤æ­¥æ“ä½œï¼š</p><ol><li>(cx)&#x3D;(cx)-1ï¼›</li><li>åˆ¤æ–­cxä¸­çš„å€¼ï¼Œä¸ä¸ºé›¶åˆ™è½¬è‡³æ ‡å·å¤„æ‰§è¡Œç¨‹åºï¼Œå¦‚æœä¸ºé›¶åˆ™å‘ä¸‹æ‰§è¡Œã€‚</li></ol></li><li><p>ffff:0006 å•å…ƒä¸­çš„æ•°æ˜¯ä¸€ä¸ªå­—èŠ‚å‹çš„æ•°æ®ï¼ŒèŒƒå›´åœ¨0~255ä¹‹é—´</p></li><li><p><strong>æˆ‘ä»¬åœ¨Debugä¸­å†™è¿‡ç±»ä¼¼çš„æŒ‡ä»¤ï¼š<code>mov ax,[0]</code> è¡¨ç¤ºå°†ds:0å¤„çš„æ•°æ®é€å…¥axä¸­ã€‚ä½†æ˜¯åœ¨æ±‡ç¼–æºç¨‹åºä¸­ï¼ŒæŒ‡ä»¤<code>mov ax,[0]</code>è¢«ç¼–è¯‘å™¨å½“ä½œæŒ‡ä»¤<code>mov ax,0</code>å¤„ç†ã€‚</strong></p></li><li><p>ä¸ºé˜²æ­¢ä¸Šè¿°æƒ…å†µå‘ç”Ÿï¼Œåœ¨æºç¨‹åºä¸­ï¼Œå¯é‡‡ç”¨ä¸¤ç§æ–¹æ³•è®¿é—®2000:0å•å…ƒï¼š</p></li></ol><ul><li><p>æ–¹æ³•ä¸€ï¼š </p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">2000h</span> <br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span> <br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0</span> <br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,[<span class="hljs-built_in">bx</span>]<br></code></pre></td></tr></table></figure></li><li><p>æ–¹æ³•äºŒï¼š</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">2000h</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span>    <br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">ds</span>:[<span class="hljs-number">0</span>]                 ä¸€èˆ¬ç”¨ç¬¬äºŒç§æ–¹æ³•<br></code></pre></td></tr></table></figure></li></ul><ol start="8"><li><p>DOSæ–¹å¼ä¸‹ï¼Œä¸€èˆ¬æƒ…å†µï¼Œ 0:200 ~ 0:2FF ç©ºé—´ä¸­æ²¡æœ‰ç³»ç»Ÿæˆ–å…¶ä»–ç¨‹åºçš„æ•°æ®æˆ–ä»£ç ï¼›ä»¥åï¼Œæˆ‘ä»¬éœ€è¦ç›´æ¥å‘ä¸€æ®µå†…å­˜ä¸­å†™å…¥å†…å®¹æ—¶ï¼Œå°±ä½¿ç”¨0:200 ~ 0:2FFè¿™æ®µç©ºé—´ã€‚</p></li><li><p>åˆ©ç”¨æ ˆå¯¹CXå¯„å­˜å™¨å†…å®¹è¿›è¡Œä¿æŠ¤pushå’Œæ¢å¤popå¯ä»¥å®ç°å¤šé‡loopå¾ªç¯ã€‚å¦‚ï¼š</p></li></ol><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>, m<br><span class="hljs-symbol">s1:</span>          <span class="hljs-comment">;å¾ªç¯ä½“1</span><br> <span class="hljs-keyword">push</span> <span class="hljs-built_in">cx</span><br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,n<br><span class="hljs-symbol">s2:</span>          <span class="hljs-comment">;å¾ªç¯ä½“2</span><br> <span class="hljs-keyword">loop</span> s2<br> <span class="hljs-keyword">pop</span> <span class="hljs-built_in">cx</span><br> <span class="hljs-keyword">loop</span> s1<br></code></pre></td></tr></table></figure><h3 id="ç¨‹åº"><a href="#ç¨‹åº" class="headerlink" title="ç¨‹åº"></a>ç¨‹åº</h3><ol><li>å°†å†…å­˜ffff:0<del>ffff:bæ®µå•å…ƒä¸­çš„æ•°æ®æ‹·è´åˆ° 0:200</del>0:20bå•å…ƒä¸­ã€‚</li></ol><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br><br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,offffh<br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0020h</span><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>,<span class="hljs-built_in">ax</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span><br><br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">12</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">    s:</span>  <span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-built_in">ds</span>:[<span class="hljs-built_in">bx</span>]<br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">es</span>:[<span class="hljs-built_in">bx</span>],<span class="hljs-built_in">al</span>    <span class="hljs-comment">;alä½œä¸ºä¸­è½¬å¯„å­˜å™¨</span><br><br>        <span class="hljs-keyword">inc</span> <span class="hljs-built_in">bx</span><br>        <span class="hljs-keyword">loop</span> s<br>        <br>        <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br>        <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><br>code ends<br>end start<br><br></code></pre></td></tr></table></figure><ol start="2"><li>ç¼–å†™ç¨‹åºç‰‡æ–­ï¼Œåˆ©ç”¨ loop æŒ‡ä»¤ï¼Œå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—å‰ 9 ä¸ªæ•°å­— 1ã€1ã€2ã€3ã€5ã€8ã€13ã€21ã€34 çš„æ±‚å’Œï¼Œå¹¶å°†æ±‚å’Œç»“æœä¿å­˜åˆ°å†…å­˜å­—å•å…ƒ 0:200 ä¸­</li></ol><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol"></span><br><span class="hljs-symbol">start:</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span>    <span class="hljs-comment">;axä¸­çš„å€¼ä¾æ¬¡ä¸º1ã€1ã€2ã€3ã€5ã€8ã€13ã€21ã€34      </span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">1</span><br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,<span class="hljs-number">0</span>    <span class="hljs-comment">;æ¥å­˜æœ€åçš„è®¡ç®—ç»“æœ</span><br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">cx</span>,<span class="hljs-number">9</span>    <span class="hljs-comment">;å¾ªç¯æ¬¡æ•°</span><br><span class="hljs-symbol"> s:</span><span class="hljs-keyword">push</span> <span class="hljs-built_in">bx</span><br><span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-built_in">ax</span><br> <span class="hljs-keyword">pop</span> <span class="hljs-built_in">ax</span><br> <span class="hljs-keyword">add</span> <span class="hljs-built_in">dx</span>,<span class="hljs-built_in">ax</span><br><br> <span class="hljs-keyword">loop</span> s<br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0</span><br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>:[<span class="hljs-number">200h</span>],<span class="hljs-built_in">dx</span><br> <br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br> <span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><br>code ends<br>end start<br><br></code></pre></td></tr></table></figure><h2 id="ç¬¬6ç« -åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"><a href="#ç¬¬6ç« -åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº" class="headerlink" title="ç¬¬6ç«  åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº"></a>ç¬¬6ç«  åŒ…å«å¤šä¸ªæ®µçš„ç¨‹åº</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-5"><a href="#åŸºç¡€æ¦‚å¿µ-5" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>æˆ‘ä»¬åœ¨æºç¨‹åºä¸­ç”¨ä¼ªæŒ‡ä»¤ â€œassume cs:code,ds:data,ss:stackâ€å°†csã€dså’Œssåˆ†åˆ«å’Œcodeã€dataã€stackæ®µç›¸è¿ã€‚è¿™æ ·åšäº†ä¹‹åï¼ŒCPUæ˜¯å¦å°±ä¼šå°† csæŒ‡å‘odeï¼Œds æŒ‡å‘ dataï¼Œss æŒ‡å‘stackï¼Œä»è€ŒæŒ‰ç…§æˆ‘ä»¬çš„æ„å›¾æ¥å¤„ç†è¿™äº›æ®µå‘¢ï¼Ÿ</p></li><li><p>å½“ç„¶ä¹Ÿä¸æ˜¯ï¼Œè¦çŸ¥é“ assume æ˜¯ä¼ªæŒ‡ä»¤ï¼Œæ˜¯ç”±ç¼–è¯‘å™¨æ‰§è¡Œçš„ï¼Œä¹Ÿæ˜¯ä»…åœ¨æºç¨‹åºä¸­å­˜åœ¨çš„ä¿¡æ¯ï¼ŒCPUå¹¶ä¸çŸ¥é“å®ƒä»¬ã€‚æˆ‘ä»¬ä¸å¿…æ·±ç©¶ assume çš„ä½œç”¨ï¼Œåªè¦çŸ¥é“éœ€è¦ç”¨å®ƒå°†ä½ å®šä¹‰çš„å…·æœ‰ä¸€å®šç”¨é€”çš„æ®µå’Œç›¸å…³çš„å¯„å­˜å™¨è”ç³»èµ·æ¥å°±å¯ä»¥äº†ã€‚ </p></li><li><p>è‹¥è¦CPUæŒ‰ç…§æˆ‘ä»¬çš„å®‰æ’è¡Œäº‹ï¼Œå°±è¦ç”¨æœºå™¨æŒ‡ä»¤æ§åˆ¶å®ƒï¼Œæºç¨‹åºä¸­çš„æ±‡ç¼–æŒ‡ä»¤æ˜¯CPUè¦æ‰§è¡Œçš„å†…å®¹ã€‚</p></li><li><p>æ€»ä¹‹ï¼ŒCPUåˆ°åº•å¦‚ä½•å¤„ç†æˆ‘ä»¬å®šä¹‰çš„æ®µä¸­çš„å†…å®¹ï¼Œæ˜¯å½“ä½œæŒ‡ä»¤æ‰§è¡Œï¼Œå½“ä½œæ•°æ®è®¿é—®ï¼Œè¿˜æ˜¯å½“ä½œæ ˆç©ºé—´ï¼Œå®Œå…¨æ˜¯é ç¨‹åºä¸­å…·ä½“çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œå’Œæ±‡ç¼–æŒ‡ä»¤å¯¹CS:IPã€SS:SPã€DSç­‰å¯„å­˜å™¨çš„è®¾ç½®æ¥å†³å®šçš„ã€‚</p></li></ol><h2 id="ç¬¬7ç« -æ›´çµæ´»çš„å®šä½å†…å­˜åœ°å€çš„çš„æ–¹æ³•"><a href="#ç¬¬7ç« -æ›´çµæ´»çš„å®šä½å†…å­˜åœ°å€çš„çš„æ–¹æ³•" class="headerlink" title="ç¬¬7ç«  æ›´çµæ´»çš„å®šä½å†…å­˜åœ°å€çš„çš„æ–¹æ³•"></a>ç¬¬7ç«  æ›´çµæ´»çš„å®šä½å†…å­˜åœ°å€çš„çš„æ–¹æ³•</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-6"><a href="#åŸºç¡€æ¦‚å¿µ-6" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>ï¼ˆ1ï¼‰and æŒ‡ä»¤ï¼šé€»è¾‘ä¸æŒ‡ä»¤ï¼ŒæŒ‰ä½è¿›è¡Œä¸è¿ç®—ã€‚ï¼ˆ2ï¼‰or æŒ‡ä»¤ï¼šé€»è¾‘æˆ–æŒ‡ä»¤ï¼ŒæŒ‰ä½è¿›è¡Œæˆ–è¿ç®—ã€‚</p></li><li><p>åœ¨ASCIIç¼–ç æ–¹æ¡ˆä¸­ï¼Œç”¨61H è¡¨ç¤ºâ€œaâ€ï¼Œ62Hè¡¨ç¤ºâ€œbâ€ã€‚ç”¨41H è¡¨ç¤ºâ€œAâ€ï¼Œ42Hè¡¨ç¤ºâ€œBâ€ã€‚</p></li><li><p>å°±ASCIIç çš„äºŒè¿›åˆ¶å½¢å¼æ¥çœ‹ï¼Œé™¤ç¬¬5ä½ï¼ˆä½æ•°ä»0å¼€å§‹è®¡ç®—ï¼‰å¤–ï¼Œå¤§å†™å­—æ¯å’Œå°å†™å­—æ¯çš„å…¶ä»–å„ä½éƒ½ä¸€æ ·ã€‚å¤§å†™å­—æ¯ASCIIç çš„ç¬¬5ä½ï¼ˆä½æ•°ä»0å¼€å§‹è®¡ç®—ï¼‰ä¸º0ï¼Œå°å†™å­—æ¯çš„ç¬¬5ä½ä¸º1ã€‚</p></li><li><p>or al,00100000b        ;å°†alä¸­çš„ASCIIç çš„ç¬¬5ä½ç½®ä¸º1ï¼Œå˜ä¸ºå°å†™å­—æ¯</p></li><li><p>and al,11011111b      ;å°†alä¸­çš„ASCIIç çš„ç¬¬5ä½ç½®ä¸º0ï¼Œå˜ä¸ºå¤§å†™å­—æ¯</p><ul><li><strong>and byte ptr [si],11011111b</strong>ï¼Œç­‰åˆ°äº†åé¢å°±æ˜¯è¿™æ ·äº†</li></ul></li><li><p>æŒ‡ä»¤<strong>mov ax,[bx+200]ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹æ ¼å¼ï¼ˆå¸¸ç”¨ï¼‰</strong>ï¼š</p><ul><li>mov ax,[200+bx]</li><li><strong>mov ax,200[bx]</strong></li><li>mov ax,[bx].200</li></ul></li><li><p>SI(source index register)å’ŒDI(destination index register)æ˜¯8086CPUä¸­å’ŒbxåŠŸèƒ½ç›¸è¿‘çš„å¯„å­˜å™¨ï¼Œ<strong>SIå’ŒDIä¸èƒ½å¤Ÿåˆ†æˆä¸¤ä¸ª8 ä½å¯„å­˜å™¨æ¥ä½¿ç”¨</strong>ã€‚</p></li><li><p>æŒ‡ä»¤mov ax,[bx+si]çš„æ•°å­¦åŒ–çš„æè¿°ä¸ºï¼š(ax)&#x3D;( (ds) * 16+(bx)+(si) )ã€‚<br> è¯¥æŒ‡ä»¤ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹æ ¼å¼ï¼ˆå¸¸ç”¨ï¼‰ï¼šmov ax,[bx][si]</p></li><li><p>æŒ‡ä»¤mov ax,[bx+si+200]ï¼Œè¯¥æŒ‡ä»¤ä¹Ÿå¯ä»¥å†™æˆå¦‚ä¸‹æ ¼å¼ï¼ˆå¸¸ç”¨ï¼‰ï¼š</p><ul><li>mov ax,[bx+200+si] </li><li>mov ax,[200+bx+si]</li><li>mov ax,200[bx][si]</li><li>mov ax,[bx].200[si]</li><li>mov ax,[bx][si].200</li></ul></li></ol><h2 id="ç¬¬8ç« -æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜"><a href="#ç¬¬8ç« -æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜" class="headerlink" title="ç¬¬8ç«  æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜"></a>ç¬¬8ç«  æ•°æ®å¤„ç†çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-7"><a href="#åŸºç¡€æ¦‚å¿µ-7" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>æˆ‘ä»¬å°†ä½¿ç”¨regæ¥è¡¨ç¤ºä¸€ä¸ªå¯„å­˜å™¨ï¼Œç”¨sregè¡¨ç¤ºä¸€ä¸ªæ®µå¯„å­˜å™¨ã€‚regçš„é›†åˆåŒ…æ‹¬ï¼šaxã€bxã€cxã€dxã€ahã€alã€bhã€blã€chã€clã€dhã€dlã€spã€bpã€siã€diï¼›sregçš„é›†åˆåŒ…æ‹¬ï¼šdsã€ssã€csã€esã€‚</p></li><li><p>åœ¨8086CPU ä¸­ï¼Œåªæœ‰è¿™4ä¸ªå¯„å­˜å™¨ï¼ˆbxã€bpã€siã€diï¼‰å¯ä»¥ç”¨åœ¨â€œ[â€¦]â€ ä¸­æ¥è¿›è¡Œå†…å­˜å•å…ƒçš„å¯»å€ã€‚</p></li><li><p>åœ¨â€œ[â€¦]â€ ä¸­ï¼Œè¿™4ä¸ªå¯„å­˜å™¨ï¼ˆbxã€bpã€siã€diï¼‰å¯ä»¥å•ä¸ªå‡ºç°ï¼Œæˆ–åªèƒ½ä»¥å››ç§ç»„åˆå‡ºç°ï¼šï®bxå’Œsiã€bxå’Œdiã€bpå’Œsiã€bpå’Œdi</p></li><li><p><strong>åªè¦åœ¨[â€¦]ä¸­ä½¿ç”¨å¯„å­˜å™¨bpï¼Œè€ŒæŒ‡ä»¤ä¸­æ²¡æœ‰æ˜¾æ€§çš„ç»™å‡ºæ®µåœ°å€ï¼Œæ®µåœ°å€å°±é»˜è®¤åœ¨ssä¸­</strong>ã€‚</p></li><li><p>mov ax,1 å¯¹åº”æœºå™¨ç ï¼šB80100ï¼›mov ax,076açš„æœºå™¨ç ï¼ŸB86A07</p></li><li><p>åœ¨æ²¡æœ‰å¯„å­˜å™¨åå­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œç”¨æ“ä½œç¬¦<strong>X ptr</strong>æŒ‡æ˜å†…å­˜å•å…ƒçš„é•¿åº¦ï¼ŒXåœ¨æ±‡ç¼–æŒ‡ä»¤ä¸­å¯ä»¥ä¸ºwordæˆ–byteã€‚</p></li><li><p>pushæŒ‡ä»¤åªè¿›è¡Œå­—æ“ä½œ</p></li><li><p>divæ˜¯é™¤æ³•æŒ‡ä»¤ï¼Œä½¿ç”¨divä½œé™¤æ³•çš„æ—¶å€™ï¼š</p><ul><li>é™¤æ•°ï¼š8ä½æˆ–16ä½ï¼Œåœ¨å¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­</li><li>è¢«é™¤æ•°ï¼šï¼ˆé»˜è®¤ï¼‰æ”¾åœ¨AX æˆ– DXï¼ˆé«˜16ä½ï¼‰å’ŒAXï¼ˆä½16ä½ï¼‰ä¸­</li><li>ç»“æœï¼šå¦‚æœé™¤æ•°ä¸º 8ä½ï¼Œå•†ï¼šALï¼Œä½™æ•°ï¼šAHï¼›<strong>å¦‚æœé™¤æ•°ä¸º16ä½ï¼Œå•†ï¼šAXï¼Œä½™æ•°ï¼šDX</strong>ï¼›</li></ul></li><li><p>divæŒ‡ä»¤æ ¼å¼ï¼šï® div regï® div å†…å­˜å•å…ƒ</p></li><li><p>div byte ptr ds:[0]</p><ul><li>å«ä¹‰ä¸ºï¼š(al)&#x3D;(ax)&#x2F;((ds) * 16+0)çš„å•†ï¼›</li><li>(ah)&#x3D;(ax)&#x2F;((ds) * 16+0)çš„ä½™æ•°</li></ul></li><li><p>div word ptr [bx+si+8]</p><ul><li>å«ä¹‰ä¸ºï¼š(ax)&#x3D;[(dx) * 10000H+(ax)]&#x2F;((ds) * 16+(bx)+(si)+8)çš„å•†ï¼›</li><li>(dx)&#x3D;[(dx) * 10000H+(ax)]&#x2F;((ds) * 16+(bx)+(si)+8)çš„ä½™æ•°</li></ul></li><li><p>dd 1ï¼Œæ•°æ®ä¸º00000001Hï¼Œå 2ä¸ªå­—ï¼›</p></li><li><p><strong>dup</strong>æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œåœ¨æ±‡ç¼–è¯­è¨€ä¸­åŒdbã€dwã€dd ç­‰ä¸€æ ·ï¼Œä¹Ÿæ˜¯ç”±ç¼–è¯‘å™¨è¯†åˆ«å¤„ç†çš„ç¬¦å·ã€‚ï® å®ƒæ˜¯å’Œdbã€dwã€dd ç­‰æ•°æ®å®šä¹‰ä¼ªæŒ‡ä»¤é…åˆä½¿ç”¨çš„ï¼Œç”¨æ¥è¿›è¡Œæ•°æ®çš„é‡å¤ã€‚</p><ul><li>db 3 dup (0) å®šä¹‰äº†3ä¸ªå­—èŠ‚ï¼Œå®ƒä»¬çš„å€¼éƒ½æ˜¯0ï¼Œç›¸å½“äº db 0,0,0</li><li>db 3 dup (0,1,2)å®šä¹‰äº†9ä¸ªå­—èŠ‚ï¼Œå®ƒä»¬æ˜¯0ã€1ã€2ã€0ã€1ã€2ã€0ã€1ã€2ï¼Œç›¸å½“äº db 0,1,2,0,1,2,0,1,2</li><li>db 3 dup (â€˜abcâ€™,â€™ABCâ€™)å®šä¹‰äº†18ä¸ªå­—èŠ‚ï¼Œå®ƒä»¬æ˜¯â€˜abcABCabcABCabcABCâ€™ï¼Œç›¸å½“äºdb â€˜abcABCabcABCabcABCâ€™</li></ul></li></ol><h2 id="ç¬¬9ç« -è½¬ç§»æŒ‡ä»¤çš„åŸç†"><a href="#ç¬¬9ç« -è½¬ç§»æŒ‡ä»¤çš„åŸç†" class="headerlink" title="ç¬¬9ç«  è½¬ç§»æŒ‡ä»¤çš„åŸç†"></a>ç¬¬9ç«  è½¬ç§»æŒ‡ä»¤çš„åŸç†</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-8"><a href="#åŸºç¡€æ¦‚å¿µ-8" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>jmpæŒ‡ä»¤è¦ç»™å‡ºä¸¤ç§ä¿¡æ¯ï¼šï® è½¬ç§»çš„ç›®çš„åœ°å€ï¼Œï® è½¬ç§»çš„è·ç¦»ï¼ˆæ®µé—´è½¬ç§»jmp farã€æ®µå†…çŸ­è½¬ç§»jmp shortï¼Œæ®µå†…è¿‘è½¬ç§»jmp nearï¼‰</p></li><li><p><strong>jmp short æ ‡å·</strong>ï¼ˆè½¬åˆ°æ ‡å·å¤„æ‰§è¡ŒæŒ‡ä»¤ï¼‰è¿™ç§æ ¼å¼çš„ jmp æŒ‡ä»¤å®ç°çš„æ˜¯<strong>æ®µå†…çŸ­è½¬ç§»ï¼Œå®ƒå¯¹IPçš„ä¿®æ”¹èŒƒå›´ä¸º -128~127</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå‘å‰è½¬ç§»æ—¶å¯ä»¥æœ€å¤šè¶Šè¿‡128ä¸ªå­—èŠ‚ï¼Œå‘åè½¬ç§»å¯ä»¥æœ€å¤šè¶Šè¿‡127ä¸ªå­—èŠ‚ã€‚</p></li><li><p>åœ¨â€œjmp short æ ‡å·â€æŒ‡ä»¤æ‰€å¯¹åº”çš„æœºå™¨ç ä¸­ï¼Œå¹¶ä¸åŒ…å«è½¬ç§»çš„ç›®çš„åœ°å€ï¼Œè€Œ<strong>åŒ…å«çš„æ˜¯è½¬ç§»çš„ä½ç§»</strong>ã€‚ï® è¿™ä¸ªä½ç§»ï¼Œæ˜¯ç¼–è¯‘å™¨æ ¹æ®æ±‡ç¼–æŒ‡ä»¤ä¸­çš„â€œæ ‡å·â€è®¡ç®—å‡ºæ¥çš„ã€‚</p></li><li><p>å®é™…ä¸Šï¼ŒæŒ‡ä»¤â€œjmp short æ ‡å·â€çš„åŠŸèƒ½ä¸º(IP)&#x3D;(IP)+8ä½ä½ç§»ã€‚</p><ul><li><strong>8ä½ä½ç§»&#x3D;â€œæ ‡å·â€å¤„çš„åœ°å€-jmpæŒ‡ä»¤åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€</strong>ï¼›</li><li>shortæŒ‡æ˜æ­¤å¤„çš„ä½ç§»ä¸º8ä½ä½ç§»ï¼›</li><li>8ä½ä½ç§»çš„èŒƒå›´ä¸º-128~127ï¼Œç”¨è¡¥ç è¡¨ç¤ºã€‚</li><li>8ä½ä½ç§»ç”±ç¼–è¯‘ç¨‹åºåœ¨ç¼–è¯‘æ—¶ç®—å‡ºã€‚</li></ul></li><li><p><strong>jmp near ptr</strong> æ ‡å·å®ƒå®ç°çš„æ—¶<strong>æ®µå†…è¿‘è½¬ç§»</strong>ã€‚<strong>IPä¿®æ”¹èŒƒå›´ä¸ºï¼š-32768~32767</strong>ã€‚</p></li><li><p>æŒ‡ä»¤ <strong>jmp far ptr</strong> æ ‡å· å®ç°çš„æ˜¯<strong>æ®µé—´è½¬ç§»ï¼Œåˆç§°ä¸ºè¿œè½¬ç§»</strong>ã€‚far ptræŒ‡æ˜äº†æŒ‡ä»¤ç”¨æ ‡å·çš„æ®µåœ°å€å’Œåç§»åœ°å€ä¿®æ”¹CSå’ŒIPã€‚IPä¿®æ”¹èŒƒå›´ï¼šéšæ„ã€‚</p></li><li><p>jmp far ptr sæ‰€å¯¹åº”çš„æœºå™¨ç ï¼šEA 0B 01 BD 0B ï¼Œå…¶ä¸­åŒ…å«è½¬ç§»çš„ç›®çš„åœ°å€</p></li><li><p>è½¬ç§»åœ°å€åœ¨å†…å­˜ä¸­çš„jmpæŒ‡ä»¤æœ‰ä¸¤ç§æ ¼å¼ï¼š</p><ul><li>jmp word ptr å†…å­˜å•å…ƒåœ°å€ï¼ˆæ®µå†…è½¬ç§»ï¼‰<ul><li>åŠŸèƒ½ï¼šä»å†…å­˜å•å…ƒåœ°å€å¤„å¼€å§‹å­˜æ”¾ç€ä¸€ä¸ªå­—ï¼Œæ˜¯è½¬ç§»çš„ç›®çš„åç§»åœ°å€ã€‚</li></ul></li><li>jmp dword ptr å†…å­˜å•å…ƒåœ°å€ï¼ˆæ®µé—´è½¬ç§»ï¼‰<ul><li>åŠŸèƒ½ï¼šä»å†…å­˜å•å…ƒåœ°å€å¤„å¼€å§‹å­˜æ”¾ç€ä¸¤ä¸ªå­—ï¼Œ<strong>é«˜åœ°å€å¤„çš„å­—æ˜¯è½¬ç§»çš„ç›®çš„æ®µåœ°å€ï¼Œä½åœ°å€å¤„æ˜¯è½¬ç§»çš„ç›®çš„åç§»åœ°å€</strong>ã€‚</li><li>(CS)&#x3D;(å†…å­˜å•å…ƒåœ°å€+2)</li><li>(IP)&#x3D;(å†…å­˜å•å…ƒåœ°å€)</li><li>å†…å­˜å•å…ƒåœ°å€å¯ç”¨å¯»å€æ–¹å¼çš„ä»»ä¸€æ ¼å¼ç»™å‡ºã€‚</li></ul></li></ul></li><li><p>jcxzæŒ‡ä»¤ï¼ˆjump if cx equals zeroï¼‰ä¸ºæœ‰æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼Œ<strong>æ‰€æœ‰çš„æœ‰æ¡ä»¶è½¬ç§»æŒ‡ä»¤éƒ½æ˜¯çŸ­è½¬ç§»</strong>ï¼Œåœ¨å¯¹åº”çš„æœºå™¨ç ä¸­åŒ…å«è½¬ç§»çš„ä½ç§»ï¼Œè€Œä¸æ˜¯ç›®çš„åœ°å€ã€‚å¯¹IPçš„ä¿®æ”¹èŒƒå›´éƒ½ä¸º-128~127ã€‚<strong>æŒ‡ä»¤æ ¼å¼ï¼šjcxz æ ‡å· ï¼ˆå¦‚æœ(cx)&#x3D;0ï¼Œåˆ™è½¬ç§»åˆ°æ ‡å·å¤„æ‰§è¡Œã€‚ï¼‰</strong></p></li><li><p>jcxz æ ‡å· æŒ‡ä»¤æ“ä½œï¼š</p><ul><li>å½“(cx)&#x3D;0æ—¶ï¼Œ(IP)&#x3D;(IP)+8ä½ä½ç§»ï¼‰<ul><li><strong>8ä½ä½ç§»&#x3D;â€œæ ‡å·â€å¤„çš„åœ°å€-jcxzæŒ‡ä»¤åçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€ï¼›</strong></li><li>8ä½ä½ç§»çš„èŒƒå›´ä¸º-128~127ï¼Œç”¨è¡¥ç è¡¨ç¤ºï¼›</li><li>8ä½ä½ç§»ç”±ç¼–è¯‘ç¨‹åºåœ¨ç¼–è¯‘æ—¶ç®—å‡ºã€‚</li></ul></li><li>å½“(cx)ä¸ä¸º0æ—¶ï¼Œä»€ä¹ˆä¹Ÿä¸åšï¼ˆç¨‹åºå‘ä¸‹æ‰§è¡Œï¼‰ã€‚</li></ul></li><li><p>loopæŒ‡ä»¤ä¸ºå¾ªç¯æŒ‡ä»¤ï¼Œ<strong>æ‰€æœ‰çš„å¾ªç¯æŒ‡ä»¤éƒ½æ˜¯çŸ­è½¬ç§»</strong>ï¼Œåœ¨å¯¹åº”çš„æœºå™¨ç ä¸­åŒ…å«è½¬ç§»çš„ä½ç§»ï¼Œè€Œä¸æ˜¯ç›®çš„åœ°å€ã€‚å¯¹IPçš„ä¿®æ”¹èŒƒå›´éƒ½ä¸º-128~127ã€‚ï®æŒ‡ä»¤æ ¼å¼ï¼šloop æ ‡å·</p></li></ol><h2 id="ç¬¬10ç« -CALLå’ŒRETæŒ‡ä»¤"><a href="#ç¬¬10ç« -CALLå’ŒRETæŒ‡ä»¤" class="headerlink" title="ç¬¬10ç«  CALLå’ŒRETæŒ‡ä»¤"></a>ç¬¬10ç«  CALLå’ŒRETæŒ‡ä»¤</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-9"><a href="#åŸºç¡€æ¦‚å¿µ-9" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>retæŒ‡ä»¤ç”¨æ ˆä¸­çš„æ•°æ®ï¼Œä¿®æ”¹IPçš„å†…å®¹ï¼Œä»è€Œå®ç°è¿‘è½¬ç§»ï¼›</p><ul><li>CPUæ‰§è¡ŒretæŒ‡ä»¤æ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼špop IP</li></ul></li><li><p>retfæŒ‡ä»¤ç”¨æ ˆä¸­çš„æ•°æ®ï¼Œä¿®æ”¹CSå’ŒIPçš„å†…å®¹ï¼Œä»è€Œå®ç°è¿œè½¬ç§»ï¼›</p><ul><li>CPUæ‰§è¡ŒretfæŒ‡ä»¤æ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š<ul><li>pop IPï¼ˆ<strong>æ³¨æ„ï¼è¿™æ˜¯è¿æ³•çš„ï¼Œåªæ˜¯æ•ˆæœ</strong>ï¼‰</li><li>pop CS</li></ul></li></ul></li><li><p>CPUæ‰§è¡ŒcallæŒ‡ä»¤ï¼Œè¿›è¡Œä¸¤æ­¥æ“ä½œï¼š</p><ul><li>å°†å½“å‰çš„ IP æˆ– CS å’Œ IP å‹å…¥æ ˆä¸­ï¼›</li><li>è½¬ç§»ã€‚</li></ul></li><li><p>CPU æ‰§è¡ŒæŒ‡ä»¤â€œcall æ ‡å·â€æ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š</p><ul><li>push IP</li><li>jmp near ptr æ ‡å·</li></ul></li><li><p>call s åœ¨æŒ‡ä»¤ç¼“å†²å™¨æ—¶ï¼ŒIPå·²ç»æ”¹å˜äº†ï¼ŒæŒ‡å‘äº†ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œsuooooooä»¥ï¼Œ<strong>callæŒ‡ä»¤æŒ‡å‘æ—¶å°†ä¸‹ä¸€æ¡æŒ‡ä»¤çš„IPå…¥æ ˆ</strong> ã€‚</p></li><li><p>CPU æ‰§è¡ŒæŒ‡ä»¤ â€œcall far ptr æ ‡å·â€æ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š</p><ul><li>push CS</li><li>push IP</li><li>jmp far ptr æ ‡å·</li></ul></li><li><p>CPUæ‰§è¡Œcall 16ä½regæ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š</p><ul><li>push IP </li><li>jmp 16ä½å¯„å­˜å™¨</li></ul></li><li><p>call word ptr å†…å­˜å•å…ƒåœ°å€ï¼Œï® æ±‡ç¼–è¯­æ³•è§£é‡Šï¼š</p><ul><li>push CS</li><li>push IP</li><li>jmp dword ptr å†…å­˜å•å…ƒåœ°å€</li></ul></li><li><p>call dword ptr å†…å­˜å•å…ƒåœ°å€ï¼Œï® æ±‡ç¼–è¯­æ³•è§£é‡Šï¼š</p><ul><li>push CS</li><li>push IP</li><li>jmp dword ptr å†…å­˜å•å…ƒåœ°å€</li></ul></li></ol><h2 id="ç¬¬11ç« -æ ‡å¿—å¯„å­˜å™¨"><a href="#ç¬¬11ç« -æ ‡å¿—å¯„å­˜å™¨" class="headerlink" title="ç¬¬11ç«  æ ‡å¿—å¯„å­˜å™¨"></a>ç¬¬11ç«  æ ‡å¿—å¯„å­˜å™¨</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-10"><a href="#åŸºç¡€æ¦‚å¿µ-10" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>flagçš„ç¬¬6ä½æ˜¯<strong>ZFï¼ˆzero flagï¼‰ï¼Œé›¶æ ‡å¿—ä½</strong>ã€‚å®ƒè®°å½•ç›¸å…³æŒ‡ä»¤æ‰§è¡Œåï¼Œå…¶ç»“æœæ˜¯å¦ä¸º0</p><ul><li>ç»“æœä¸º0 ï¼ŒZF &#x3D; 1</li><li>ç»“æœä¸ä¸º0ï¼ŒZF &#x3D; 0</li></ul></li><li><p>åœ¨8086CPUçš„æŒ‡ä»¤é›†ä¸­ï¼Œæœ‰çš„æŒ‡ä»¤çš„æ‰§è¡Œæ˜¯å½±å“æ ‡å¿—å¯„å­˜å™¨çš„ï¼Œæ¯”å¦‚ï¼š<strong>addã€subã€mulã€divã€incã€orã€and</strong>ç­‰ï¼Œå®ƒä»¬å¤§éƒ½æ˜¯è¿ç®—æŒ‡ä»¤ï¼ˆè¿›è¡Œé€»è¾‘æˆ–ç®—æœ¯è¿ç®—ï¼‰ï¼›æœ‰çš„æŒ‡ä»¤çš„æ‰§è¡Œå¯¹æ ‡å¿—å¯„å­˜å™¨æ²¡æœ‰å½±å“ï¼Œæ¯”å¦‚ï¼šmovã€pushã€popç­‰ï¼Œå®ƒä»¬å¤§éƒ½æ˜¯ä¼ é€æŒ‡ä»¤ã€‚</p></li><li><p>flagçš„ç¬¬2ä½æ˜¯<strong>PFï¼Œå¥‡å¶æ ‡å¿—ä½</strong>ã€‚å®ƒè®°å½•æŒ‡ä»¤æ‰§è¡Œåï¼Œç»“æœçš„æ‰€æœ‰<strong>äºŒè¿›åˆ¶ä½ï¼ˆä½8ä½ï¼‰ä¸­</strong>1çš„ä¸ªæ•°ï¼š</p><ul><li>ä¸ºå¶æ•°ï¼ŒPF &#x3D; 1ï¼›</li><li>ä¸ºå¥‡æ•°ï¼ŒPF &#x3D; 0ã€‚</li></ul></li><li><p>flagçš„ç¬¬7ä½æ˜¯<strong>SFï¼Œç¬¦å·æ ‡å¿—ä½</strong>ã€‚å®ƒè®°å½•æŒ‡ä»¤æ‰§è¡Œåï¼Œå…¶ç»“æœæ˜¯å¦ä¸ºè´Ÿ</p><ul><li>ç»“æœä¸ºè´Ÿï¼ŒSF &#x3D; 1ï¼›</li><li>ç»“æœä¸ºæ­£ï¼ŒSF &#x3D; 0ã€‚</li><li>ä¸æœ‰ç¬¦å·æ•°çš„ç¬¦å·ä½è§„å®šä¸€è‡´</li><li>SF æ ‡å¿—ï¼Œå°±æ˜¯CPUå¯¹æœ‰ç¬¦å·æ•°è¿ç®—ç»“æœçš„ä¸€ç§è®°å½• ï¼Œå®ƒè®°å½•æ•°æ®çš„æ­£è´Ÿã€‚</li><li>åœ¨æˆ‘ä»¬å°†æ•°æ®å½“ä½œæœ‰ç¬¦å·æ•°æ¥è¿ç®—çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥å¾—çŸ¥ç»“æœçš„æ­£è´Ÿã€‚</li><li>å¦‚æœæˆ‘ä»¬å°†æ•°æ®å½“ä½œæ— ç¬¦å·æ•°æ¥è¿ç®—ï¼ŒSFçš„å€¼åˆ™æ²¡æœ‰æ„ä¹‰ï¼Œè™½ç„¶ç›¸å…³çš„æŒ‡ä»¤å½±å“äº†å®ƒçš„å€¼ã€‚</li></ul></li><li><p>æ¯”å¦‚æŒ‡ä»¤sub al,alæ‰§è¡Œåï¼ŒZFã€PFã€SFç­‰æ ‡å¿—ä½éƒ½è¦å—åˆ°å½±å“ï¼Œå®ƒä»¬åˆ†åˆ«ä¸ºï¼š1ã€1ã€0ã€‚</p></li><li><p>flagçš„ç¬¬0ä½æ˜¯<strong>CFï¼Œè¿›ä½æ ‡å¿—ä½ã€‚</strong></p><ul><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨è¿›è¡Œæ— ç¬¦å·æ•°è¿ç®—çš„æ—¶å€™ï¼Œå®ƒè®°å½•äº†è¿ç®—ç»“æœçš„æœ€é«˜æœ‰æ•ˆä½å‘æ›´é«˜ä½çš„è¿›ä½å€¼ï¼Œæˆ–ä»æ›´é«˜ä½çš„å€Ÿä½å€¼ã€‚</li><li>æ¯”å¦‚ï¼š<ul><li>mov al,98H</li><li>add al,al ;</li><li>æ‰§è¡Œåï¼š (al)&#x3D;30Hï¼ŒCF&#x3D;1ï¼ŒCFè®°å½•äº†æœ€é«˜æœ‰æ•ˆä½å‘æ›´é«˜ä½çš„è¿›ä½å€¼</li></ul></li></ul></li><li><p>flagçš„ç¬¬11ä½æ˜¯<strong>OFï¼Œæº¢å‡ºæ ‡å¿—ä½ã€‚</strong></p><ul><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒOFè®°å½•äº†æœ‰ç¬¦å·æ•°è¿ç®—çš„ç»“æœæ˜¯å¦å‘ç”Ÿäº†æº¢å‡ºã€‚</li><li>å¦‚æœå‘ç”Ÿæº¢å‡ºï¼ŒOF&#x3D;1ï¼Œ</li><li>å¦‚æœæ²¡æœ‰ï¼ŒOF&#x3D;0ã€‚</li><li><strong>CFæ˜¯å¯¹æ— ç¬¦å·æ•°è¿ç®—æœ‰æ„ä¹‰çš„æ ‡å¿—ä½ï¼›è€ŒOFæ˜¯å¯¹æœ‰ç¬¦å·æ•°è¿ç®—æœ‰æ„ä¹‰çš„æ ‡å¿—ä½ã€‚</strong></li></ul></li><li><p>å¯¹äºæ— ç¬¦å·æ•°è¿ç®—ï¼ŒCPUç”¨CFä½æ¥è®°å½•æ˜¯å¦äº§ç”Ÿäº†è¿›ä½ï¼›å¯¹äºæœ‰ç¬¦å·æ•°è¿ç®—ï¼ŒCPU ç”¨ OF ä½æ¥è®°å½•æ˜¯å¦äº§ç”Ÿäº†æº¢å‡ºã€‚å½“ç„¶ï¼Œè¿˜è¦ç”¨SFä½æ¥è®°å½•ç»“æœçš„ç¬¦å·ã€‚</p><ul><li>å¯¹äºæ— ç¬¦å·æ•°è¿ç®—ï¼Œ98+99æ²¡æœ‰è¿›ä½ï¼ŒCF&#x3D;0ï¼›</li><li>å¯¹äºæœ‰ç¬¦å·æ•°è¿ç®—ï¼Œ98+99å‘ç”Ÿæº¢å‡ºï¼ŒOF&#x3D;1ã€‚</li></ul></li><li><p><strong>adcæ˜¯å¸¦è¿›ä½åŠ æ³•æŒ‡ä»¤ ï¼Œå®ƒåˆ©ç”¨äº†CFä½ä¸Šè®°å½•çš„è¿›ä½å€¼ã€‚</strong></p><ul><li>æ ¼å¼ï¼š adc æ“ä½œå¯¹è±¡1,æ“ä½œå¯¹è±¡2</li><li>åŠŸèƒ½ï¼šæ“ä½œå¯¹è±¡1&#x3D;æ“ä½œå¯¹è±¡1+æ“ä½œå¯¹è±¡2+CF</li><li>æ¯”å¦‚ï¼šadc ax,bx å®ç°çš„åŠŸèƒ½æ˜¯ï¼š(ax)&#x3D;(ax)+(bx)+CF</li></ul></li><li><p>ä¸‹é¢çš„æŒ‡ä»¤å’Œadd ax , bxå…·æœ‰ç›¸åŒçš„ç»“æœï¼šadd al,bl ï¼Œadc ah,bhï¼Œçœ‹æ¥CPUæä¾› adc æŒ‡ä»¤çš„ç›®çš„ï¼Œå°±æ˜¯æ¥è¿›è¡ŒåŠ æ³•çš„ç¬¬äºŒæ­¥è¿ç®—çš„ã€‚adcæŒ‡ä»¤å’ŒaddæŒ‡ä»¤ç›¸é…åˆå°±å¯ä»¥å¯¹æ›´å¤§çš„æ•°æ®è¿›è¡ŒåŠ æ³•è¿ç®—ã€‚</p></li><li><p><strong>sbbæ˜¯å¸¦å€Ÿä½å‡æ³•æŒ‡ä»¤ï¼Œå®ƒåˆ©ç”¨äº†CFä½ä¸Šè®°å½•çš„å€Ÿä½å€¼ã€‚</strong></p><ul><li>æ ¼å¼ï¼šsbb æ“ä½œå¯¹è±¡1,æ“ä½œå¯¹è±¡2</li><li>åŠŸèƒ½ï¼šæ“ä½œå¯¹è±¡1&#x3D;æ“ä½œå¯¹è±¡1â€“æ“ä½œå¯¹è±¡2â€“CF</li><li>æ¯”å¦‚ï¼šsbb ax,bx,å®ç°åŠŸèƒ½ï¼š (ax) &#x3D; (ax) â€“ (bx) â€“ CF</li></ul></li><li><p><strong>cmpæŒ‡ä»¤</strong></p><ul><li>æ ¼å¼ï¼šcmp æ“ä½œå¯¹è±¡1,æ“ä½œå¯¹è±¡2</li><li>åŠŸèƒ½ï¼šè®¡ç®—æ“ä½œå¯¹è±¡1â€“æ“ä½œå¯¹è±¡2 ä½†å¹¶ä¸ä¿å­˜ç»“æœï¼Œä»…ä»…æ ¹æ®è®¡ç®—ç»“æœå¯¹æ ‡å¿—å¯„å­˜å™¨è¿›è¡Œè®¾ç½®ã€‚</li></ul></li><li><p>æ¯”å¦‚ï¼šcmp ax,axåš(ax)â€“(ax)çš„è¿ç®—ï¼Œç»“æœä¸º0ï¼Œä½†å¹¶ä¸åœ¨axä¸­ä¿å­˜ï¼Œä»…å½±å“flagçš„ç›¸å…³å„ä½ã€‚æŒ‡ä»¤æ‰§è¡Œåï¼š</p><ul><li>ZF&#x3D;1ï¼Œ</li><li>PF&#x3D;1ï¼Œ0æ˜¯å¶æ•°</li><li>SF&#x3D;0ï¼Œ</li><li>CF&#x3D;0ï¼Œ</li><li>OF&#x3D;0ã€‚</li><li>æ ¹æ®cmpæŒ‡ä»¤æ‰§è¡ŒåZFçš„å€¼ï¼Œå°±å¯ä»¥çŸ¥é“ä¸¤ä¸ªæ•°æ®æ˜¯å¦ç›¸ç­‰ã€‚</li></ul></li><li><p>å¦‚æœæ²¡æœ‰æº¢å‡ºå‘ç”Ÿçš„è¯ï¼Œé‚£ä¹ˆï¼Œå®é™…ç»“æœçš„æ­£è´Ÿå’Œé€»è¾‘ä¸ŠçœŸæ­£ç»“æœçš„æ­£è´Ÿå°±ä¸€è‡´äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨è€ƒå¯ŸSFï¼ˆå¾—çŸ¥å®é™…ç»“æœçš„æ­£è´Ÿï¼‰çš„åŒæ—¶è€ƒå¯ŸOFï¼ˆå¾—çŸ¥æœ‰æ²¡æœ‰æº¢å‡ºï¼‰ï¼Œå°±å¯ä»¥å¾—çŸ¥é€»è¾‘ä¸ŠçœŸæ­£ç»“æœçš„æ­£è´Ÿï¼ŒåŒæ—¶å°±å¯ä»¥çŸ¥é“æ¯”è¾ƒçš„ç»“æœã€‚</p></li><li><p>è™½ç„¶ je çš„é€»è¾‘å«ä¹‰æ˜¯â€œç›¸ç­‰åˆ™è½¬ç§»â€ï¼Œä½†å®ƒè¿›è¡Œçš„æ“ä½œæ˜¯ï¼ŒZF&#x3D;1æ—¶åˆ™è½¬ç§»ã€‚â€œç›¸ç­‰åˆ™è½¬ç§»â€è¿™ç§é€»è¾‘å«ä¹‰ï¼Œæ˜¯é€šè¿‡å’Œ cmp æŒ‡ä»¤é…åˆä½¿ç”¨æ¥ä½“ç°çš„ï¼Œå› ä¸ºæ˜¯cmp æŒ‡ä»¤ä¸ºâ€œZF&#x3D;1â€èµ‹äºˆäº†â€œä¸¤æ•°ç›¸ç­‰â€çš„å«ä¹‰ã€‚è™½ç„¶æˆ‘ä»¬åˆ†åˆ«è®¨è®ºäº†cmpæŒ‡ä»¤å’Œä¸å…¶æ¯”è¾ƒç»“æœç›¸å…³çš„æœ‰æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼Œä½†æ˜¯å®ƒä»¬ç»å¸¸åœ¨ä¸€èµ·é…åˆä½¿ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è”åˆåº”ç”¨å®ƒä»¬çš„æ—¶å€™ï¼Œä¸å¿…å†è€ƒè™‘cmpæŒ‡ä»¤å¯¹ç›¸å…³æ ‡å¿—ä½çš„å½±å“å’Œje ç­‰æŒ‡ä»¤å¯¹ç›¸å…³æ ‡å¿—ä½çš„æ£€æµ‹ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è€ƒè™‘cmpå’Œjeç­‰æŒ‡ä»¤é…åˆä½¿ç”¨æ—¶ï¼Œè¡¨ç°å‡ºæ¥çš„é€»è¾‘å«ä¹‰ã€‚å®ƒä»¬åœ¨è”åˆä½¿ç”¨çš„æ—¶å€™è¡¨ç°å‡ºæ¥çš„åŠŸèƒ½æœ‰äº›åƒé«˜çº§è¯­è¨€ä¸­çš„IFè¯­å¥ã€‚<strong>æ„æ€å°±æ˜¯è¯´jeå¯ä»¥ç›´æ¥ç”¨ï¼Œjeå°±æ˜¯ç­‰äºåˆ™è½¬ç§»</strong></p></li><li><p><strong>jb å«ä¹‰æ˜¯ä½äºåˆ™è½¬ç§»ï¼Œja å«ä¹‰æ˜¯é«˜äºåˆ™è½¬ç§»ã€‚</strong></p></li><li><p><strong>jna å«ä¹‰æ˜¯ä¸é«˜äºåˆ™è½¬ç§»ï¼Œå³å°äºç­‰äºåˆ™è½¬ç§»ï¼›jnb å«ä¹‰æ˜¯ä¸ä½äºåˆ™è½¬ç§»ï¼Œå³å¤§äºç­‰äºåˆ™è½¬ç§»ã€‚</strong></p></li></ol><p><a href="https://freeimage.host/i/HPSgh7e"><img src="https://iili.io/HPSgh7e.md.png" alt="HPSgh7e.md.png"></a></p><ol start="18"><li><p>flagçš„ç¬¬10ä½æ˜¯<strong>DFï¼Œæ–¹å‘æ ‡å¿—ä½ã€‚</strong></p><ul><li>åœ¨ä¸²å¤„ç†æŒ‡ä»¤ä¸­ï¼Œæ§åˆ¶æ¯æ¬¡æ“ä½œåsiï¼Œdiçš„å¢å‡ã€‚</li><li>DF &#x3D; 0ï¼šæ¯æ¬¡æ“ä½œåsiï¼Œdié€’å¢ï¼›</li><li>DF &#x3D; 1ï¼šæ¯æ¬¡æ“ä½œåsiï¼Œdié€’å‡ã€‚</li></ul></li><li><p>ä¸²ä¼ é€æŒ‡ä»¤ï¼š<code>movsb</code> æˆ‘ä»¬å¯ä»¥ç”¨æ±‡ç¼–è¯­æ³•æè¿°movsbçš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li>mov es:[di],byte ptr ds:[si];8086 å¹¶ä¸æ”¯æŒè¿™æ ·çš„æŒ‡ä»¤ï¼Œè¿™é‡Œåªæ˜¯ä¸ªæè¿°ã€‚</li><li>å¦‚æœDF&#x3D;0ï¼šinc siï¼Œinc di</li><li>å¦‚æœDF&#x3D;1ï¼šdec siï¼Œdec di</li><li><strong>å°±æ˜¯ds:si ä¼ åˆ° es:di</strong></li></ul></li><li><p>rep movsb ç”¨æ±‡ç¼–è¯­æ³•æ¥æè¿°rep movsbçš„åŠŸèƒ½å°±æ˜¯ï¼š<br>  <code>s : movsb</code><br>  <code>loop s</code></p></li><li><p><strong>cldæŒ‡ä»¤ï¼šå°†æ ‡å¿—å¯„å­˜å™¨çš„DFä½ç½®0ï¼ŒstdæŒ‡ä»¤ï¼šå°†æ ‡å¿—å¯„å­˜å™¨çš„DFä½ç½®1</strong></p></li><li><p>pushf ï¼šå°†æ ‡å¿—å¯„å­˜å™¨çš„å€¼å‹æ ˆï¼›</p></li><li><p>popf ï¼šä»æ ˆä¸­å¼¹å‡ºæ•°æ®ï¼Œé€å…¥æ ‡å¿—å¯„å­˜å™¨ä¸­ã€‚</p></li><li><p>pushfå’Œpopfï¼Œä¸ºç›´æ¥è®¿é—®æ ‡å¿—å¯„å­˜<br>å™¨æä¾›äº†ä¸€ç§æ–¹æ³•ã€‚</p></li></ol><h3 id="ç¨‹åº-1"><a href="#ç¨‹åº-1" class="headerlink" title="ç¨‹åº"></a>ç¨‹åº</h3><ol><li>ç¼–ç¨‹è®¡ç®—1EF000H+201000Hï¼Œç»“æœæ”¾åœ¨axï¼ˆé«˜16ä½ï¼‰å’Œbxï¼ˆä½16ä½ï¼‰ä¸­ã€‚</li></ol><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">ç¨‹åºï¼š<br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">001EH</span> <br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">0F000H</span> <br> <span class="hljs-keyword">add</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">1000H</span> <br> <span class="hljs-keyword">adc</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0020H</span> <br> <span class="hljs-keyword">adc</span> æŒ‡ä»¤æ‰§è¡Œåï¼Œä¹Ÿå¯èƒ½äº§ç”Ÿè¿›ä½å€¼ï¼Œæ‰€ä»¥ä¹Ÿä¼šå¯¹CFä½è¿›è¡Œè®¾ç½®<br></code></pre></td></tr></table></figure><ol start="2"><li>è®¡ç®—003E1000Hâ€“00202000Hï¼Œç»“æœæ”¾åœ¨axï¼Œbxä¸­ã€‚</li></ol><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">ç¨‹åºå¦‚ä¸‹ï¼š<br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">1000H</span><br> <span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">003EH</span><br> <span class="hljs-keyword">sub</span> <span class="hljs-built_in">bx</span>,<span class="hljs-number">2000H</span><br> <span class="hljs-keyword">sbb</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">0020H</span><br></code></pre></td></tr></table></figure><h2 id="ç¬¬12ç« -å†…ä¸­æ–­"><a href="#ç¬¬12ç« -å†…ä¸­æ–­" class="headerlink" title="ç¬¬12ç«  å†…ä¸­æ–­"></a>ç¬¬12ç«  å†…ä¸­æ–­</h2><hr><h3 id="åŸºç¡€æ¦‚å¿µ-11"><a href="#åŸºç¡€æ¦‚å¿µ-11" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ol><li><p>æˆ‘ä»¬æ›´ç®€æ´çš„æè¿°ä¸­æ–­è¿‡ç¨‹ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>ï¼ˆ1ï¼‰å–å¾—ä¸­æ–­ç±»å‹ç Nï¼›</li><li>ï¼ˆ2ï¼‰ pushf</li><li>ï¼ˆ3ï¼‰ TF &#x3D; 0ï¼ŒIF &#x3D; 0</li><li>ï¼ˆ4ï¼‰ push CS</li><li>ï¼ˆ5ï¼‰ push IP</li><li>ï¼ˆ6ï¼‰(IP) &#x3D; (N * 4)ï¼Œ(CS) &#x3D; (N * 4+2)</li><li>åœ¨æœ€åä¸€æ­¥å®Œæˆåï¼ŒCPU å¼€å§‹æ‰§è¡Œç”±ç¨‹åºå‘˜ç¼–å†™çš„ä¸­æ–­å¤„ç†ç¨‹åºã€‚</li></ul></li><li><p>iretæŒ‡ä»¤çš„åŠŸèƒ½ç”¨æ±‡ç¼–è¯­æ³•æè¿°ä¸ºï¼š</p><ol><li>pop IP</li><li>pop CS</li><li>popf</li></ol></li><li><p>CPUå½“ç„¶ä¸èƒ½è®©è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œè§£å†³çš„åŠæ³•å°±æ˜¯ï¼Œ<strong>åœ¨è¿›å…¥ä¸­æ–­å¤„ç†ç¨‹åºä¹‹å‰ï¼Œè®¾ç½®TF&#x3D;0</strong>ã€‚ä»è€Œ<strong>é¿å…CPUåœ¨æ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºçš„æ—¶å€™å‘ç”Ÿå•æ­¥ä¸­æ–­</strong>ã€‚ï® è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ä¸­æ–­è¿‡ç¨‹ä¸­æœ‰ TF&#x3D;0è¿™ä¸ªæ­¥éª¤ã€‚</p></li></ol><h2 id="ç¬¬13ç« -intæŒ‡ä»¤"><a href="#ç¬¬13ç« -intæŒ‡ä»¤" class="headerlink" title="ç¬¬13ç«  intæŒ‡ä»¤"></a>ç¬¬13ç«  intæŒ‡ä»¤</h2><hr><h3 id="ç¨‹åº-2"><a href="#ç¨‹åº-2" class="headerlink" title="ç¨‹åº"></a>ç¨‹åº</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;ç¼–ç¨‹ï¼šåœ¨å±å¹•çš„5è¡Œ12åˆ—æ˜¾ç¤ºå­—ç¬¦ä¸²â€œwelcome to masm!â€ã€‚</span><br><span class="hljs-meta">assume</span> <span class="hljs-built_in">cs</span>:code<br>data <span class="hljs-meta">segment</span> <br><span class="hljs-built_in">db</span> <span class="hljs-string">&#x27;Welcome to masm!&#x27;</span>,<span class="hljs-string">&#x27;$&#x27;</span><br>data ends<br>code <span class="hljs-meta">segment</span><br><span class="hljs-symbol">start:</span> <span class="hljs-keyword">mov</span> <span class="hljs-number">ah</span>,<span class="hljs-number">2</span> <span class="hljs-comment">;ç½®å…‰æ ‡</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">bh</span>,<span class="hljs-number">0</span> <span class="hljs-comment">;ç¬¬0é¡µ</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">dh</span>,<span class="hljs-number">5</span> <span class="hljs-comment">;dhä¸­æ”¾è¡Œå·</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">dl</span>,<span class="hljs-number">12</span> <span class="hljs-comment">;dlä¸­æ”¾åˆ—å·</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">10h</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,data<br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ds</span>,<span class="hljs-built_in">ax</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">dx</span>,<span class="hljs-number">0</span> <span class="hljs-comment">;ds:dxæŒ‡å‘å­—ç¬¦ä¸²çš„é¦–åœ°å€data:0</span><br><span class="hljs-keyword">mov</span> <span class="hljs-number">ah</span>,<span class="hljs-number">9</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">ax</span>,<span class="hljs-number">4c00h</span><br><span class="hljs-keyword">int</span> <span class="hljs-number">21h</span> <br>code ends<br>end start<br></code></pre></td></tr></table></figure><h2 id="ç¬¬14ç« -ç«¯å£"><a href="#ç¬¬14ç« -ç«¯å£" class="headerlink" title="ç¬¬14ç«  ç«¯å£"></a>ç¬¬14ç«  ç«¯å£</h2><hr><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ol><li><p><strong>in al,60h;ä»60hå·ç«¯å£è¯»å…¥ä¸€ä¸ªå­—èŠ‚</strong></p><ul><li>æ‰§è¡Œæ—¶ä¸æ€»çº¿ç›¸å…³çš„æ“ä½œï¼š</li><li>â‘  CPUé€šè¿‡åœ°å€çº¿å°†åœ°å€ä¿¡æ¯60hå‘å‡ºï¼›</li><li>â‘¡ CPUé€šè¿‡æ§åˆ¶çº¿å‘å‡ºç«¯å£è¯»å‘½ä»¤ï¼Œé€‰ä¸­ç«¯å£æ‰€åœ¨çš„èŠ¯ç‰‡ï¼Œå¹¶é€šçŸ¥å®ƒï¼Œå°†è¦ä»ä¸­è¯»å–æ•°æ®ï¼›</li><li>â‘¢ ç«¯å£æ‰€åœ¨çš„èŠ¯ç‰‡å°†60hç«¯å£ä¸­çš„æ•°æ®é€šè¿‡æ•°æ®çº¿é€å…¥CPUã€‚</li></ul></li><li><p>æ³¨æ„ï¼šåœ¨inå’Œout æŒ‡ä»¤ä¸­ï¼Œåªèƒ½ä½¿ç”¨ ax æˆ–al æ¥å­˜æ”¾ä»ç«¯å£ä¸­è¯»å…¥çš„æ•°æ®æˆ–è¦å‘é€åˆ°ç«¯å£ä¸­çš„æ•°æ®ã€‚è®¿é—®8 ä½ç«¯å£æ—¶ç”¨al ï¼Œè®¿é—®16 ä½ç«¯å£æ—¶ç”¨ax ã€‚</p></li><li><p>å¯¹0ï½255ä»¥å†…çš„ç«¯å£è¿›è¡Œè¯»å†™ï¼š</p><ul><li><strong>in al,20h          ;ä»20hç«¯å£è¯»å…¥ä¸€ä¸ªå­—èŠ‚</strong></li><li><strong>out 20h,al         ;å¾€20hç«¯å£å†™å…¥ä¸€ä¸ªå­—èŠ‚</strong></li></ul></li><li><p>å¯¹256ï½65535çš„ç«¯å£è¿›è¡Œè¯»å†™æ—¶ï¼Œç«¯å£å·æ”¾åœ¨dxä¸­ï¼š</p><ul><li>mov dx,3f8h  ;å°†ç«¯å£å·3f8é€å…¥dx</li><li>in al,dx  ;ä»3f8hç«¯å£è¯»å…¥ä¸€ä¸ªå­—èŠ‚</li><li>out dx,al  ;å‘3f8hç«¯å£å†™å…¥ä¸€ä¸ªå­—èŠ‚</li></ul></li><li><p><strong>70hä¸ºåœ°å€ç«¯å£</strong>ï¼Œå­˜æ”¾è¦è®¿é—®çš„CMOS RAMå•å…ƒçš„åœ°å€ï¼›<strong>71hä¸ºæ•°æ®ç«¯å£</strong>ï¼Œå­˜æ”¾ä»é€‰å®šçš„CMOS RAM å•å…ƒä¸­è¯»å–çš„æ•°æ®ï¼Œæˆ–è¦å†™å…¥åˆ°å…¶ä¸­çš„æ•°æ®ã€‚</p></li><li><p>shlé€»è¾‘å·¦ç§»æŒ‡ä»¤ï¼ŒåŠŸèƒ½ä¸ºï¼š</p><ul><li>å°†ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­çš„æ•°æ®å‘å·¦ç§»ä½ï¼›</li><li>å°†æœ€åç§»å‡ºçš„ä¸€ä½å†™å…¥CFä¸­ï¼›</li><li>æœ€ä½ä½ç”¨0è¡¥å……ã€‚</li></ul></li><li><p>ï®å¦‚æœç§»åŠ¨ä½æ•°å¤§äº1æ—¶ï¼Œå¿…é¡»å°†ç§»åŠ¨ä½æ•°æ”¾åœ¨<strong>cl</strong>ä¸­ã€‚</p></li><li><p>shré€»è¾‘å³ç§»æŒ‡ä»¤</p></li></ol><h3 id="ç¨‹åº-3"><a href="#ç¨‹åº-3" class="headerlink" title="ç¨‹åº"></a>ç¨‹åº</h3><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"><span class="hljs-comment">;ç¼–ç¨‹ï¼Œè¯»CMOS RAMçš„2å·å•å…ƒçš„å†…å®¹</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">out</span> <span class="hljs-number">70h</span>,<span class="hljs-built_in">al</span>        <span class="hljs-comment">;å°† 2 é€å…¥ç«¯å£ 70h</span><br><span class="hljs-keyword">in</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">71h</span>          <span class="hljs-comment">;ä» 71h è¯»å‡º 2 å·å•å…ƒçš„å†…å®¹</span><br><br><span class="hljs-comment">;ç¼–ç¨‹ï¼Œå‘CMOS RAMçš„2å·å•å…ƒå†™å…¥0</span><br><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">2</span><br><span class="hljs-keyword">out</span> <span class="hljs-number">70h</span>,<span class="hljs-built_in">al</span>        <span class="hljs-comment">;å°† 2 é€å…¥ç«¯å£ 70h</span><br><span class="hljs-keyword">mov</span> <span class="hljs-built_in">al</span>,<span class="hljs-number">0</span><br><span class="hljs-keyword">out</span> <span class="hljs-number">71h</span>,<span class="hljs-built_in">al</span>       <span class="hljs-comment">;å‘ 2 å·å•å…ƒå†™å…¥ 0</span><br> <br><br></code></pre></td></tr></table></figure><h2 id="ç¬¬15ç« -å¤–ä¸­æ–­"><a href="#ç¬¬15ç« -å¤–ä¸­æ–­" class="headerlink" title="ç¬¬15ç«  å¤–ä¸­æ–­"></a>ç¬¬15ç«  å¤–ä¸­æ–­</h2><hr><h3 id="åŸºæœ¬æ¦‚å¿µ-1"><a href="#åŸºæœ¬æ¦‚å¿µ-1" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ol><li><p>å¤–è®¾çš„è¾“å…¥ä¸ç›´æ¥é€å…¥å†…å­˜å’ŒCPU ï¼Œè€Œæ˜¯é€å…¥ç›¸å…³çš„æ¥å£èŠ¯ç‰‡çš„ç«¯å£ä¸­ï¼›ï® CPU å‘å¤–è®¾çš„è¾“å‡ºä¹Ÿä¸æ˜¯ç›´æ¥é€å…¥å¤–è®¾ï¼Œè€Œæ˜¯å…ˆé€å…¥ç«¯å£ä¸­ï¼Œå†ç”±ç›¸å…³çš„èŠ¯ç‰‡é€åˆ°å¤–è®¾ã€‚</p></li><li><p>å¯å±è”½ä¸­æ–­æ˜¯CPU å¯ä»¥ä¸å“åº”çš„å¤–ä¸­æ–­ã€‚CPU æ˜¯å¦å“åº”å¯å±è”½ä¸­æ–­ï¼Œè¦çœ‹æ ‡å¿—å¯„å­˜å™¨çš„IF ä½çš„è®¾ç½®ã€‚</p><ul><li>å½“CPU æ£€æµ‹åˆ°å¯å±è”½ä¸­æ–­ä¿¡æ¯æ—¶ï¼š</li><li>å¦‚æœIF&#x3D;1ï¼Œåˆ™CPU åœ¨æ‰§è¡Œå®Œå½“å‰æŒ‡ä»¤åå“åº”ä¸­æ–­ï¼Œå¼•å‘ä¸­æ–­è¿‡ç¨‹ï¼›</li><li>å¦‚æœIF&#x3D;0ï¼Œåˆ™ä¸å“åº”å¯å±è”½ä¸­æ–­ã€‚</li></ul></li><li><p>å†…ä¸­æ–­æ‰€å¼•å‘çš„ä¸­æ–­è¿‡ç¨‹ï¼š</p><ul><li>ï¼ˆ1ï¼‰å–ä¸­æ–­ç±»å‹ç nï¼›</li><li>ï¼ˆ2ï¼‰æ ‡å¿—å¯„å­˜å™¨å…¥æ ˆï¼ŒIF&#x3D;0ï¼ŒTF&#x3D;0ï¼›</li><li>ï¼ˆ3ï¼‰CS ã€IP å…¥æ ˆï¼›</li><li>ï¼ˆ4ï¼‰(IP)&#x3D;(n* 4)ï¼Œ(CS)&#x3D;(n* 4+2)ï¼Œ</li><li>ç”±æ­¤è½¬å»æ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºã€‚</li></ul></li><li><p>å°†IFç½®0çš„åŸå› å°±æ˜¯ï¼Œ<strong>åœ¨è¿›å…¥ä¸­æ–­å¤„ç†ç¨‹åºåï¼Œç¦æ­¢å…¶ä»–çš„å¯å±è”½ä¸­æ–­ã€‚</strong></p></li><li><p>ï® ä¸å¯å±è”½ä¸­æ–­æ˜¯CPU <strong>å¿…é¡»å“åº”</strong>çš„å¤–ä¸­æ–­ã€‚å½“CPU æ£€æµ‹åˆ°ä¸å¯å±è”½ä¸­æ–­ä¿¡æ¯æ—¶ï¼Œåˆ™åœ¨æ‰§è¡Œå®Œå½“å‰æŒ‡ä»¤åï¼Œç«‹å³å“åº”ï¼Œå¼•å‘ä¸­æ–­è¿‡ç¨‹ã€‚ï® å¯¹äº8086CPU ä¸å¯å±è”½ä¸­æ–­çš„ä¸­æ–­ç±»å‹ç å›ºå®šä¸º2ã€‚æ‰€ä»¥ä¸­æ–­è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦å–ä¸­æ–­ç±»å‹ç ã€‚</p></li><li><p>ä¸å¯å±è”½ä¸­æ–­çš„ä¸­æ–­è¿‡ç¨‹ï¼š</p><ul><li>1ã€æ ‡å¿—å¯„å­˜å™¨å…¥æ ˆï¼ŒIF&#x3D;0ï¼ŒTF&#x3D;0ï¼›</li><li>2ã€CSã€IPå…¥æ ˆï¼›</li><li>3ã€(IP)&#x3D;(8)ï¼Œ(CS)&#x3D;(0AH)ã€‚</li></ul></li><li><p>ä¸€èˆ¬å°†æŒ‰ä¸‹ä¸€ä¸ªé”®æ—¶äº§ç”Ÿçš„æ‰«æç ç§°ä¸ºé€šç ï¼Œæ¾å¼€ä¸€ä¸ªé”®äº§ç”Ÿçš„æ‰«æç ç§°ä¸ºæ–­ç ã€‚</p></li><li><p>ï® æ‰«æç é•¿åº¦ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œé€šç çš„ç¬¬7 ä½ä¸º 0 ï¼Œæ–­ç çš„ç¬¬7ä½ä¸º1ï¼Œå³ï¼šæ–­ç &#x3D;é€šç ï¼‹80H</p></li></ol><h2 id="ç¬¬16ç« -ç›´æ¥å®šå€è¡¨"><a href="#ç¬¬16ç« -ç›´æ¥å®šå€è¡¨" class="headerlink" title="ç¬¬16ç«  ç›´æ¥å®šå€è¡¨"></a>ç¬¬16ç«  ç›´æ¥å®šå€è¡¨</h2><hr><h3 id="åŸºæœ¬æ¦‚å¿µ-2"><a href="#åŸºæœ¬æ¦‚å¿µ-2" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><ol><li><p>å¯¹äºç¨‹åºä¸­çš„a db 1,2,3,4,5,6,7,8 ï¼š</p><ul><li>æŒ‡ä»¤ï¼šmov al,a [si]ï¼Œï¼Œç›¸å½“äºï¼šmov al,cs:0[si]ï¼Œ</li><li>æŒ‡ä»¤ï¼šmov al,a[3]ï¼Œï¼Œç›¸å½“äºï¼šmov al,cs:0[3]</li><li>æŒ‡ä»¤ï¼šmov al,a[bx+si+3] ï¼Œï¼Œç›¸å½“äºï¼šmov al,cs:0[bx+si+3]</li></ul></li><li><p>ä»¥åï¼Œæˆ‘ä»¬å°†è¿™ç§æ ‡å·ç§°ä¸ºæ•°æ®æ ‡å·ã€‚å®ƒæ ‡è®°äº†å­˜å‚¨æ•°æ®çš„å•å…ƒçš„åœ°å€å’Œé•¿åº¦ã€‚å®ƒä¸åŒäºä»…ä»…è¡¨ç¤ºåœ°å€çš„åœ°å€æ ‡å·ã€‚</p></li></ol><hr><hr><hr><hr><hr><hr><hr><hr><hr><hr><hr><hr><hr><ul><li>\(E&#x3D;mc^2\)</li><li>(ax^2 + bx + c &#x3D; 0) </li><li>$ C_n^2$</li></ul>]]></content>
    
    
    <categories>
      
      <category>æ±‡ç¼–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ±‡ç¼–</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
